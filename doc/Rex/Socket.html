<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Rex::Socket
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Rex/Socket.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Rex.html" title="Rex (module)">Rex</a></span></span>
     &raquo; 
    <span class="title">Socket</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Rex::Socket
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Proto/DHCP/Server.html" title="Rex::Proto::DHCP::Server (class)">Proto::DHCP::Server</a></span>, <span class='object_link'><a href="Socket/Ip.html" title="Rex::Socket::Ip (module)">Ip</a></span>, <span class='object_link'><a href="Socket/Tcp.html" title="Rex::Socket::Tcp (module)">Tcp</a></span>, <span class='object_link'><a href="Socket/TcpServer.html" title="Rex::Socket::TcpServer (module)">TcpServer</a></span>, <span class='object_link'><a href="Socket/Udp.html" title="Rex::Socket::Udp (module)">Udp</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rex/socket.rb<span class="defines">,<br />
  lib/rex/socket/comm.rb,<br /> lib/rex/socket/switch_board.rb,<br /> lib/rex/socket/range_walker.rb,<br /> lib/rex/socket/subnet_walker.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Base class for all sockets.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Socket/Comm.html" title="Rex::Socket::Comm (module)">Comm</a></span>, <span class='object_link'><a href="Socket/Ip.html" title="Rex::Socket::Ip (module)">Ip</a></span>, <span class='object_link'><a href="Socket/SslTcp.html" title="Rex::Socket::SslTcp (module)">SslTcp</a></span>, <span class='object_link'><a href="Socket/SslTcpServer.html" title="Rex::Socket::SslTcpServer (module)">SslTcpServer</a></span>, <span class='object_link'><a href="Socket/Tcp.html" title="Rex::Socket::Tcp (module)">Tcp</a></span>, <span class='object_link'><a href="Socket/TcpServer.html" title="Rex::Socket::TcpServer (module)">TcpServer</a></span>, <span class='object_link'><a href="Socket/Udp.html" title="Rex::Socket::Udp (module)">Udp</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Socket/Parameters.html" title="Rex::Socket::Parameters (class)">Parameters</a></span>, <span class='object_link'><a href="Socket/Range.html" title="Rex::Socket::Range (class)">Range</a></span>, <span class='object_link'><a href="Socket/RangeWalker.html" title="Rex::Socket::RangeWalker (class)">RangeWalker</a></span>, <span class='object_link'><a href="Socket/SubnetWalker.html" title="Rex::Socket::SubnetWalker (class)">SubnetWalker</a></span>, <span class='object_link'><a href="Socket/SwitchBoard.html" title="Rex::Socket::SwitchBoard (class)">SwitchBoard</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="MATCH_IPV6-constant" class="">MATCH_IPV6 =
          <div class="docstring">
  <div class="discussion">
    
<p>Common Regular Expressions</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$</span><span class='regexp_end'>/</span></span></pre></dd>
      
        <dt id="MATCH_IPV4-constant" class="">MATCH_IPV4 =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s*(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))\s*$</span><span class='regexp_end'>/</span></span></pre></dd>
      
        <dt id="MATCH_IPV4_PRIVATE-constant" class="">MATCH_IPV4_PRIVATE =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s*(?:10\.|192\.168|172.(?:1[6-9]|2[0-9]|3[01])\.|169\.254)</span><span class='regexp_end'>/</span></span></pre></dd>
      
        <dt id="support_ipv6-classvariable" class="">@@support_ipv6 =
          <div class="docstring">
  <div class="discussion">
    
<p>Cache our IPv6 support flag</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='kw'>nil</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">- (Object) <strong>context</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Contextual information that describes the source and other
instance-specific attributes.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipv-instance_method" title="#ipv (instance method)">- (Object) <strong>ipv</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The IP version of the socket.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#localhost-instance_method" title="#localhost (instance method)">- (Object) <strong>localhost</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The local host of the connected socket.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#localport-instance_method" title="#localport (instance method)">- (Object) <strong>localport</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The local port of the connected socket.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#peerhost-instance_method" title="#peerhost (instance method)">- (Object) <strong>peerhost</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The peer host of the connected socket.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#peerport-instance_method" title="#peerport (instance method)">- (Object) <strong>peerport</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The peer port of the connected socket.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_atoc-class_method" title="addr_atoc (class method)">+ (Object) <strong>addr_atoc</strong>(mask) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts an ASCII IP address to a CIDR mask.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_atoi-class_method" title="addr_atoi (class method)">+ (Object) <strong>addr_atoi</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a ascii address into an integer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_atoi_list-class_method" title="addr_atoi_list (class method)">+ (Object) <strong>addr_atoi_list</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a ascii address into a list of addresses.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_aton-class_method" title="addr_aton (class method)">+ (Object) <strong>addr_aton</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a ascii address to network byte order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_ctoa-class_method" title="addr_ctoa (class method)">+ (Object) <strong>addr_ctoa</strong>(cidr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a CIDR bitmask into a dotted-quad.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_itoa-class_method" title="addr_itoa (class method)">+ (Object) <strong>addr_itoa</strong>(addr, v6 = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts an integer address into ascii.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_iton-class_method" title="addr_iton (class method)">+ (Object) <strong>addr_iton</strong>(addr, v6 = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts an integer into a network byte order address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_ntoa-class_method" title="addr_ntoa (class method)">+ (String) <strong>addr_ntoa</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a network byte order address to ascii.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addr_ntoi-class_method" title="addr_ntoi (class method)">+ (Object) <strong>addr_ntoi</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a network byte order address to an integer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bit2netmask-class_method" title="bit2netmask (class method)">+ (Object) <strong>bit2netmask</strong>(bitmask, ipv6 = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a bitmask (28) into a netmask (255.255.255.240).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cidr_crack-class_method" title="cidr_crack (class method)">+ (Object) <strong>cidr_crack</strong>(cidr, v6 = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a CIDR subnet into an array (base, bcast).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compress_address-class_method" title="compress_address (class method)">+ (String) <strong>compress_address</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Implement zero compression for IPv6 addresses.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">+ (Object) <strong>create</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a socket instance using the supplied parameter hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_ip-class_method" title="create_ip (class method)">+ (Object) <strong>create_ip</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a IP socket using the supplied parameter hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_param-class_method" title="create_param (class method)">+ (Object) <strong>create_param</strong>(param) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a socket using the supplied Rex::Socket::Parameter instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_tcp-class_method" title="create_tcp (class method)">+ (Object) <strong>create_tcp</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a TCP socket using the supplied parameter hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_tcp_server-class_method" title="create_tcp_server (class method)">+ (Object) <strong>create_tcp_server</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a TCP server socket using the supplied parameter hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_udp-class_method" title="create_udp (class method)">+ (Object) <strong>create_udp</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a UDP socket using the supplied parameter hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dotted_ip%3F-class_method" title="dotted_ip? (class method)">+ (Boolean) <strong>dotted_ip?</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the supplied address is in “dotted” form.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eth_aton-class_method" title="eth_aton (class method)">+ (Object) <strong>eth_aton</strong>(mac) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a colon-delimited MAC address into a 6-byte binary string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eth_ntoa-class_method" title="eth_ntoa (class method)">+ (Object) <strong>eth_ntoa</strong>(bin) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a 6-byte binary string into a colon-delimited MAC address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_sockaddr-class_method" title="from_sockaddr (class method)">+ (Object) <strong>from_sockaddr</strong>(saddr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the address family, host, and port of the supplied sockaddr as [
af, host, port ].</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getaddress-class_method" title="getaddress (class method)">+ (String) <strong>getaddress</strong>(hostname, accept_ipv6 = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the first address returned by a DNS lookup for <code>hostname</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getaddresses-class_method" title="getaddresses (class method)">+ (Array&lt;String&gt;) <strong>getaddresses</strong>(hostname, accept_ipv6 = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Wrapper for <tt>::Socket.gethostbyname</tt> that takes special care to see if the
supplied address is already an ASCII IP address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gethostbyname-class_method" title="gethostbyname (class method)">+ (Object) <strong>gethostbyname</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Wrapper for Socket.gethostbyname which takes into account whether or not an
IP address is supplied.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipv6_link_address-class_method" title="ipv6_link_address (class method)">+ (Object) <strong>ipv6_link_address</strong>(intf) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Identifies the link-local address of a given interface (if IPv6 is
enabled).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipv6_mac-class_method" title="ipv6_mac (class method)">+ (Object) <strong>ipv6_mac</strong>(intf) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Identifies the mac address of a given interface (if IPv6 is enabled).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_internal%3F-class_method" title="is_internal? (class method)">+ (Boolean) <strong>is_internal?</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return true if <code>addr</code> is within the ranges specified in RFC1918,
or RFC5735/RFC3927.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_ipv4%3F-class_method" title="is_ipv4? (class method)">+ (Boolean) <strong>is_ipv4?</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determine whether this is an IPv4 address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_ipv6%3F-class_method" title="is_ipv6? (class method)">+ (Boolean) <strong>is_ipv6?</strong>(addr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determine whether this is an IPv6 address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#net2bitmask-class_method" title="net2bitmask (class method)">+ (Object) <strong>net2bitmask</strong>(netmask) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a netmask (255.255.255.240) into a bitmask (28).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#portlist_to_portspec-class_method" title="portlist_to_portspec (class method)">+ (Object) <strong>portlist_to_portspec</strong>(parr) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a port list like [1,2,3,4,5,100] into a range specification like
“1-5,100”.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#portspec_crack-class_method" title="portspec_crack (class method)">+ (Object) <strong>portspec_crack</strong>(pspec) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#portspec_to_portlist-class_method" title="portspec_to_portlist (class method)">+ (Object) <strong>portspec_to_portlist</strong>(pspec) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts a port specification like “80,21-25,!24,443” into a sorted, unique
array of valid port numbers like [21,22,23,25,80,443].</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolv_nbo-class_method" title="resolv_nbo (class method)">+ (Object) <strong>resolv_nbo</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a host to raw network-byte order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolv_nbo_i-class_method" title="resolv_nbo_i (class method)">+ (Object) <strong>resolv_nbo_i</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a host to a network-byte order ruby integer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolv_nbo_i_list-class_method" title="resolv_nbo_i_list (class method)">+ (Object) <strong>resolv_nbo_i_list</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a host to a list of network-byte order ruby integers.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolv_nbo_list-class_method" title="resolv_nbo_list (class method)">+ (Object) <strong>resolv_nbo_list</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a host to raw network-byte order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolv_to_dotted-class_method" title="resolv_to_dotted (class method)">+ (Object) <strong>resolv_to_dotted</strong>(host) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resolves a host to a dotted address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#source_address-class_method" title="source_address (class method)">+ (Object) <strong>source_address</strong>(dest = &#39;8.8.8.8&#39;, comm = ::Rex::Socket::Comm::Local) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method does NOT send any traffic to the destination, instead, it uses
a “bound” UDP socket to determine what source address we would use to
communicate with the specified destination.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#support_ipv6%3F-class_method" title="support_ipv6? (class method)">+ (Boolean) <strong>support_ipv6?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determine whether we support IPv6.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tcp_socket_pair-class_method" title="tcp_socket_pair (class method)">+ (Object) <strong>tcp_socket_pair</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a TCP socket pair.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_sockaddr-class_method" title="to_sockaddr (class method)">+ (Object) <strong>to_sockaddr</strong>(ip, port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a sockaddr structure using the supplied IP address, port, and
address family.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#udp_socket_pair-class_method" title="udp_socket_pair (class method)">+ (Object) <strong>udp_socket_pair</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a UDP socket pair using native ruby UDP sockets.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fd-instance_method" title="#fd (instance method)">- (Object) <strong>fd</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>By default, all sockets are themselves selectable file descriptors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getlocalname-instance_method" title="#getlocalname (instance method)">- (Object) <strong>getlocalname</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Wrapper around getsockname.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getpeername-instance_method" title="#getpeername (instance method)">- (Object) <strong>getpeername</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return peer connection information.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getsockname-instance_method" title="#getsockname (instance method)">- (Object) <strong>getsockname</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns local connection information.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initsock-instance_method" title="#initsock (instance method)">- (Object) <strong>initsock</strong>(params = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initialize general socket parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type%3F-instance_method" title="#type? (instance method)">- (Boolean) <strong>type?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a string that indicates the type of the socket, such as
&#39;tcp&#39;.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="context=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="context-instance_method">
  
    - (<tt>Object</tt>) <strong>context</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Contextual information that describes the source and other
instance-specific attributes.  This comes from the param.context attribute.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


770
771
772</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 770</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='ivar'>@context</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="ipv=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="ipv-instance_method">
  
    - (<tt>Object</tt>) <strong>ipv</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The IP version of the socket</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


764
765
766</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 764</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ipv'>ipv</span>
  <span class='ivar'>@ipv</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="localhost=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="localhost-instance_method">
  
    - (<tt>Object</tt>) <strong>localhost</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The local host of the connected socket.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


756
757
758</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 756</span>

<span class='kw'>def</span> <span class='id identifier rubyid_localhost'>localhost</span>
  <span class='ivar'>@localhost</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="localport=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="localport-instance_method">
  
    - (<tt>Object</tt>) <strong>localport</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The local port of the connected socket.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


760
761
762</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 760</span>

<span class='kw'>def</span> <span class='id identifier rubyid_localport'>localport</span>
  <span class='ivar'>@localport</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="peerhost=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="peerhost-instance_method">
  
    - (<tt>Object</tt>) <strong>peerhost</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The peer host of the connected socket.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


748
749
750</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 748</span>

<span class='kw'>def</span> <span class='id identifier rubyid_peerhost'>peerhost</span>
  <span class='ivar'>@peerhost</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="peerport=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="peerport-instance_method">
  
    - (<tt>Object</tt>) <strong>peerport</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The peer port of the connected socket.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


752
753
754</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 752</span>

<span class='kw'>def</span> <span class='id identifier rubyid_peerport'>peerport</span>
  <span class='ivar'>@peerport</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="addr_atoc-class_method">
  
    + (<tt>Object</tt>) <strong>addr_atoc</strong>(mask) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts an ASCII IP address to a CIDR mask. Returns nil if it&#39;s not
convertable.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286
287
288
289
290
291
292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 284</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_atoc'>addr_atoc</span><span class='lparen'>(</span><span class='id identifier rubyid_mask'>mask</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mask_i'>mask_i</span> <span class='op'>=</span> <span class='id identifier rubyid_resolv_nbo_i'>resolv_nbo_i</span><span class='lparen'>(</span><span class='id identifier rubyid_mask'>mask</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cidr'>cidr</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='int'>32</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>1</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='int'>32</span><span class='op'>-</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_mask_i'>mask_i</span>
      <span class='id identifier rubyid_cidr'>cidr</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cidr'>cidr</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_atoi-class_method">
  
    + (<tt>Object</tt>) <strong>addr_atoi</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a ascii address into an integer</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


315
316
317</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 315</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_atoi'>addr_atoi</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resolv_nbo_i'>resolv_nbo_i</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_atoi_list-class_method">
  
    + (<tt>Object</tt>) <strong>addr_atoi_list</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a ascii address into a list of addresses</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


322
323
324</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 322</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_atoi_list'>addr_atoi_list</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resolv_nbo_i_list'>resolv_nbo_i_list</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_aton-class_method">
  
    + (<tt>Object</tt>) <strong>addr_aton</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a ascii address to network byte order</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 340</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_ctoa-class_method">
  
    + (<tt>Object</tt>) <strong>addr_ctoa</strong>(cidr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a CIDR bitmask into a dotted-quad. Returns nil if it&#39;s not
convertable.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


300
301
302
303</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 300</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_ctoa'>addr_ctoa</span><span class='lparen'>(</span><span class='id identifier rubyid_cidr'>cidr</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='lparen'>(</span><span class='int'>0</span><span class='op'>..</span><span class='int'>32</span><span class='rparen'>)</span> <span class='op'>===</span> <span class='id identifier rubyid_cidr'>cidr</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>1</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cidr'>cidr</span><span class='rparen'>)</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='int'>32</span><span class='op'>-</span><span class='id identifier rubyid_cidr'>cidr</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_itoa-class_method">
  
    + (<tt>Object</tt>) <strong>addr_itoa</strong>(addr, v6 = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts an integer address into ascii</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


331
332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 331</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='id identifier rubyid_v6'>v6</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nboa'>nboa</span> <span class='op'>=</span> <span class='id identifier rubyid_addr_iton'>addr_iton</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='id identifier rubyid_v6'>v6</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_addr_ntoa'>addr_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_nboa'>nboa</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_iton-class_method">
  
    + (<tt>Object</tt>) <strong>addr_iton</strong>(addr, v6 = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts an integer into a network byte order address</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>addr</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The address as a number</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>v6</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether <code>addr</code> is IPv6</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


412
413
414
415
416
417
418
419
420
421
422
423</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 412</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_iton'>addr_iton</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='id identifier rubyid_v6'>v6</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>&lt;</span> <span class='int'>0x100000000</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_v6'>v6</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_addr'>addr</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_w'>w</span>    <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_w'>w</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>&gt;&gt;</span> <span class='int'>96</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span>
    <span class='id identifier rubyid_w'>w</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>&gt;&gt;</span> <span class='int'>64</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span>
    <span class='id identifier rubyid_w'>w</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>&gt;&gt;</span> <span class='int'>32</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span>
    <span class='id identifier rubyid_w'>w</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_w'>w</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N4</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_ntoa-class_method">
  
    + (<tt>String</tt>) <strong>addr_ntoa</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a network byte order address to ascii</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>addr</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Packed network-byte-order address</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Human readable IP address.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuntimeError.html" title="Rex::RuntimeError (class)">RuntimeError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351
352
353
354
355
356
357
358
359
360
361</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 349</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_ntoa'>addr_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='comment'># IPv4
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>4</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C4</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># IPv6
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>16</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_compress_address'>compress_address</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%x</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_c'>c</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid address format</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addr_ntoi-class_method">
  
    + (<tt>Object</tt>) <strong>addr_ntoi</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a network byte order address to an integer</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RuntimeError.html" title="Rex::RuntimeError (class)">RuntimeError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 390</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_ntoi'>addr_ntoi</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_bits'>bits</span> <span class='op'>=</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_bits'>bits</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>4</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_bits'>bits</span><span class='period'>.</span><span class='id identifier rubyid_each_index'>each_index</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>+=</span> <span class='lparen'>(</span>  <span class='id identifier rubyid_bits'>bits</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='int'>96</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>32</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid address format</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="bit2netmask-class_method">
  
    + (<tt>Object</tt>) <strong>bit2netmask</strong>(bitmask, ipv6 = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a bitmask (28) into a netmask (255.255.255.240)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


492
493
494
495
496
497
498
499
500</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 492</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_bit2netmask'>bit2netmask</span><span class='lparen'>(</span><span class='id identifier rubyid_bitmask'>bitmask</span><span class='comma'>,</span> <span class='id identifier rubyid_ipv6'>ipv6</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_bitmask'>bitmask</span> <span class='op'>&gt;</span> <span class='int'>32</span> <span class='kw'>or</span> <span class='id identifier rubyid_ipv6'>ipv6</span>
    <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='op'>~</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>2</span> <span class='op'>**</span> <span class='lparen'>(</span><span class='int'>128</span> <span class='op'>-</span> <span class='id identifier rubyid_bitmask'>bitmask</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='lparen'>(</span><span class='int'>2</span><span class='op'>**</span><span class='int'>128</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_iton'>addr_iton</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_ntoa'>addr_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span> <span class='lparen'>(</span><span class='op'>~</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>2</span> <span class='op'>**</span> <span class='lparen'>(</span><span class='int'>32</span> <span class='op'>-</span> <span class='id identifier rubyid_bitmask'>bitmask</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>&amp;</span> <span class='int'>0xffffffff</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CCCC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cidr_crack-class_method">
  
    + (<tt>Object</tt>) <strong>cidr_crack</strong>(cidr, v6 = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a CIDR subnet into an array (base, bcast)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 442</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cidr_crack'>cidr_crack</span><span class='lparen'>(</span><span class='id identifier rubyid_cidr'>cidr</span><span class='comma'>,</span> <span class='id identifier rubyid_v6'>v6</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_cidr'>cidr</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_tst'>tst</span><span class='comma'>,</span><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scope'>scope</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_scope'>scope</span> <span class='kw'>if</span> <span class='id identifier rubyid_scope'>scope</span>
  <span class='id identifier rubyid_scope'>scope</span>   <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='id identifier rubyid_addr_atoi'>addr_atoi</span><span class='lparen'>(</span><span class='id identifier rubyid_tst'>tst</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_bits'>bits</span> <span class='op'>=</span> <span class='int'>32</span>
  <span class='id identifier rubyid_mask'>mask</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_use6'>use6</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>&gt;</span> <span class='int'>0xffffffff</span> <span class='kw'>or</span> <span class='id identifier rubyid_v6'>v6</span> <span class='kw'>or</span> <span class='id identifier rubyid_cidr'>cidr</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>:</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_use6'>use6</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_bits'>bits</span> <span class='op'>=</span> <span class='int'>128</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_mask'>mask</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>2</span> <span class='op'>**</span> <span class='id identifier rubyid_bits'>bits</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='int'>2</span> <span class='op'>**</span> <span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span> <span class='op'>-</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_base'>base</span> <span class='op'>=</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_mask'>mask</span>

  <span class='id identifier rubyid_stop'>stop</span> <span class='op'>=</span> <span class='id identifier rubyid_base'>base</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='int'>2</span> <span class='op'>**</span> <span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span> <span class='op'>-</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='int'>1</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='id identifier rubyid_use6'>use6</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span><span class='id identifier rubyid_stop'>stop</span><span class='comma'>,</span> <span class='id identifier rubyid_use6'>use6</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_scope'>scope</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compress_address-class_method">
  
    + (<tt>String</tt>) <strong>compress_address</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Implement zero compression for IPv6 addresses. Uses the compression method
from Marco Ceresa&#39;s IPAddress GEM</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>addr</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Human readable IPv6 address</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Human readable IPv6 address with runs of 0s removed</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://github.com/bluemonk/ipaddress/blob/master/lib/ipaddress/ipv6.rb" target="_parent" title="https://github.com/bluemonk/ipaddress/blob/master/lib/ipaddress/ipv6.rb">https://github.com/bluemonk/ipaddress/blob/master/lib/ipaddress/ipv6.rb</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


371
372
373
374
375
376
377
378
379
380
381
382
383
384
385</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 371</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_compress_address'>compress_address</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_addr'>addr</span> <span class='kw'>unless</span> <span class='id identifier rubyid_is_ipv6?'>is_ipv6?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A0:0:0:0:0:0:0:0\Z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0:0:0:0:0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0:0:0:0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0:0:0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0:0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub!'>sub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\b0:0\b</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>:{3,}</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create-class_method">
  
    + (<tt>Object</tt>) <strong>create</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a socket instance using the supplied parameter hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 39</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_create_param'>create_param</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Parameters</span><span class='period'>.</span><span class='id identifier rubyid_from_hash'>from_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_ip-class_method">
  
    + (<tt>Object</tt>) <strong>create_ip</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a IP socket using the supplied parameter hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 74</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_ip'>create_ip</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_create_param'>create_param</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Parameters</span><span class='period'>.</span><span class='id identifier rubyid_from_hash'>from_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Proto</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_param-class_method">
  
    + (<tt>Object</tt>) <strong>create_param</strong>(param) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a socket using the supplied Rex::Socket::Parameter instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 46</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_param'>create_param</span><span class='lparen'>(</span><span class='id identifier rubyid_param'>param</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_param'>param</span><span class='period'>.</span><span class='id identifier rubyid_comm'>comm</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_param'>param</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_tcp-class_method">
  
    + (<tt>Object</tt>) <strong>create_tcp</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a TCP socket using the supplied parameter hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 53</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_tcp'>create_tcp</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_create_param'>create_param</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Parameters</span><span class='period'>.</span><span class='id identifier rubyid_from_hash'>from_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Proto</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_tcp_server-class_method">
  
    + (<tt>Object</tt>) <strong>create_tcp_server</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a TCP server socket using the supplied parameter hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 60</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_tcp_server'>create_tcp_server</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_create_tcp'>create_tcp</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Server</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_udp-class_method">
  
    + (<tt>Object</tt>) <strong>create_udp</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a UDP socket using the supplied parameter hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 67</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_udp'>create_udp</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_create_param'>create_param</span><span class='lparen'>(</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Parameters</span><span class='period'>.</span><span class='id identifier rubyid_from_hash'>from_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Proto</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>udp</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dotted_ip?-class_method">
  
    + (<tt>Boolean</tt>) <strong>dotted_ip?</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the supplied address is in “dotted” form</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 136</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dotted_ip?'>dotted_ip?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='comment'># Match IPv6
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_support_ipv6?'>support_ipv6?</span> <span class='kw'>and</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV6</span><span class='rparen'>)</span>

  <span class='comment'># Match IPv4
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV4</span><span class='rparen'>)</span>

  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eth_aton-class_method">
  
    + (<tt>Object</tt>) <strong>eth_aton</strong>(mac) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a colon-delimited MAC address into a 6-byte binary string</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


428
429
430</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 428</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_eth_aton'>eth_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_mac'>mac</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mac'>mac</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eth_ntoa-class_method">
  
    + (<tt>Object</tt>) <strong>eth_ntoa</strong>(bin) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a 6-byte binary string into a colon-delimited MAC address</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


435
436
437</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 435</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_eth_ntoa'>eth_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_bin'>bin</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_bin'>bin</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C6</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.2x</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_x'>x</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="from_sockaddr-class_method">
  
    + (<tt>Object</tt>) <strong>from_sockaddr</strong>(saddr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the address family, host, and port of the supplied sockaddr as</p>
<dl class="rdoc-list label-list"><dt> af, host, port 
<dd></dd></dl>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248
249
250</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 243</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_from_sockaddr'>from_sockaddr</span><span class='lparen'>(</span><span class='id identifier rubyid_saddr'>saddr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='id identifier rubyid_unpack_sockaddr_in'>unpack_sockaddr_in</span><span class='lparen'>(</span><span class='id identifier rubyid_saddr'>saddr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_af'>af</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>AF_INET</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_support_ipv6?'>support_ipv6?</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_is_ipv6?'>is_ipv6?</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_af'>af</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>AF_INET6</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_af'>af</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getaddress-class_method">
  
    + (<tt>String</tt>) <strong>getaddress</strong>(hostname, accept_ipv6 = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the first address returned by a DNS lookup for <code>hostname</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>hostname</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hostname or ASCII IP address</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ASCII IP address</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#getaddresses-class_method" title="Rex::Socket.getaddresses (method)">getaddresses</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 164</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_getaddress'>getaddress</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_getaddresses'>getaddresses</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getaddresses-class_method">
  
    + (<tt>Array&lt;String&gt;</tt>) <strong>getaddresses</strong>(hostname, accept_ipv6 = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Wrapper for <tt>::Socket.gethostbyname</tt> that takes special care to see if the
supplied address is already an ASCII IP address.  This is necessary to
prevent blocking while waiting on a DNS reverse lookup when we already have
what we need.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>hostname</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hostname or ASCII IP address</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 176</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_getaddresses'>getaddresses</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV4</span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span> <span class='kw'>and</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV6</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_res'>res</span>

  <span class='comment'># Shift the first three elements out, leaving just the list of
</span>  <span class='comment'># addresses
</span>  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='comment'># name
</span>  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='comment'># alias hostnames
</span>  <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='comment'># address_family
</span>
  <span class='comment'># Rubinius has a bug where gethostbyname returns dotted quads instead of
</span>  <span class='comment'># NBO, but that&#39;s what we want anyway, so just short-circuit here.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV4</span> <span class='op'>||</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV6</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ascii'>ascii</span><span class='op'>|</span> <span class='id identifier rubyid_ascii'>ascii</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV6</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_accept_ipv6'>accept_ipv6</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_nbo'>nbo</span><span class='op'>|</span> <span class='id identifier rubyid_nbo'>nbo</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>4</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_nbo'>nbo</span><span class='op'>|</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addr_ntoa'>addr_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_nbo'>nbo</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gethostbyname-class_method">
  
    + (<tt>Object</tt>) <strong>gethostbyname</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Wrapper for Socket.gethostbyname which takes into account whether or not an
IP address is supplied.  If it is, then reverse DNS resolution does not
occur.  This is done in order to prevent delays, such as would occur on
Windows.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220
221
222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 212</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_is_ipv4?'>is_ipv4?</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C4</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_is_ipv6?'>is_ipv6?</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
    <span class='comment'># pop off the scopeid since gethostbyname isn&#39;t smart enough to
</span>    <span class='comment'># deal with it.
</span>    <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ipv6_link_address-class_method">
  
    + (<tt>Object</tt>) <strong>ipv6_link_address</strong>(intf) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Identifies the link-local address of a given interface (if IPv6 is enabled)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


608
609
610
611
612</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 608</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_link_address'>ipv6_link_address</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_source_address'>source_address</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FF02::1%</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_r'>r</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^fe80</span><span class='regexp_end'>/i</span></span>
  <span class='id identifier rubyid_r'>r</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ipv6_mac-class_method">
  
    + (<tt>Object</tt>) <strong>ipv6_mac</strong>(intf) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Identifies the mac address of a given interface (if IPv6 is enabled)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


617
618
619
620
621
622</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 617</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_mac'>ipv6_mac</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_ipv6_link_address'>ipv6_link_address</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_r'>r</span>
  <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>8</span><span class='comma'>,</span> <span class='int'>8</span><span class='rbracket'>]</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='int'>5</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.2x</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_c'>c</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_internal?-class_method">
  
    + (<tt>Boolean</tt>) <strong>is_internal?</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return true if <code>addr</code> is within the ranges specified in RFC1918,
or RFC5735/RFC3927</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 150</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_internal?'>is_internal?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dotted_ip?'>dotted_ip?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV4_PRIVATE</span>
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_ipv4?-class_method">
  
    + (<tt>Boolean</tt>) <strong>is_ipv4?</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determine whether this is an IPv4 address</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 122</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_ipv4?'>is_ipv4?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='lparen'>(</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV4</span> <span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_ipv6?-class_method">
  
    + (<tt>Boolean</tt>) <strong>is_ipv6?</strong>(addr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determine whether this is an IPv6 address</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 129</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_ipv6?'>is_ipv6?</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span>
  <span class='lparen'>(</span> <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=~</span> <span class='const'>MATCH_IPV6</span> <span class='rparen'>)</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="net2bitmask-class_method">
  
    + (<tt>Object</tt>) <strong>net2bitmask</strong>(netmask) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a netmask (255.255.255.240) into a bitmask (28).  This is the lame
kid way of doing it.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 471</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_net2bitmask'>net2bitmask</span><span class='lparen'>(</span><span class='id identifier rubyid_netmask'>netmask</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_nmask'>nmask</span> <span class='op'>=</span> <span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_netmask'>netmask</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_imask'>imask</span> <span class='op'>=</span> <span class='id identifier rubyid_addr_ntoi'>addr_ntoi</span><span class='lparen'>(</span><span class='id identifier rubyid_nmask'>nmask</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_bits'>bits</span>  <span class='op'>=</span> <span class='int'>32</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_imask'>imask</span> <span class='op'>&gt;</span> <span class='int'>0xffffffff</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_bits'>bits</span> <span class='op'>=</span> <span class='int'>128</span>
  <span class='kw'>end</span>

  <span class='int'>0</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_bit'>bit</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='int'>2</span> <span class='op'>**</span> <span class='id identifier rubyid_bit'>bit</span>
    <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_bits'>bits</span> <span class='op'>-</span> <span class='id identifier rubyid_bit'>bit</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_imask'>imask</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_p'>p</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_p'>p</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="portlist_to_portspec-class_method">
  
    + (<tt>Object</tt>) <strong>portlist_to_portspec</strong>(parr) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a port list like [1,2,3,4,5,100] into a range specification like
“1-5,100”</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 548</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_portlist_to_portspec'>portlist_to_portspec</span><span class='lparen'>(</span><span class='id identifier rubyid_parr'>parr</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_range'>range</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_lastp'>lastp</span>  <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_parr'>parr</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='op'>&lt;=&gt;</span><span class='id identifier rubyid_b'>b</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span> <span class='op'>&lt;</span> <span class='int'>1</span> <span class='kw'>or</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>&gt;</span> <span class='int'>65535</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_lastp'>lastp</span>
      <span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_lastp'>lastp</span> <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_lastp'>lastp</span> <span class='op'>==</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>-</span> <span class='int'>1</span>
      <span class='id identifier rubyid_range'>range</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_n'>n</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_range'>range</span>
      <span class='id identifier rubyid_range'>range</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_n'>n</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_lastp'>lastp</span> <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_ranges'>ranges</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_range'>range</span>
  <span class='id identifier rubyid_ranges'>ranges</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ranges'>ranges</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="portspec_crack-class_method">
  
    + (<tt>Object</tt>) <strong>portspec_crack</strong>(pspec) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


503
504
505</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 503</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_portspec_crack'>portspec_crack</span><span class='lparen'>(</span><span class='id identifier rubyid_pspec'>pspec</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_portspec_to_portlist'>portspec_to_portlist</span><span class='lparen'>(</span><span class='id identifier rubyid_pspec'>pspec</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="portspec_to_portlist-class_method">
  
    + (<tt>Object</tt>) <strong>portspec_to_portlist</strong>(pspec) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts a port specification like “80,21-25,!24,443” into a sorted, unique
array of valid port numbers like [21,22,23,25,80,443]</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 511</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_portspec_to_portlist'>portspec_to_portlist</span><span class='lparen'>(</span><span class='id identifier rubyid_pspec'>pspec</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ports'>ports</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_remove'>remove</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='comment'># Build ports array from port specification
</span>  <span class='id identifier rubyid_pspec'>pspec</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>,</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span>
    <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_ports'>ports</span>

    <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_strip!'>strip!</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>!</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_delete!'>delete!</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>!</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_remove'>remove</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_start'>start</span><span class='comma'>,</span> <span class='id identifier rubyid_stop'>stop</span> <span class='op'>=</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>-</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_start'>start</span> <span class='op'>||=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_stop'>stop</span> <span class='op'>||=</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>-</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='int'>65535</span> <span class='op'>:</span> <span class='id identifier rubyid_start'>start</span>

    <span class='id identifier rubyid_start'>start</span><span class='comma'>,</span> <span class='id identifier rubyid_stop'>stop</span> <span class='op'>=</span> <span class='id identifier rubyid_stop'>stop</span><span class='comma'>,</span> <span class='id identifier rubyid_start'>start</span> <span class='kw'>if</span> <span class='id identifier rubyid_stop'>stop</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_start'>start</span>

    <span class='id identifier rubyid_start'>start</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_stop'>stop</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_target'>target</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_p'>p</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_ports'>ports</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_remove'>remove</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_ports'>ports</span> <span class='op'>=</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span> <span class='int'>65535</span>
  <span class='kw'>end</span>

  <span class='comment'># Sort, and remove dups and invalid ports
</span>  <span class='id identifier rubyid_ports'>ports</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='op'>&lt;</span> <span class='int'>1</span> <span class='kw'>or</span> <span class='id identifier rubyid_p'>p</span> <span class='op'>&gt;</span> <span class='int'>65535</span> <span class='kw'>or</span> <span class='id identifier rubyid_remove'>remove</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_p'>p</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolv_nbo-class_method">
  
    + (<tt>Object</tt>) <strong>resolv_nbo</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a host to raw network-byte order.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


255
256
257</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 255</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_getaddress'>getaddress</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolv_nbo_i-class_method">
  
    + (<tt>Object</tt>) <strong>resolv_nbo_i</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a host to a network-byte order ruby integer.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 269</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo_i'>resolv_nbo_i</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_addr_ntoi'>addr_ntoi</span><span class='lparen'>(</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolv_nbo_i_list-class_method">
  
    + (<tt>Object</tt>) <strong>resolv_nbo_i_list</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a host to a list of network-byte order ruby integers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 276</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo_i_list'>resolv_nbo_i_list</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resolv_nbo_list'>resolv_nbo_list</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_addr'>addr</span><span class='op'>|</span> <span class='id identifier rubyid_addr_ntoi'>addr_ntoi</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolv_nbo_list-class_method">
  
    + (<tt>Object</tt>) <strong>resolv_nbo_list</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a host to raw network-byte order.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 262</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo_list'>resolv_nbo_list</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_getaddresses'>getaddresses</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_addr'>addr</span><span class='op'>|</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gethostbyname'>gethostbyname</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolv_to_dotted-class_method">
  
    + (<tt>Object</tt>) <strong>resolv_to_dotted</strong>(host) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resolves a host to a dotted address.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 308</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resolv_to_dotted'>resolv_to_dotted</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_addr_ntoa'>addr_ntoa</span><span class='lparen'>(</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="source_address-class_method">
  
    + (<tt>Object</tt>) <strong>source_address</strong>(dest = &#39;8.8.8.8&#39;, comm = ::Rex::Socket::Comm::Local) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method does NOT send any traffic to the destination, instead, it uses
a “bound” UDP socket to determine what source address we would use to
communicate with the specified destination. The destination defaults to
Google&#39;s DNS server to make the standard behavior determine which IP we
would use to communicate with the internet.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 588</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_source_address'>source_address</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>8.8.8.8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_comm'>comm</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Comm</span><span class='op'>::</span><span class='const'>Local</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_udp'>create_udp</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PeerHost</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_dest'>dest</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PeerPort</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='int'>31337</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Comm</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_comm'>comm</span>
    <span class='rparen'>)</span>
    <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_getsockname'>getsockname</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>

    <span class='comment'># Trim off the trailing interface ID for link-local IPv6
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Exception</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="support_ipv6?-class_method">
  
    + (<tt>Boolean</tt>) <strong>support_ipv6?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determine whether we support IPv6</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 102</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_support_ipv6?'>support_ipv6?</span>
  <span class='kw'>return</span> <span class='cvar'>@@support_ipv6</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='cvar'>@@support_ipv6</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='cvar'>@@support_ipv6</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AF_INET6</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>AF_INET6</span><span class='comma'>,</span> <span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>SOCK_DGRAM</span><span class='comma'>,</span> <span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>IPPROTO_UDP</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
      <span class='cvar'>@@support_ipv6</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>rescue</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='cvar'>@@support_ipv6</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tcp_socket_pair-class_method">
  
    + (<tt>Object</tt>) <strong>tcp_socket_pair</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a TCP socket pair.</p>

<p>sf: This create a socket pair using native ruby sockets and will work on
Windows where ::Socket.pair is not implemented. Note: OpenSSL requires
native ruby sockets for its io.</p>

<p>Note: Even though sub-threads are smashing the parent threads local, there</p>

<pre class="code ruby"><code class="ruby">is no concurrent use of the same locals and this is safe.</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 633</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_tcp_socket_pair'>tcp_socket_pair</span>
  <span class='id identifier rubyid_lsock'>lsock</span>   <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_rsock'>rsock</span>   <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_laddr'>laddr</span>   <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_lport'>lport</span>   <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_threads'>threads</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_mutex'>mutex</span>   <span class='op'>=</span> <span class='op'>::</span><span class='const'>Mutex</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_threads'>threads</span> <span class='op'>&lt;&lt;</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>ThreadFactory</span><span class='period'>.</span><span class='id identifier rubyid_spawn'>spawn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TcpSocketPair</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_threads'>threads</span> <span class='op'>&lt;&lt;</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>ThreadFactory</span><span class='period'>.</span><span class='id identifier rubyid_spawn'>spawn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TcpSocketPairClient</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
        <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span>
          <span class='id identifier rubyid_rsock'>rsock</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>TCPSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='id identifier rubyid_laddr'>laddr</span><span class='comma'>,</span> <span class='id identifier rubyid_lport'>lport</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
      <span class='rbrace'>}</span>
      <span class='id identifier rubyid_server'>server</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>TCPServer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_laddr'>laddr</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_getsockname'>getsockname</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>127\.0\.0\.1:</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
        <span class='comment'># JRuby ridiculousness
</span>        <span class='id identifier rubyid_caddr'>caddr</span><span class='comma'>,</span> <span class='id identifier rubyid_lport'>lport</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_getsockname'>getsockname</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_caddr'>caddr</span> <span class='op'>=</span> <span class='id identifier rubyid_caddr'>caddr</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='id identifier rubyid_caddr'>caddr</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_lport'>lport</span> <span class='op'>=</span> <span class='id identifier rubyid_lport'>lport</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='kw'>else</span>
        <span class='comment'># Sane implementations where Socket#getsockname returns a
</span>        <span class='comment'># sockaddr
</span>        <span class='id identifier rubyid_lport'>lport</span><span class='comma'>,</span> <span class='id identifier rubyid_caddr'>caddr</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_unpack_sockaddr_in'>unpack_sockaddr_in</span><span class='lparen'>(</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_getsockname'>getsockname</span> <span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_lsock'>lsock</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_accept'>accept</span>
    <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_threads'>threads</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_lsock'>lsock</span><span class='comma'>,</span> <span class='id identifier rubyid_rsock'>rsock</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_sockaddr-class_method">
  
    + (<tt>Object</tt>) <strong>to_sockaddr</strong>(ip, port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a sockaddr structure using the supplied IP address, port, and
address family</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232
233
234
235
236
237</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 230</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_to_sockaddr'>to_sockaddr</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::ffff:0.0.0.0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='id identifier rubyid_support_ipv6?'>support_ipv6?</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_pack_sockaddr_in'>pack_sockaddr_in</span><span class='lparen'>(</span><span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="udp_socket_pair-class_method">
  
    + (<tt>Object</tt>) <strong>udp_socket_pair</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a UDP socket pair using native ruby UDP sockets.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


673
674
675
676
677
678
679
680
681
682
683
684
685
686
687</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 673</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_udp_socket_pair'>udp_socket_pair</span>
  <span class='id identifier rubyid_laddr'>laddr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_lsock'>lsock</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>UDPSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_lsock'>lsock</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span> <span class='id identifier rubyid_laddr'>laddr</span><span class='comma'>,</span> <span class='int'>0</span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_rsock'>rsock</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>UDPSocket</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_rsock'>rsock</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span> <span class='id identifier rubyid_laddr'>laddr</span><span class='comma'>,</span> <span class='int'>0</span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_rsock'>rsock</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='op'>*</span><span class='id identifier rubyid_lsock'>lsock</span><span class='period'>.</span><span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_values_at'>values_at</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>1</span><span class='rparen'>)</span> <span class='rparen'>)</span>

  <span class='id identifier rubyid_lsock'>lsock</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='op'>*</span><span class='id identifier rubyid_rsock'>rsock</span><span class='period'>.</span><span class='id identifier rubyid_addr'>addr</span><span class='period'>.</span><span class='id identifier rubyid_values_at'>values_at</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>1</span><span class='rparen'>)</span> <span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_lsock'>lsock</span><span class='comma'>,</span> <span class='id identifier rubyid_rsock'>rsock</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="fd-instance_method">
  
    - (<tt>Object</tt>) <strong>fd</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>By default, all sockets are themselves selectable file descriptors.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


713
714
715</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 713</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fd'>fd</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getlocalname-instance_method">
  
    - (<tt>Object</tt>) <strong>getlocalname</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Wrapper around getsockname</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


727
728
729</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 727</span>

<span class='kw'>def</span> <span class='id identifier rubyid_getlocalname'>getlocalname</span>
  <span class='id identifier rubyid_getsockname'>getsockname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getpeername-instance_method">
  
    - (<tt>Object</tt>) <strong>getpeername</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return peer connection information.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


734
735
736</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 734</span>

<span class='kw'>def</span> <span class='id identifier rubyid_getpeername'>getpeername</span>
  <span class='kw'>return</span> <span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_from_sockaddr'>from_sockaddr</span><span class='lparen'>(</span><span class='kw'>super</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getsockname-instance_method">
  
    - (<tt>Object</tt>) <strong>getsockname</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns local connection information.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


720
721
722</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 720</span>

<span class='kw'>def</span> <span class='id identifier rubyid_getsockname'>getsockname</span>
  <span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_from_sockaddr'>from_sockaddr</span><span class='lparen'>(</span><span class='kw'>super</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initsock-instance_method">
  
    - (<tt>Object</tt>) <strong>initsock</strong>(params = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initialize general socket parameters.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


699
700
701
702
703
704
705
706
707
708</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 699</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initsock'>initsock</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span>  <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span>  <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span>   <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv'>ipv</span>       <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_v6'>v6</span> <span class='op'>?</span> <span class='int'>6</span> <span class='op'>:</span> <span class='int'>4</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>type?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a string that indicates the type of the socket, such as
&#39;tcp&#39;.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="NotImplementedError.html" title="Rex::NotImplementedError (class)">NotImplementedError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


741
742
743</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/socket.rb', line 741</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type?'>type?</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NotImplementedError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Socket type is not supported.</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Sep  3 01:51:22 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.2).
</div>

  </body>
</html>