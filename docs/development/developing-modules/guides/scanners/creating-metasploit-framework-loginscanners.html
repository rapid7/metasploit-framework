<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4622520-7"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-4622520-7', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Writing an FTP LoginScanner | Metasploit Documentation Penetration Testing Software, Pen Testing Security</title><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Writing an FTP LoginScanner" /><meta property="og:locale" content="en_US" /><meta name="description" content="View Metasploit Framework Documentation" /><meta property="og:description" content="View Metasploit Framework Documentation" /><link rel="canonical" href="https://rapid7.github.io/metasploit-framework/docs/development/developing-modules/guides/scanners/creating-metasploit-framework-loginscanners.html" /><meta property="og:url" content="https://rapid7.github.io/metasploit-framework/docs/development/developing-modules/guides/scanners/creating-metasploit-framework-loginscanners.html" /><meta property="og:site_name" content="Metasploit Documentation Penetration Testing Software, Pen Testing Security" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writing an FTP LoginScanner" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"View Metasploit Framework Documentation","headline":"Writing an FTP LoginScanner","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://rapid7.github.io/metasploit-framework/assets/images/favicon.png"}},"url":"https://rapid7.github.io/metasploit-framework/docs/development/developing-modules/guides/scanners/creating-metasploit-framework-loginscanners.html"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <script type="text/javascript" src="/assets/js/toggle_init.js"></script><div class="side-bar"><div class="site-header"> <a href="/" class="site-title lh-tight"><img src="/assets/images/metasploit-logo-dark-external-use.svg" alt="Metasploit Logo" class="title-logo" /> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item active"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item active"><a href="/docs/code-of-conduct.html" class="nav-list-link">Code Of Conduct</a><li class="nav-list-item active"><a href="/docs/modules.html" class="nav-list-link">Modules</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/pentesting/" class="nav-list-link">Pentesting</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-setting-module-options.html" class="nav-list-link">Setting Module Options</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-upgrading-shells-to-meterpreter.html" class="nav-list-link">Upgrading Shells to Meterpreter</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-post-gather-modules.html" class="nav-list-link">Post Gather Modules</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-http.html" class="nav-list-link">HTTP + HTTPS</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-kubernetes.html" class="nav-list-link">Kubernetes</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-mysql.html" class="nav-list-link">MySQL</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-postgresql.html" class="nav-list-link">PostgreSQL</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-smb.html" class="nav-list-link">SMB</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-ssh.html" class="nav-list-link">SSH</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-winrm.html" class="nav-list-link">WinRM</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-mssql.html" class="nav-list-link">MSSQL</a><li class="nav-list-item active"><a href="/docs/pentesting/metasploit-guide-ldap.html" class="nav-list-link">LDAP</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/pentesting/active-directory/" class="nav-list-link">Active Directory</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/pentesting/active-directory/ad-certificates/" class="nav-list-link">AD CS</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/ad-certificates/overview.html" class="nav-list-link">Overview</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/ad-certificates/attacking-ad-cs-esc-vulnerabilities.html" class="nav-list-link">Attacking AD CS ESC Vulnerabilities Using Metasploit</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/ad-certificates/ldap_esc_vulnerable_cert_finder.html" class="nav-list-link">Vulnerable cert finder</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/ad-certificates/ad_cs_cert_template.html" class="nav-list-link">Manage certificate templates</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/ad-certificates/icpr_cert.html" class="nav-list-link">Request certificates</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/pentesting/active-directory/kerberos/" class="nav-list-link">Kerberos</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/overview.html" class="nav-list-link">Overview</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/service_authentication.html" class="nav-list-link">Authenticating to SMB/WinRM/etc</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/kerberos_login.html" class="nav-list-link">Kerberos login enumeration and bruteforcing</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/get_ticket.html" class="nav-list-link">Get Ticket granting tickets and service tickets</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/ticket_converter.html" class="nav-list-link">Converting kirbi and ccache files</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/forge_ticket.html" class="nav-list-link">Forging tickets</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/inspect_ticket.html" class="nav-list-link">Inspecting tickets</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/kerberoasting.html" class="nav-list-link">Kerberoasting</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/keytab.html" class="nav-list-link">Keytab support and decrypting wireshark traffic</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/rbcd.html" class="nav-list-link">Resource-based constrained delegation (RBCD)</a><li class="nav-list-item active"><a href="/docs/pentesting/active-directory/kerberos/unconstrained_delegation.html" class="nav-list-link">Unconstrained delegation</a></ul></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/" class="nav-list-link">Using Metasploit</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/getting-started/" class="nav-list-link">Getting Started</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/getting-started/nightly-installers.html" class="nav-list-link">Nightly Installers</a><li class="nav-list-item active"><a href="/docs/using-metasploit/getting-started/reporting-a-bug.html" class="nav-list-link">Reporting a Bug</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/basics/" class="nav-list-link">Basics</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/using-metasploit.html" class="nav-list-link">Running modules</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/how-to-use-a-metasploit-module-appropriately.html" class="nav-list-link">How to use a Metasploit module appropriately</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/how-payloads-work.html" class="nav-list-link">How payloads work</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/module-documentation.html" class="nav-list-link">Module Documentation</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/how-to-use-a-reverse-shell-in-metasploit.html" class="nav-list-link">How to use a reverse shell in Metasploit</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/how-to-use-msfvenom.html" class="nav-list-link">How to use msfvenom</a><li class="nav-list-item active"><a href="/docs/using-metasploit/basics/managing-sessions.html" class="nav-list-link">Managing Sessions</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/intermediate/" class="nav-list-link">Intermediate</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/metasploit-database-support.html" class="nav-list-link">Database Support</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/evading-anti-virus.html" class="nav-list-link">Evading Anti Virus</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/exploit-ranking.html" class="nav-list-link">Exploit Ranking</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/hashes-and-password-cracking.html" class="nav-list-link">Hashes and Password Cracking</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/how-to-use-plugins.html" class="nav-list-link">Metasploit Plugins</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/payload-uuid.html" class="nav-list-link">Payload UUID</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/pivoting-in-metasploit.html" class="nav-list-link">Pivoting in Metasploit</a><li class="nav-list-item active"><a href="/docs/using-metasploit/intermediate/running-private-modules.html" class="nav-list-link">Running Private Modules</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/advanced/" class="nav-list-link">Advanced</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/how-to-configure-dns.html" class="nav-list-link">How to Configure DNS</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/metasploit-web-service.html" class="nav-list-link">Metasploit Web Service</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/advanced/meterpreter/" class="nav-list-link">Meterpreter</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter.html" class="nav-list-link">Overview</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-configuration.html" class="nav-list-link">Configuration</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/debugging-dead-meterpreter-sessions.html" class="nav-list-link">Debugging Dead Meterpreter Sessions</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-debugging-meterpreter-sessions.html" class="nav-list-link">Debugging Meterpreter Sessions</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-executebof-command.html" class="nav-list-link">ExecuteBof Command</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-http-communication.html" class="nav-list-link">HTTP Communication</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/how-to-get-started-with-writing-a-meterpreter-script.html" class="nav-list-link">How to get started with writing a Meterpreter script</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-paranoid-mode.html" class="nav-list-link">Paranoid Mode</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/powershell-extension.html" class="nav-list-link">Powershell Extension</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/python-extension.html" class="nav-list-link">Python Extension</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-reg-command.html" class="nav-list-link">Reg Command</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-reliable-network-communication.html" class="nav-list-link">Reliable Network Communication</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-sleep-control.html" class="nav-list-link">Sleep Control</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-stageless-mode.html" class="nav-list-link">Stageless Mode</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/the-ins-and-outs-of-http-and-https-communications-in-meterpreter-and-metasploit-stagers.html" class="nav-list-link">The ins and outs of HTTP and HTTPS communications in Meterpreter and Metasploit Stagers</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-timeout-control.html" class="nav-list-link">Timeout Control</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-transport-control.html" class="nav-list-link">Transport Control</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-unicode-support.html" class="nav-list-link">Unicode Support</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/meterpreter/meterpreter-wishlist.html" class="nav-list-link">Wishlist</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/advanced/RPC/" class="nav-list-link">RPC</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/RPC/how-to-use-metasploit-json-rpc.html" class="nav-list-link">How to use Metasploit JSON RPC</a><li class="nav-list-item active"><a href="/docs/using-metasploit/advanced/RPC/how-to-use-metasploit-messagepack-rpc.html" class="nav-list-link">How to use Metasploit Messagepack RPC</a></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/other/" class="nav-list-link">Other</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/other/how-to-use-metasploit-with-ngrok.html" class="nav-list-link">How to use Metasploit with ngrok</a><li class="nav-list-item active"><a href="/docs/using-metasploit/other/how-to-use-the-favorite-command.html" class="nav-list-link">How to use the Favorite command</a><li class="nav-list-item active"><a href="/docs/using-metasploit/other/information-about-unmet-browser-exploit-requirements.html" class="nav-list-link">Information About Unmet Browser Exploit Requirements</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/using-metasploit/other/oracle-support/" class="nav-list-link">Oracle Support</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/using-metasploit/other/oracle-support/how-to-get-oracle-support-working-with-kali-linux.html" class="nav-list-link">How to get Oracle Support working with Kali Linux</a><li class="nav-list-item active"><a href="/docs/using-metasploit/other/oracle-support/oracle-usage.html" class="nav-list-link">Oracle Usage</a></ul><li class="nav-list-item active"><a href="/docs/using-metasploit/other/why-cve-is-not-available.html" class="nav-list-link">Why CVE is not available</a></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/" class="nav-list-link active">Development</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/get-started/" class="nav-list-link">Get Started</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/get-started/contributing-to-metasploit.html" class="nav-list-link">Contributing to Metasploit</a><li class="nav-list-item active"><a href="/docs/development/get-started/creating-your-first-pr.html" class="nav-list-link">Creating Your First PR</a><li class="nav-list-item active"><a href="/docs/development/get-started/setting-up-a-metasploit-development-environment.html" class="nav-list-link">Setting Up a Metasploit Development Environment</a><li class="nav-list-item active"><a href="/docs/development/get-started/sanitizing-pcaps.html" class="nav-list-link">Sanitizing PCAPs</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/get-started/git/" class="nav-list-link">Git</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/get-started/git/git-reference-sites.html" class="nav-list-link">Git Reference Sites</a><li class="nav-list-item active"><a href="/docs/development/get-started/git/git-cheatsheet.html" class="nav-list-link">Git cheatsheet</a><li class="nav-list-item active"><a href="/docs/development/get-started/git/keeping-in-sync-with-rapid7-master.html" class="nav-list-link">Keeping in sync with rapid7 master</a><li class="nav-list-item active"><a href="/docs/development/get-started/git/remote-branch-pruning.html" class="nav-list-link">Remote Branch Pruning</a><li class="nav-list-item active"><a href="/docs/development/get-started/git/using-git.html" class="nav-list-link">Using Git</a></ul><li class="nav-list-item active"><a href="/docs/development/get-started/navigating-and-understanding-metasploits-codebase.html" class="nav-list-link">Navigating the codebase</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/" class="nav-list-link active">Developing Modules</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/guides/" class="nav-list-link active">Guides</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/guides/scanners/" class="nav-list-link active">Scanners</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/scanners/how-to-write-a-http-loginscanner-module.html" class="nav-list-link">Writing a HTTP LoginScanner</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/scanners/creating-metasploit-framework-loginscanners.html" class="nav-list-link active">Writing an FTP LoginScanner</a></ul><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-check-microsoft-patch-levels-for-your-exploit.html" class="nav-list-link">How to check Microsoft patch levels for your exploit</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-use-fetch-payloads.html" class="nav-list-link">How to use Fetch Payloads</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-use-command-stagers.html" class="nav-list-link">How to use command stagers</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-write-a-check-method.html" class="nav-list-link">How to write a check method</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-write-a-cmd-injection-module.html" class="nav-list-link">How to write a cmd injection module</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-write-a-browser-exploit-using-httpserver.html" class="nav-list-link">Writing a browser exploit</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-get-started-with-writing-a-post-module.html" class="nav-list-link">Writing a post module</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/how-to-get-started-with-writing-an-auxiliary-module.html" class="nav-list-link">Writing an auxiliary module</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/guides/get-started-writing-an-exploit.html" class="nav-list-link">Writing an exploit</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/external-modules/" class="nav-list-link">External Modules</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/external-modules/writing-external-metasploit-modules.html" class="nav-list-link">Overview</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/external-modules/writing-external-golang-modules.html" class="nav-list-link">Writing GoLang Modules</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/external-modules/writing-external-python-modules.html" class="nav-list-link">Writing Python Modules</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/module-metadata/" class="nav-list-link">Module metadata</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/module-metadata/definition-of-module-reliability-side-effects-and-stability.html" class="nav-list-link">Definition of Module Reliability Side Effects and Stability</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/module-metadata/how-to-use-datastore-options.html" class="nav-list-link">How to use datastore options</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/module-metadata/module-reference-identifiers.html" class="nav-list-link">Module Reference Identifiers</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/" class="nav-list-link">Libraries</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/api.html" class="nav-list-link">API</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-msf-auxiliary-authbrute-to-write-a-bruteforcer.html" class="nav-list-link">AuthBrute</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-cleanup-after-module-execution.html" class="nav-list-link">Cleanup</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/c/" class="nav-list-link">Compiling C</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/c/how-to-use-metasploit-framework-compiler-windows-to-compile-c-code.html" class="nav-list-link">Overview</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/c/how-to-decode-base64-with-metasploit-framework-compiler.html" class="nav-list-link">Base64 Support</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/c/how-to-decrypt-rc4-with-metasploit-framework-compiler.html" class="nav-list-link">RC4 Support</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/c/how-to-xor-with-metasploit-framework-compiler.html" class="nav-list-link">XOR Support</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/deserialization/" class="nav-list-link">Deserialization</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/deserialization/dot-net-deserialization.html" class="nav-list-link">Dot Net Deserialization</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/deserialization/generating-ysoserial-java-serialized-objects.html" class="nav-list-link">Java Deserialization</a></ul><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/handling-module-failures-with-fail_with.html" class="nav-list-link">Fail_with</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-the-fileformat-mixin-to-create-a-file-format-exploit.html" class="nav-list-link">Fileformat</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-the-git-mixin-to-write-an-exploit-module.html" class="nav-list-link">Git Mixin</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/http/" class="nav-list-link">HTTP</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/http/how-to-write-a-browser-exploit-using-browserexploitserver.html" class="nav-list-link">BrowserExploitServer</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/http/how-to-send-an-http-request-using-httpclient.html" class="nav-list-link">How to Send an HTTP Request Using HttpClient</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/http/how-to-parse-an-http-response.html" class="nav-list-link">How to parse an HTTP response</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/http/how-to-send-an-http-request-using-rex-proto-http-client.html" class="nav-list-link">How to send an HTTP request using Rex Proto Http Client</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/http/how-to-write-a-module-using-httpserver-and-httpclient.html" class="nav-list-link">How to write a module using HttpServer and HttpClient</a></ul><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-log-in-metasploit.html" class="nav-list-link">Logging</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/obfuscation/" class="nav-list-link">Obfuscation</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/obfuscation/how-to-use-metasploit-framework-obfuscation-crandomizer.html" class="nav-list-link">C Obfuscation</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/obfuscation/how-to-obfuscate-javascript-in-metasploit.html" class="nav-list-link">JavaScript Obfuscation</a></ul><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-phpexe-to-exploit-an-arbitrary-file-upload-bug.html" class="nav-list-link">PhpExe</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-powershell-in-an-exploit.html" class="nav-list-link">Powershell</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-railgun-for-windows-post-exploitation.html" class="nav-list-link">Railgun</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/using-reflectivedll-injection.html" class="nav-list-link">ReflectiveDLL Injection</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-do-reporting-or-store-data-in-module-development.html" class="nav-list-link">Reporting and Storing Data</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-the-seh-mixin-to-exploit-an-exception-handler.html" class="nav-list-link">SEH Exploitation</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/developing-modules/libraries/smb_library/" class="nav-list-link">SMB Library</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/smb_library/guidelines-for-writing-modules-with-smb.html" class="nav-list-link">Guidelines for Writing Modules with SMB</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/smb_library/what-my-rex-proto-smb-error-means.html" class="nav-list-link">What my Rex Proto SMB Error means</a></ul><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/sql-injection-libraries.html" class="nav-list-link">SQL Injection</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-the-msf-exploit-remote-tcp-mixin.html" class="nav-list-link">TCP</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-use-wbemexec-for-a-write-privilege-attack-on-windows.html" class="nav-list-link">WbemExec</a><li class="nav-list-item active"><a href="/docs/development/developing-modules/libraries/how-to-zip-files-with-msf-util-exe-to_zip.html" class="nav-list-link">Zip</a></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/google-summer-of-code/" class="nav-list-link">Google Summer of Code</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2017-mentor-organization-application.html" class="nav-list-link">2017 Mentor Organization Application</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2017-project-ideas.html" class="nav-list-link">2017 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2017-student-proposal.html" class="nav-list-link">2017 Student Proposal</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2018-project-ideas.html" class="nav-list-link">2018 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2019-project-ideas.html" class="nav-list-link">2019 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2020-project-ideas.html" class="nav-list-link">2020 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2021-project-ideas.html" class="nav-list-link">2021 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2022-project-ideas.html" class="nav-list-link">2022 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/gsoc-2023-project-ideas.html" class="nav-list-link">2023 Project Ideas</a><li class="nav-list-item active"><a href="/docs/development/google-summer-of-code/how-to-apply-to-gsoc.html" class="nav-list-link">How to Apply to GSoC</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/maintainers/" class="nav-list-link">Maintainers</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/maintainers/committer-keys.html" class="nav-list-link">Committer Keys</a><li class="nav-list-item active"><a href="/docs/development/maintainers/committer-rights.html" class="nav-list-link">Committer Rights</a><li class="nav-list-item active"><a href="/docs/development/maintainers/downloads-by-version.html" class="nav-list-link">Downloads by Version</a><li class="nav-list-item active"><a href="/docs/development/maintainers/metasploit-hackathons.html" class="nav-list-link">Metasploit Hackathons</a><li class="nav-list-item active"><a href="/docs/development/maintainers/metasploit-loginpalooza.html" class="nav-list-link">Metasploit Loginpalooza</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/maintainers/process/" class="nav-list-link">Process</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/maintainers/process/assigning-labels.html" class="nav-list-link">Assigning Labels</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/guidelines-for-accepting-modules-and-enhancements.html" class="nav-list-link">Guidelines for Accepting Modules and Enhancements</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/how-to-deprecate-a-metasploit-module.html" class="nav-list-link">How to deprecate a Metasploit module</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/landing-pull-requests.html" class="nav-list-link">Landing Pull Requests</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/adding-release-notes-to-prs.html" class="nav-list-link">Release Notes</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/rolling-back-merges.html" class="nav-list-link">Rolling back merges</a><li class="nav-list-item active"><a href="/docs/development/maintainers/process/unstable-modules.html" class="nav-list-link">Unstable Modules</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/maintainers/ruby-gems/" class="nav-list-link">Ruby Gems</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/maintainers/ruby-gems/how-to-add-and-update-gems-in-metasploit-framework.html" class="nav-list-link">Adding and Updating</a><li class="nav-list-item active"><a href="/docs/development/maintainers/ruby-gems/merging-metasploit-payload-gem-updates.html" class="nav-list-link">Merging Metasploit Payload Gem Updates</a><li class="nav-list-item active"><a href="/docs/development/maintainers/ruby-gems/using-local-gems.html" class="nav-list-link">Using local Gems</a></ul></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/propsals/" class="nav-list-link">Proposals</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/propsals/bundled-modules-proposal.html" class="nav-list-link">Bundled Modules Proposal</a><li class="nav-list-item active"><a href="/docs/development/propsals/java-meterpreter-feature-parity-proposal.html" class="nav-list-link">Java Meterpreter Feature Parity Proposal</a><li class="nav-list-item active"><a href="/docs/development/propsals/msf6-feature-proposals.html" class="nav-list-link">MSF6 Feature Proposals</a><li class="nav-list-item active"><a href="/docs/development/propsals/metasploit-url-support-proposal.html" class="nav-list-link">Metasploit URL support proposal</a><li class="nav-list-item active"><a href="/docs/development/propsals/payload-rename-justification.html" class="nav-list-link">Payload Rename Justification</a><li class="nav-list-item active"><a href="/docs/development/propsals/uberhandler.html" class="nav-list-link">Uberhandler</a><li class="nav-list-item active"><a href="/docs/development/propsals/work-needed-to-allow-msfdb-to-use-postgresql-common.html" class="nav-list-link">Work needed to allow msfdb to use postgresql common</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/quality/" class="nav-list-link">Quality</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/quality/common-metasploit-module-coding-mistakes.html" class="nav-list-link">Common Metasploit Module Coding Mistakes</a><li class="nav-list-item active"><a href="/docs/development/quality/loading-test-modules.html" class="nav-list-link">Loading Test Modules</a><li class="nav-list-item active"><a href="/docs/development/quality/measuring-metasploit-performance.html" class="nav-list-link">Measuring Metasploit Performance</a><li class="nav-list-item active"><a href="/docs/development/quality/msftidy.html" class="nav-list-link">Msftidy</a><li class="nav-list-item active"><a href="/docs/development/quality/payload-testing.html" class="nav-list-link">Payload Testing</a><li class="nav-list-item active"><a href="/docs/development/quality/style-tips.html" class="nav-list-link">Style Tips</a><li class="nav-list-item active"><a href="/docs/development/quality/using-rubocop.html" class="nav-list-link">Using Rubocop</a><li class="nav-list-item active"><a href="/docs/development/quality/writing-module-documentation.html" class="nav-list-link">Writing Module Documentation</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/development/roadmap/" class="nav-list-link">Roadmap</a><ul class="nav-list"><li class="nav-list-item active"><a href="/docs/development/roadmap/2017-roadmap.html" class="nav-list-link">2017 Roadmap</a><li class="nav-list-item active"><a href="/docs/development/roadmap/2017-roadmap-review.html" class="nav-list-link">2017 Roadmap Review</a><li class="nav-list-item active"><a href="/docs/development/roadmap/metasploit-breaking-changes.html" class="nav-list-link">Metasploit Breaking Changes</a><li class="nav-list-item active"><a href="/docs/development/roadmap/metasploit-data-service-enhancements-goliath.html" class="nav-list-link">Metasploit Data Service</a><li class="nav-list-item active"><a href="/docs/development/roadmap/metasploit-5-release-notes.html" class="nav-list-link">Metasploit Framework 5.0 Release Notes</a><li class="nav-list-item active"><a href="/docs/development/roadmap/metasploit-6-release-notes.html" class="nav-list-link">Metasploit Framework 6.0 Release Notes</a><li class="nav-list-item active"><a href="/docs/development/roadmap/metasploit-framework-wish-list.html" class="nav-list-link">Metasploit Framework Wish List</a></ul></ul><li class="nav-list-item active"><a href="/docs/contact.html" class="nav-list-link">Contact</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Metasploit Documentation" aria-label="Search Metasploit Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><link rel="stylesheet" href="/assets/css/main.css"><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/rapid7/metasploit-framework" class="site-button" target="_blank" rel="noopener noreferrer" > Metasploit Framework on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"> <a href="/docs/development/">Development</a><li class="breadcrumb-nav-list-item"> <a href="/docs/development/developing-modules/">Developing Modules</a><li class="breadcrumb-nav-list-item"> <a href="/docs/development/developing-modules/guides/">Guides</a><li class="breadcrumb-nav-list-item"> <a href="/docs/development/developing-modules/guides/scanners/">Scanners</a><li class="breadcrumb-nav-list-item"> <span>Writing an FTP LoginScanner</span></ol></nav><div id="main-content" class="main-content" role="main"><p>So, you want to make a Login Scanner Module in Metasploit, eh? There are a few things you will need to know before you begin. This article will try to illustrate all the moving pieces involved in creating an effective bruteforce/login scanner module.</p><ul><li><a href="#credential-objects">Credential objects</a><li><a href="#result-objects">Result objects</a><li><a href="#credentialcollection">CredentialCollection</a><li><a href="#loginscanner-base">LoginScanner Base</a><ul><li><a href="#attributes">Attributes</a><li><a href="#methods">Methods</a><li><a href="#constants">Constants</a></ul><li><a href="#pulling-it-all-together-in-a-module">Pulling it all Together in a module</a><ul><li><a href="#the-cred-collection">The Cred Collection</a><li><a href="#initialising-the-scanner">Initialising the Scanner</a><li><a href="#the-scan-block">The scan block</a><li><a href="#ftp_login-final-view">ftp_login final view</a></ul></ul><h1 id="credential-objects"> <a href="#credential-objects" class="anchor-heading" aria-labelledby="credential-objects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Credential Objects</h1><p><code class="language-plaintext highlighter-rouge">Metasploit::Framework::Credential (lib/metasploit/framework/credential.rb)</code></p><p>These objects represent the most basic concept of how we now think about Credentials.</p><ul><li><strong>Public</strong>: The public part of a credential refers to the part that can be publicly known. In almost all cases this is the username.<li><strong>Private</strong>: The private part of the credential, this is the part that should be a secret. This currently represents: Password, SSH Key, NTLM Hash etc.<li><strong>Private Type</strong>: This defines what type of private credential is defined above<li><strong>Realm</strong>: This represents an authentication realm that the credential is valid for. This is a tertiary part of the authentication process. Examples include: Active Directory Domain, Postgres Database etc.<li><strong>Realm Key</strong>: This defines what type of Realm the Realm Attribute represents.<li><strong>Paired</strong>: This attribute is a boolean value that sets whether the Credential must have both a public and private to be valid.</ul><p>All LoginScanners use Credential objects as the basis for their attempts.</p><h1 id="result-objects"> <a href="#result-objects" class="anchor-heading" aria-labelledby="result-objects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Result Objects</h1><p><code class="language-plaintext highlighter-rouge">Metasploit::Framework::LoginScanner::Result (lib/metasploit/framework/login_scanner/result.rb)</code></p><p>These are the objects yielded by the <code class="language-plaintext highlighter-rouge">scan!</code> method on each <code class="language-plaintext highlighter-rouge">LoginScanner</code>. They contain:</p><ul><li><strong>Access Level</strong>: An optional Access Level which can describe the level of access granted by the login attempt.<li><strong>Credential</strong> : The Credential object that achieved that result<li><strong>Proof</strong>: An optional proof string to show why we think the result is valid<li><strong>Status</strong>: The status of the login attempt. These values come from Metasploit::model::Login::Status , examples include “Incorrect”, “Unable to Connect”, “Untried” etc</ul><h1 id="credentialcollection"> <a href="#credentialcollection" class="anchor-heading" aria-labelledby="credentialcollection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CredentialCollection</h1><p><code class="language-plaintext highlighter-rouge">Metasploit::Framework::CredentialCollection (lib/metasploit/framework/credential_collection.rb)</code></p><p>This class is created by the <code class="language-plaintext highlighter-rouge">build_credential_collection</code> method provided by the <code class="language-plaintext highlighter-rouge">Msf::Auxiliary::AuthBrute</code> mixin. It takes a bunch of options that when specified, will take priority over the corresponding datastore options. Typical uses only need to specify the <code class="language-plaintext highlighter-rouge">username:</code> and <code class="language-plaintext highlighter-rouge">password:</code> options since those can be different from one module to another (e.g. ‘USERNAME’, ‘SMBUser’, ‘HttpUsername’, etc.). It can be passed in as the <code class="language-plaintext highlighter-rouge">cred_details</code> on the <code class="language-plaintext highlighter-rouge">LoginScanner</code>, and responds to #each and yields crafted Credentials.</p><p>The <code class="language-plaintext highlighter-rouge">build_credential_collection</code> method will handle prepending usernames and passwords as well as skipping entries as configured by the <code class="language-plaintext highlighter-rouge">DB_SKIP_EXISTING</code> option.</p><p><strong>Example (from modules/auxiliary/scanner/ftp/ftp_login.rb)</strong>:</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cred_collection</span> <span class="o">=</span> <span class="n">build_credential_collection</span><span class="p">(</span>
    <span class="ss">username: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USERNAME'</span><span class="p">],</span>
    <span class="ss">password: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PASSWORD'</span><span class="p">],</span>
    <span class="ss">prepended_creds: </span><span class="n">anonymous_creds</span>
<span class="p">)</span>
</code></pre></div></div><h1 id="loginscanner-base"> <a href="#loginscanner-base" class="anchor-heading" aria-labelledby="loginscanner-base"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LoginScanner Base</h1><p><code class="language-plaintext highlighter-rouge">Metasploit::Framework::LoginScanner::Base (lib/metasploit/framework/login_scanner/base.rb)</code></p><p>This is a Ruby Module that contains all the base behaviour for all <code class="language-plaintext highlighter-rouge">LoginScanners</code>. All <code class="language-plaintext highlighter-rouge">LoginScanner</code> classes should include this module.</p><p>The specs for this behaviour are kept in a shared example group. Specs for your <code class="language-plaintext highlighter-rouge">LoginScanner</code> should use the following syntax to include these tests:</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">it_behaves_like</span> <span class="s1">'Metasploit::Framework::LoginScanner::Base'</span><span class="p">,</span> <span class="ss">has_realm_key: </span><span class="kp">false</span><span class="p">,</span> <span class="ss">has_default_realm: </span><span class="kp">false</span>
</code></pre></div></div><p>Where <code class="language-plaintext highlighter-rouge">has_realm_key</code> and <code class="language-plaintext highlighter-rouge">has_default_realm</code> should be set according to whether your <code class="language-plaintext highlighter-rouge">LoginScanner</code> has those things. (More on this later)</p><p>LoginScanners always take a collection of Credentials to try and one host and port. So each <code class="language-plaintext highlighter-rouge">LoginScanner</code> object attempts to login to only one specific service.</p><h2 id="attributes"> <a href="#attributes" class="anchor-heading" aria-labelledby="attributes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Attributes</h2><ul><li><strong><code class="language-plaintext highlighter-rouge">connection_timeout</code></strong>: The time to wait for a connection to timeout<li><strong><code class="language-plaintext highlighter-rouge">cred_details</code></strong>: An object that yields credentials on each (like credentialCollection or an Array)<li><strong><code class="language-plaintext highlighter-rouge">host</code></strong>: The address for the target host<li><strong><code class="language-plaintext highlighter-rouge">port</code></strong>: The port number for the target service<li><strong><code class="language-plaintext highlighter-rouge">proxies</code></strong>: Any proxies to use in the connection (some scanners might not support this)<li><strong><code class="language-plaintext highlighter-rouge">stop_on_success</code></strong>: Whether to stop trying after a successful login is found</ul><h2 id="methods"> <a href="#methods" class="anchor-heading" aria-labelledby="methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Methods</h2><h3 id="each_credential"> <a href="#each_credential" class="anchor-heading" aria-labelledby="each_credential"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> each_credential</h3><p>You will not have to worry much about this method, Be aware that it is there. It iterates through whatever is in <code class="language-plaintext highlighter-rouge">cred_details</code>, does some normalization and tries to make sure each Credential is properly setup for use by the given <code class="language-plaintext highlighter-rouge">LoginScanner</code>. It yields each Credential in a block.</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">each_credential</span>
  <span class="n">cred_details</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">raw_cred</span><span class="o">|</span>
    <span class="c1"># This could be a Credential object, or a Credential Core, or an Attempt object</span>
    <span class="c1"># so make sure that whatever it is, we end up with a Credential.</span>
    <span class="n">credential</span> <span class="o">=</span> <span class="n">raw_cred</span><span class="p">.</span><span class="nf">to_credential</span>

    <span class="k">if</span> <span class="n">credential</span><span class="p">.</span><span class="nf">realm</span><span class="p">.</span><span class="nf">present?</span> <span class="o">&amp;&amp;</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">REALM_KEY</span><span class="p">.</span><span class="nf">present?</span>
      <span class="n">credential</span><span class="p">.</span><span class="nf">realm_key</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">REALM_KEY</span>
      <span class="k">yield</span> <span class="n">credential</span>
    <span class="k">elsif</span> <span class="n">credential</span><span class="p">.</span><span class="nf">realm</span><span class="p">.</span><span class="nf">blank?</span> <span class="o">&amp;&amp;</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">REALM_KEY</span><span class="p">.</span><span class="nf">present?</span> <span class="o">&amp;&amp;</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">DEFAULT_REALM</span><span class="p">.</span><span class="nf">present?</span>
      <span class="n">credential</span><span class="p">.</span><span class="nf">realm_key</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">REALM_KEY</span>
      <span class="n">credential</span><span class="p">.</span><span class="nf">realm</span>     <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">DEFAULT_REALM</span>
      <span class="k">yield</span> <span class="n">credential</span>
    <span class="k">elsif</span> <span class="n">credential</span><span class="p">.</span><span class="nf">realm</span><span class="p">.</span><span class="nf">present?</span> <span class="o">&amp;&amp;</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="o">::</span><span class="no">REALM_KEY</span><span class="p">.</span><span class="nf">blank?</span>
      <span class="n">second_cred</span> <span class="o">=</span> <span class="n">credential</span><span class="p">.</span><span class="nf">dup</span>
      <span class="c1"># Strip the realm off here, as we don't want it</span>
      <span class="n">credential</span><span class="p">.</span><span class="nf">realm</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="n">credential</span><span class="p">.</span><span class="nf">realm_key</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="k">yield</span> <span class="n">credential</span>
      <span class="c1"># Some services can take a domain in the username like this even though</span>
      <span class="c1"># they do not explicitly take a domain as part of the protocol.</span>
      <span class="n">second_cred</span><span class="p">.</span><span class="nf">public</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">second_cred</span><span class="p">.</span><span class="nf">realm</span><span class="si">}</span><span class="se">\\</span><span class="si">#{</span><span class="n">second_cred</span><span class="p">.</span><span class="nf">public</span><span class="si">}</span><span class="s2">"</span>
      <span class="n">second_cred</span><span class="p">.</span><span class="nf">realm</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="n">second_cred</span><span class="p">.</span><span class="nf">realm_key</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="k">yield</span> <span class="n">second_cred</span>
    <span class="k">else</span>
      <span class="k">yield</span> <span class="n">credential</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div><h3 id="set_sane_defaults"> <a href="#set_sane_defaults" class="anchor-heading" aria-labelledby="set_sane_defaults"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> set_sane_defaults</h3><p>This method will be overridden by each specific <code class="language-plaintext highlighter-rouge">LoginScanner</code>. This is called at the end of the initializer and sets any sane defaults for attributes that have them and were not given a specific value in the initializer.</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is a placeholder method. Each LoginScanner class</span>
<span class="c1"># will override this with any sane defaults specific to</span>
<span class="c1"># its own behaviour.</span>
<span class="c1"># @abstract</span>
<span class="c1"># @return [void]</span>
<span class="k">def</span> <span class="nf">set_sane_defaults</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">connection_timeout</span> <span class="o">=</span> <span class="mi">30</span> <span class="k">if</span> <span class="nb">self</span><span class="p">.</span><span class="nf">connection_timeout</span><span class="p">.</span><span class="nf">nil?</span>
<span class="k">end</span>
</code></pre></div></div><h3 id="attempt_login"> <a href="#attempt_login" class="anchor-heading" aria-labelledby="attempt_login"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> attempt_login</h3><p>This method is just a stub on the Base mixin. It will be overridden in each LoginScanner class to contain the logic to take one single Credential object and use it to make a login attempt against the target service. It returns a <code class="language-plaintext highlighter-rouge">::Metasploit::Framework::LoginScanner::Result</code> object containing all the information about that attempt’s result.</p><p>For an example let’s look at the attempt_login method from <code class="language-plaintext highlighter-rouge">Metasploit::Framework::LoginScanner::FTP (lib/metasploit/framework/login_scanner/ftp.rb)</code></p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># (see Base#attempt_login)</span>
<span class="k">def</span> <span class="nf">attempt_login</span><span class="p">(</span><span class="n">credential</span><span class="p">)</span>
  <span class="n">result_options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="ss">credential: </span><span class="n">credential</span>
  <span class="p">}</span>

  <span class="k">begin</span>
    <span class="n">success</span> <span class="o">=</span> <span class="n">connect_login</span><span class="p">(</span><span class="n">credential</span><span class="p">.</span><span class="nf">public</span><span class="p">,</span> <span class="n">credential</span><span class="p">.</span><span class="nf">private</span><span class="p">)</span>
  <span class="k">rescue</span> <span class="o">::</span><span class="no">EOFError</span><span class="p">,</span>  <span class="no">Rex</span><span class="o">::</span><span class="no">AddressInUse</span><span class="p">,</span> <span class="no">Rex</span><span class="o">::</span><span class="no">ConnectionError</span><span class="p">,</span> <span class="no">Rex</span><span class="o">::</span><span class="no">ConnectionProxyError</span><span class="p">,</span> <span class="no">Rex</span><span class="o">::</span><span class="no">ConnectionTimeout</span><span class="p">,</span> <span class="no">Rex</span><span class="o">::</span><span class="no">TimeoutError</span><span class="p">,</span> <span class="no">Errno</span><span class="o">::</span><span class="no">ECONNRESET</span><span class="p">,</span> <span class="no">Errno</span><span class="o">::</span><span class="no">EINTR</span><span class="p">,</span> <span class="o">::</span><span class="no">Timeout</span><span class="o">::</span><span class="no">Error</span>
    <span class="n">result_options</span><span class="p">[</span><span class="ss">:status</span><span class="p">]</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Login</span><span class="o">::</span><span class="no">Status</span><span class="o">::</span><span class="no">UNABLE_TO_CONNECT</span>
    <span class="n">success</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="k">end</span>


  <span class="k">if</span> <span class="n">success</span>
    <span class="n">result_options</span><span class="p">[</span><span class="ss">:status</span><span class="p">]</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Login</span><span class="o">::</span><span class="no">Status</span><span class="o">::</span><span class="no">SUCCESSFUL</span>
  <span class="k">elsif</span> <span class="o">!</span><span class="p">(</span><span class="n">result_options</span><span class="p">.</span><span class="nf">has_key?</span> <span class="ss">:status</span><span class="p">)</span>
    <span class="n">result_options</span><span class="p">[</span><span class="ss">:status</span><span class="p">]</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Login</span><span class="o">::</span><span class="no">Status</span><span class="o">::</span><span class="no">INCORRECT</span>
  <span class="k">end</span>

  <span class="o">::</span><span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">LoginScanner</span><span class="o">::</span><span class="no">Result</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">result_options</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div><h3 id="scan"> <a href="#scan" class="anchor-heading" aria-labelledby="scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> scan!</h3><p>This method is the main one you will be concerned with. This method does several things:</p><ul><li>It calls valid! which will check all of the validations on the class and raise an <code class="language-plaintext highlighter-rouge">Metasploit::Framework::LoginScanner::Invalid</code> if any of the Validations fail. This exception will contain all the errors messages for any failing validations.<li>it keeps track of the connection error count, and will bail out if we have too many connection errors or too many in a row<li>it runs through all of the credentials by calling each_credential with a block<li>in that block it passes each credential to <code class="language-plaintext highlighter-rouge">#attempt_login</code><li>it yields the Result object into the block it is passed<li>if stop_on_success is set it will also exit out early if it the result was a success</ul><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Attempt to login with every {Credential credential} in</span>
<span class="c1"># {#cred_details}, by calling {#attempt_login} once for each.</span>
<span class="c1">#</span>
<span class="c1"># If a successful login is found for a user, no more attempts</span>
<span class="c1"># will be made for that user.</span>
<span class="c1">#</span>
<span class="c1"># @yieldparam result [Result] The {Result} object for each attempt</span>
<span class="c1"># @yieldreturn [void]</span>
<span class="c1"># @return [void]</span>
<span class="k">def</span> <span class="nf">scan!</span>
  <span class="n">valid!</span>

  <span class="c1"># Keep track of connection errors.</span>
  <span class="c1"># If we encounter too many, we will stop.</span>
  <span class="n">consecutive_error_count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">total_error_count</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="n">successful_users</span> <span class="o">=</span> <span class="no">Set</span><span class="p">.</span><span class="nf">new</span>

  <span class="n">each_credential</span> <span class="k">do</span> <span class="o">|</span><span class="n">credential</span><span class="o">|</span>
    <span class="k">next</span> <span class="k">if</span> <span class="n">successful_users</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">credential</span><span class="p">.</span><span class="nf">public</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">attempt_login</span><span class="p">(</span><span class="n">credential</span><span class="p">)</span>
    <span class="n">result</span><span class="p">.</span><span class="nf">freeze</span>

    <span class="k">yield</span> <span class="n">result</span> <span class="k">if</span> <span class="nb">block_given?</span>

    <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">success?</span>
      <span class="n">consecutive_error_count</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">break</span> <span class="k">if</span> <span class="n">stop_on_success</span>
      <span class="n">successful_users</span> <span class="o">&lt;&lt;</span> <span class="n">credential</span><span class="p">.</span><span class="nf">public</span>
    <span class="k">else</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">status</span> <span class="o">==</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Login</span><span class="o">::</span><span class="no">Status</span><span class="o">::</span><span class="no">UNABLE_TO_CONNECT</span>
        <span class="n">consecutive_error_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">total_error_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">break</span> <span class="k">if</span> <span class="n">consecutive_error_count</span> <span class="o">&gt;=</span> <span class="mi">3</span>
        <span class="k">break</span> <span class="k">if</span> <span class="n">total_error_count</span> <span class="o">&gt;=</span> <span class="mi">10</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="kp">nil</span>
<span class="k">end</span>
</code></pre></div></div><h2 id="constants"> <a href="#constants" class="anchor-heading" aria-labelledby="constants"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Constants</h2><p>Although not defined on Base, each <code class="language-plaintext highlighter-rouge">LoginScanner</code> has a series of Constants that can be defined on it to assist with critical behaviour.</p><ul><li><strong><code class="language-plaintext highlighter-rouge">DEFAULT_PORT</code></strong>: <code class="language-plaintext highlighter-rouge">DEFAULT_PORT</code> is a simple constant for use with <code class="language-plaintext highlighter-rouge">set_sane_defaults</code>. If the port isn’t set by the user it will use <code class="language-plaintext highlighter-rouge">DEFAULT_PORT</code>. This is put in a constant so it can be quickly referenced from outside the scanner.</ul><p>These next two Constants are used by the LoginScanner namespace method classes_for_services. This method invoked by <code class="language-plaintext highlighter-rouge">Metasploit::Framework::LoginScanner.classes_for_service(&lt;Mdm::service&gt;)</code> will actually return an array of LoginScanner classes that may be useful to try against that particular Service.</p><ul><li><strong><code class="language-plaintext highlighter-rouge">LIKELY_PORTS</code></strong> : This constant holds n array of port numbers that it would be likely useful to use this scanner against.<li><p><strong><code class="language-plaintext highlighter-rouge">LIKELY_SERVICE_NAMES</code></strong> : Like above except with strings for service names instead of port numbers.</p><li><strong><code class="language-plaintext highlighter-rouge">PRIVATE_TYPES</code></strong> : This contains an array of symbols representing the different Private credential types it supports. It should always match the demodulize result for the Private class i.e :password, <code class="language-plaintext highlighter-rouge">:ntlm_hash</code>, <code class="language-plaintext highlighter-rouge">:ssh_key</code></ul><p>These constants are fore <code class="language-plaintext highlighter-rouge">LoginScanners</code> that have to deal with Realms such as AD domains or Database Names.</p><ul><li><strong><code class="language-plaintext highlighter-rouge">REALM_KEY</code></strong>: The type of Realm this scanner expects to deal with. Should always be a constants from <code class="language-plaintext highlighter-rouge">Metasploit::Model::Login::Status</code><li><p><strong><code class="language-plaintext highlighter-rouge">DEFAULT_REALM</code></strong>: Some scanners have a default realm (like WORKSTATION for AD domain stuff). If a credential is given to a scanner that requires a realm, but the credential has no realm, this value will be added to the credential as the realm.</p><li><strong><code class="language-plaintext highlighter-rouge">CAN_GET_SESSION</code></strong>: this should be either true or false as to whether we expect we could somehow get a session with a Credential found from this scanner.</ul><p><strong>example1 ( Metasploit::Framework::LoginScanner::FTP)</strong></p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">DEFAULT_PORT</span>         <span class="o">=</span> <span class="mi">21</span>
<span class="no">LIKELY_PORTS</span>         <span class="o">=</span> <span class="p">[</span> <span class="no">DEFAULT_PORT</span><span class="p">,</span> <span class="mi">2121</span> <span class="p">]</span>
<span class="no">LIKELY_SERVICE_NAMES</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'ftp'</span> <span class="p">]</span>
<span class="no">PRIVATE_TYPES</span>        <span class="o">=</span> <span class="p">[</span> <span class="ss">:password</span> <span class="p">]</span>
<span class="no">REALM_KEY</span>           <span class="o">=</span> <span class="kp">nil</span>
</code></pre></div></div><p><strong>example2 ( Metasploit::Framework::LoginScanner::SMB)</strong></p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">CAN_GET_SESSION</span>      <span class="o">=</span> <span class="kp">true</span>
<span class="no">DEFAULT_REALM</span>        <span class="o">=</span> <span class="s1">'WORKSTATION'</span>
<span class="no">LIKELY_PORTS</span>         <span class="o">=</span> <span class="p">[</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">445</span> <span class="p">]</span>
<span class="no">LIKELY_SERVICE_NAMES</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">"smb"</span> <span class="p">]</span>
<span class="no">PRIVATE_TYPES</span>        <span class="o">=</span> <span class="p">[</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">:ntlm_hash</span> <span class="p">]</span>
<span class="no">REALM_KEY</span>            <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Realm</span><span class="o">::</span><span class="no">Key</span><span class="o">::</span><span class="no">ACTIVE_DIRECTORY_DOMAIN</span>
</code></pre></div></div><h1 id="pulling-it-all-together-in-a-module"> <a href="#pulling-it-all-together-in-a-module" class="anchor-heading" aria-labelledby="pulling-it-all-together-in-a-module"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pulling it all Together in a module</h1><p>So now you hopefully have a good idea of all the moving pieces involved in creating a LoginScanner. The next step is using your brand new LoginScanner in an actual module.</p><p>Let’s look at the <code class="language-plaintext highlighter-rouge">ftp_login</code> module:</p><p><code class="language-plaintext highlighter-rouge">def run_host(ip)</code></p><p>Every Bruteforce/Login module should be a scanner and should use the run_host method which will run once for each RHOST.</p><h2 id="the-cred-collection"> <a href="#the-cred-collection" class="anchor-heading" aria-labelledby="the-cred-collection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Cred Collection</h2><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cred_collection</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">CredentialCollection</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
    <span class="ss">blank_passwords: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'BLANK_PASSWORDS'</span><span class="p">],</span>
    <span class="ss">pass_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PASS_FILE'</span><span class="p">],</span>
    <span class="ss">password: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PASSWORD'</span><span class="p">],</span>
    <span class="ss">user_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USER_FILE'</span><span class="p">],</span>
    <span class="ss">userpass_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USERPASS_FILE'</span><span class="p">],</span>
    <span class="ss">username: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USERNAME'</span><span class="p">],</span>
    <span class="ss">user_as_pass: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USER_AS_PASS'</span><span class="p">],</span>
    <span class="ss">prepended_creds: </span><span class="n">anonymous_creds</span>
<span class="p">)</span>
</code></pre></div></div><p>So here we see the CredentialCollection getting created using the datastore options. We pass in the options for Cred creation such as wordlists, raw usernames and passwords, whether to try the username as a password, and whether to try blank passwords.</p><p>you’ll also notice an option here called <code class="language-plaintext highlighter-rouge">prepended_creds</code>. FTP is one of the only module to make use of this, but it is generally available through the CredentialCollection. This option is an array of <code class="language-plaintext highlighter-rouge">Metasploit::Framework::Credential</code> objects that should be spit back by the collection before any others. FTP uses this to deal with testing for anon FTP access.</p><h2 id="initialising-the-scanner"> <a href="#initialising-the-scanner" class="anchor-heading" aria-labelledby="initialising-the-scanner"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Initialising the Scanner</h2><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scanner</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">LoginScanner</span><span class="o">::</span><span class="no">FTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="ss">host: </span><span class="n">ip</span><span class="p">,</span>
  <span class="ss">port: </span><span class="n">rport</span><span class="p">,</span>
  <span class="ss">proxies: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PROXIES'</span><span class="p">],</span>
  <span class="ss">cred_details: </span><span class="n">cred_collection</span><span class="p">,</span>
  <span class="ss">stop_on_success: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'STOP_ON_SUCCESS'</span><span class="p">],</span>
  <span class="ss">connection_timeout: </span><span class="mi">30</span>
<span class="p">)</span>
</code></pre></div></div><p>Here we actually create our Scanner object. We set the IP and Port based on data the module already knows about. We can pull any user supplied proxy data from the datatstore. we also pull from the datastore whether to stop on a success for this service. The cred details object is populated by our Credentialcollection which will handle all the credential generation for us invisibly.</p><p>This gives us our scanner object, all configured and ready to go.</p><h2 id="the-scan-block"> <a href="#the-scan-block" class="anchor-heading" aria-labelledby="the-scan-block"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Scan Block</h2><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scanner</span><span class="p">.</span><span class="nf">scan!</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
  <span class="n">credential_data</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">to_h</span>
  <span class="n">credential_data</span><span class="p">.</span><span class="nf">merge!</span><span class="p">(</span>
      <span class="ss">module_fullname: </span><span class="nb">self</span><span class="p">.</span><span class="nf">fullname</span><span class="p">,</span>
      <span class="ss">workspace_id: </span><span class="n">myworkspace_id</span>
  <span class="p">)</span>
  <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">success?</span>
    <span class="n">credential_core</span> <span class="o">=</span> <span class="n">create_credential</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>
    <span class="n">credential_data</span><span class="p">[</span><span class="ss">:core</span><span class="p">]</span> <span class="o">=</span> <span class="n">credential_core</span>
    <span class="n">create_credential_login</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>

    <span class="n">print_good</span> <span class="s2">"</span><span class="si">#{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - LOGIN SUCCESSFUL: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">credential</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">else</span>
    <span class="n">invalidate_login</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>
    <span class="n">print_status</span> <span class="s2">"</span><span class="si">#{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - LOGIN FAILED: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">credential</span><span class="si">}</span><span class="s2"> (</span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">status</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">proof</span><span class="si">}</span><span class="s2">)"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div><p>This is the real heart of the matter here. We call s<code class="language-plaintext highlighter-rouge">can!</code> on our scanner, and pass it a block. As we mentioned before, the scanner yields each attempt’s Result object into that block. We check the result’s status to see if it was successful or not.</p><p>The result object now as a <code class="language-plaintext highlighter-rouge">.to_h</code> method which returns a hash compatible with our credential creation methods. We take that hash and merge in our module specific information and workspace id.</p><p>In the case of a success we build some info hashes and call <code class="language-plaintext highlighter-rouge">create_credential</code>. This is a method found in the metasploit-credential gem under <code class="language-plaintext highlighter-rouge">lib/metasploit/credential/creation.rb</code> in a mixin called <code class="language-plaintext highlighter-rouge">Metasploit::Credential::Creation</code>. This mixin is included in the Report mixin, so if your module includes that mixin you’ll get these methods for free.</p><p><code class="language-plaintext highlighter-rouge">create_credential</code> creates a <code class="language-plaintext highlighter-rouge">Metasploit::Credential::Core</code>. We then take that core, the service data, and merge it with some additional data. This additional data includes the access level, the current time (to update last_attempted_at on the <code class="language-plaintext highlighter-rouge">Metasploit::Credential::Login</code>), the status.</p><p>Finally, for a success, we output the result to the console.</p><p>In the case of a failure, we call the <code class="language-plaintext highlighter-rouge">invalidate_login</code> method. This method also comes from the Creation mixin. This method looks to see if a Login object already exists for this credential:service pair. If it does, it updates the status to the status we got back from the scanner. This is primarily to account for Login objects created by things like Post modules that have an untried status.</p><h2 id="ftp_login-final-view"> <a href="#ftp_login-final-view" class="anchor-heading" aria-labelledby="ftp_login-final-view"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">ftp_login</code> Final View</h2><p>Pulling it all together, we get a new <code class="language-plaintext highlighter-rouge">ftp_login</code> module that looks something like this:</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##</span>
<span class="c1"># This module requires Metasploit: http//metasploit.com/download</span>
<span class="c1"># Current source: https://github.com/rapid7/metasploit-framework</span>
<span class="c1">##</span>

<span class="nb">require</span> <span class="s1">'metasploit/framework/credential_collection'</span>
<span class="nb">require</span> <span class="s1">'metasploit/framework/login_scanner/ftp'</span>

<span class="k">class</span> <span class="nc">Metasploit3</span> <span class="o">&lt;</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Auxiliary</span>

  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span><span class="o">::</span><span class="no">Ftp</span>
  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Auxiliary</span><span class="o">::</span><span class="no">Scanner</span>
  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Auxiliary</span><span class="o">::</span><span class="no">Report</span>
  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Auxiliary</span><span class="o">::</span><span class="no">AuthBrute</span>

  <span class="k">def</span> <span class="nf">proto</span>
    <span class="s1">'ftp'</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="k">super</span><span class="p">(</span>
      <span class="s1">'Name'</span>        <span class="o">=&gt;</span> <span class="s1">'FTP Authentication Scanner'</span><span class="p">,</span>
      <span class="s1">'Description'</span> <span class="o">=&gt;</span> <span class="sx">%q{
        This module will test FTP logins on a range of machines and
        report successful logins.  If you have loaded a database plugin
        and connected to a database this module will record successful
        logins and hosts so you can track your access.
      }</span><span class="p">,</span>
      <span class="s1">'Author'</span>      <span class="o">=&gt;</span> <span class="s1">'todb'</span><span class="p">,</span>
      <span class="s1">'References'</span>     <span class="o">=&gt;</span>
        <span class="p">[</span>
          <span class="p">[</span> <span class="s1">'CVE'</span><span class="p">,</span> <span class="s1">'1999-0502'</span><span class="p">]</span> <span class="c1"># Weak password</span>
        <span class="p">],</span>
      <span class="s1">'License'</span>     <span class="o">=&gt;</span> <span class="no">MSF_LICENSE</span>
    <span class="p">)</span>

    <span class="n">register_options</span><span class="p">(</span>
      <span class="p">[</span>
        <span class="no">Opt</span><span class="o">::</span><span class="no">RPORT</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span>
        <span class="no">OptBool</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'RECORD_GUEST'</span><span class="p">,</span> <span class="p">[</span> <span class="kp">false</span><span class="p">,</span> <span class="s2">"Record anonymous/guest logins to the database"</span><span class="p">,</span> <span class="kp">false</span><span class="p">])</span>
      <span class="p">],</span> <span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="p">)</span>

    <span class="n">register_advanced_options</span><span class="p">(</span>
      <span class="p">[</span>
        <span class="no">OptBool</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'SINGLE_SESSION'</span><span class="p">,</span> <span class="p">[</span> <span class="kp">false</span><span class="p">,</span> <span class="s1">'Disconnect after every login attempt'</span><span class="p">,</span> <span class="kp">false</span><span class="p">])</span>
      <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">deregister_options</span><span class="p">(</span><span class="s1">'FTPUSER'</span><span class="p">,</span><span class="s1">'FTPPASS'</span><span class="p">)</span> <span class="c1"># Can use these, but should use 'username' and 'password'</span>
    <span class="vi">@accepts_all_logins</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">run_host</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
    <span class="n">print_status</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - Starting FTP login sweep"</span><span class="p">)</span>

    <span class="n">cred_collection</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">CredentialCollection</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
        <span class="ss">blank_passwords: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'BLANK_PASSWORDS'</span><span class="p">],</span>
        <span class="ss">pass_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PASS_FILE'</span><span class="p">],</span>
        <span class="ss">password: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PASSWORD'</span><span class="p">],</span>
        <span class="ss">user_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USER_FILE'</span><span class="p">],</span>
        <span class="ss">userpass_file: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USERPASS_FILE'</span><span class="p">],</span>
        <span class="ss">username: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USERNAME'</span><span class="p">],</span>
        <span class="ss">user_as_pass: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'USER_AS_PASS'</span><span class="p">],</span>
        <span class="ss">prepended_creds: </span><span class="n">anonymous_creds</span>
    <span class="p">)</span>

    <span class="n">scanner</span> <span class="o">=</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">LoginScanner</span><span class="o">::</span><span class="no">FTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
        <span class="ss">host: </span><span class="n">ip</span><span class="p">,</span>
        <span class="ss">port: </span><span class="n">rport</span><span class="p">,</span>
        <span class="ss">proxies: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'PROXIES'</span><span class="p">],</span>
        <span class="ss">cred_details: </span><span class="n">cred_collection</span><span class="p">,</span>
        <span class="ss">stop_on_success: </span><span class="n">datastore</span><span class="p">[</span><span class="s1">'STOP_ON_SUCCESS'</span><span class="p">],</span>
        <span class="ss">connection_timeout: </span><span class="mi">30</span>
    <span class="p">)</span>

    <span class="n">scanner</span><span class="p">.</span><span class="nf">scan!</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
      <span class="n">credential_data</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">to_h</span>
      <span class="n">credential_data</span><span class="p">.</span><span class="nf">merge!</span><span class="p">(</span>
          <span class="ss">module_fullname: </span><span class="nb">self</span><span class="p">.</span><span class="nf">fullname</span><span class="p">,</span>
          <span class="ss">workspace_id: </span><span class="n">myworkspace_id</span>
      <span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">success?</span>
        <span class="n">credential_core</span> <span class="o">=</span> <span class="n">create_credential</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>
        <span class="n">credential_data</span><span class="p">[</span><span class="ss">:core</span><span class="p">]</span> <span class="o">=</span> <span class="n">credential_core</span>
        <span class="n">create_credential_login</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>

        <span class="n">print_good</span> <span class="s2">"</span><span class="si">#{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - LOGIN SUCCESSFUL: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">credential</span><span class="si">}</span><span class="s2">"</span>
      <span class="k">else</span>
        <span class="n">invalidate_login</span><span class="p">(</span><span class="n">credential_data</span><span class="p">)</span>
        <span class="n">print_status</span> <span class="s2">"</span><span class="si">#{</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - LOGIN FAILED: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">credential</span><span class="si">}</span><span class="s2"> (</span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">status</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">result</span><span class="p">.</span><span class="nf">proof</span><span class="si">}</span><span class="s2">)"</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># Always check for anonymous access by pretending to be a browser.</span>
  <span class="k">def</span> <span class="nf">anonymous_creds</span>
    <span class="n">anon_creds</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
    <span class="k">if</span> <span class="n">datastore</span><span class="p">[</span><span class="s1">'RECORD_GUEST'</span><span class="p">]</span>
      <span class="p">[</span><span class="s1">'IEUser@'</span><span class="p">,</span> <span class="s1">'User@'</span><span class="p">,</span> <span class="s1">'mozilla@example.com'</span><span class="p">,</span> <span class="s1">'chrome@example.com'</span> <span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">password</span><span class="o">|</span>
        <span class="n">anon_creds</span> <span class="o">&lt;&lt;</span> <span class="no">Metasploit</span><span class="o">::</span><span class="no">Framework</span><span class="o">::</span><span class="no">Credential</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">public: </span><span class="s1">'anonymous'</span><span class="p">,</span> <span class="ss">private: </span><span class="n">password</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">anon_creds</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">test_ftp_access</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">scanner</span><span class="p">)</span>
    <span class="n">dir</span> <span class="o">=</span> <span class="no">Rex</span><span class="o">::</span><span class="no">Text</span><span class="p">.</span><span class="nf">rand_text_alpha</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">write_check</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">.</span><span class="nf">send_cmd</span><span class="p">([</span><span class="s1">'MKD'</span><span class="p">,</span> <span class="n">dir</span><span class="p">],</span> <span class="kp">true</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">write_check</span> <span class="ow">and</span> <span class="n">write_check</span> <span class="o">=~</span> <span class="sr">/^2/</span>
      <span class="n">scanner</span><span class="p">.</span><span class="nf">send_cmd</span><span class="p">([</span><span class="s1">'RMD'</span><span class="p">,</span><span class="n">dir</span><span class="p">],</span> <span class="kp">true</span><span class="p">)</span>
      <span class="n">print_status</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">rhost</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - User '</span><span class="si">#{</span><span class="n">user</span><span class="si">}</span><span class="s2">' has READ/WRITE access"</span><span class="p">)</span>
      <span class="k">return</span> <span class="s1">'Read/Write'</span>
    <span class="k">else</span>
      <span class="n">print_status</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">rhost</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">rport</span><span class="si">}</span><span class="s2"> - User '</span><span class="si">#{</span><span class="n">user</span><span class="si">}</span><span class="s2">' has READ access"</span><span class="p">)</span>
      <span class="k">return</span> <span class="s1">'Read-only'</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/rapid7/metasploit-framework/tree/master/docs/metasploit-framework.wiki/Creating-Metasploit-Framework-LoginScanners.md" id="edit-this-page">Edit this page on GitHub</a></p></footer></div></div><div class="search-overlay"></div></div><script type="text/javascript" src="/assets/js/toggle_mode.js"></script> <script> var config = { theme: 'default', logLevel: 'fatal', securityLevel: 'strict', startOnLoad: true, arrowMarkerAbsolute: false, er: { diagramPadding: 20, layoutDirection: 'TB', minEntityWidth: 100, minEntityHeight: 75, entityPadding: 15, stroke: 'gray', fill: 'honeydew', fontSize: 12, useMaxWidth: true, }, flowchart:{ diagramPadding: 8, htmlLabels: true, curve: 'basis', }, sequence: { diagramMarginX: 50, diagramMarginY: 10, actorMargin: 50, width: 150, height: 65, boxMargin: 10, boxTextMargin: 5, noteMargin: 10, messageMargin: 35, messageAlign: 'center', mirrorActors: true, bottomMarginAdj: 1, useMaxWidth: true, rightAngles: false, showSequenceNumbers: false, }, gantt: { titleTopMargin: 25, barHeight: 20, barGap: 4, topPadding: 50, leftPadding: 75, fontSize: 11, gridLineStartPadding: 35, fontFamily: '\'Open Sans\', sans-serif', numberSectionStyles: 4, axisFormat: '%Y-%m-%d', topAxis: false, }, }; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
