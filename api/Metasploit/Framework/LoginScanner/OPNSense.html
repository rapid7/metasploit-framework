<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Metasploit::Framework::LoginScanner::OPNSense
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Metasploit::Framework::LoginScanner::OPNSense";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (O)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Framework.html" title="Metasploit::Framework (module)">Framework</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../LoginScanner.html" title="Metasploit::Framework::LoginScanner (module)">LoginScanner</a></span></span>
     &raquo; 
    <span class="title">OPNSense</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Metasploit::Framework::LoginScanner::OPNSense
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="HTTP.html" title="Metasploit::Framework::LoginScanner::HTTP (class)">HTTP</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="HTTP.html" title="Metasploit::Framework::LoginScanner::HTTP (class)">HTTP</a></span></li>
          
            <li class="next">Metasploit::Framework::LoginScanner::OPNSense</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/metasploit/framework/login_scanner/opnsense.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This is the LoginScanner class for dealing with Deciso B.V. OPNSense instances. It is responsible for taking a single target, and a list of credentials and attempting them. It then saves the results.</p>


  </div>
</div>
<div class="tags">
  

</div>


  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="HTTP.html" title="Metasploit::Framework::LoginScanner::HTTP (class)">HTTP</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="HTTP.html#AUTHORIZATION_HEADER-constant" title="Metasploit::Framework::LoginScanner::HTTP::AUTHORIZATION_HEADER (constant)">HTTP::AUTHORIZATION_HEADER</a></span>, <span class='object_link'><a href="HTTP.html#DEFAULT_HTTP_NOT_AUTHED_CODES-constant" title="Metasploit::Framework::LoginScanner::HTTP::DEFAULT_HTTP_NOT_AUTHED_CODES (constant)">HTTP::DEFAULT_HTTP_NOT_AUTHED_CODES</a></span>, <span class='object_link'><a href="HTTP.html#DEFAULT_HTTP_SUCCESS_CODES-constant" title="Metasploit::Framework::LoginScanner::HTTP::DEFAULT_HTTP_SUCCESS_CODES (constant)">HTTP::DEFAULT_HTTP_SUCCESS_CODES</a></span>, <span class='object_link'><a href="HTTP.html#DEFAULT_PORT-constant" title="Metasploit::Framework::LoginScanner::HTTP::DEFAULT_PORT (constant)">HTTP::DEFAULT_PORT</a></span>, <span class='object_link'><a href="HTTP.html#DEFAULT_REALM-constant" title="Metasploit::Framework::LoginScanner::HTTP::DEFAULT_REALM (constant)">HTTP::DEFAULT_REALM</a></span>, <span class='object_link'><a href="HTTP.html#DEFAULT_SSL_PORT-constant" title="Metasploit::Framework::LoginScanner::HTTP::DEFAULT_SSL_PORT (constant)">HTTP::DEFAULT_SSL_PORT</a></span>, <span class='object_link'><a href="HTTP.html#LIKELY_PORTS-constant" title="Metasploit::Framework::LoginScanner::HTTP::LIKELY_PORTS (constant)">HTTP::LIKELY_PORTS</a></span>, <span class='object_link'><a href="HTTP.html#LIKELY_SERVICE_NAMES-constant" title="Metasploit::Framework::LoginScanner::HTTP::LIKELY_SERVICE_NAMES (constant)">HTTP::LIKELY_SERVICE_NAMES</a></span>, <span class='object_link'><a href="HTTP.html#PRIVATE_TYPES-constant" title="Metasploit::Framework::LoginScanner::HTTP::PRIVATE_TYPES (constant)">HTTP::PRIVATE_TYPES</a></span>, <span class='object_link'><a href="HTTP.html#REALM_KEY-constant" title="Metasploit::Framework::LoginScanner::HTTP::REALM_KEY (constant)">HTTP::REALM_KEY</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="HTTP.html" title="Metasploit::Framework::LoginScanner::HTTP (class)">HTTP</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="HTTP.html#digest_auth_iis-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#digest_auth_iis (method)">#digest_auth_iis</a></span>, <span class='object_link'><a href="HTTP.html#evade_header_folding-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_header_folding (method)">#evade_header_folding</a></span>, <span class='object_link'><a href="HTTP.html#evade_method_random_case-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_method_random_case (method)">#evade_method_random_case</a></span>, <span class='object_link'><a href="HTTP.html#evade_method_random_invalid-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_method_random_invalid (method)">#evade_method_random_invalid</a></span>, <span class='object_link'><a href="HTTP.html#evade_method_random_valid-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_method_random_valid (method)">#evade_method_random_valid</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_fake_headers-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_fake_headers (method)">#evade_pad_fake_headers</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_fake_headers_count-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_fake_headers_count (method)">#evade_pad_fake_headers_count</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_get_params-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_get_params (method)">#evade_pad_get_params</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_get_params_count-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_get_params_count (method)">#evade_pad_get_params_count</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_method_uri_count-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_method_uri_count (method)">#evade_pad_method_uri_count</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_method_uri_type-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_method_uri_type (method)">#evade_pad_method_uri_type</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_post_params-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_post_params (method)">#evade_pad_post_params</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_post_params_count-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_post_params_count (method)">#evade_pad_post_params_count</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_uri_version_count-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_uri_version_count (method)">#evade_pad_uri_version_count</a></span>, <span class='object_link'><a href="HTTP.html#evade_pad_uri_version_type-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_pad_uri_version_type (method)">#evade_pad_uri_version_type</a></span>, <span class='object_link'><a href="HTTP.html#evade_shuffle_get_params-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_shuffle_get_params (method)">#evade_shuffle_get_params</a></span>, <span class='object_link'><a href="HTTP.html#evade_shuffle_post_params-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_shuffle_post_params (method)">#evade_shuffle_post_params</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_dir_fake_relative-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_dir_fake_relative (method)">#evade_uri_dir_fake_relative</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_dir_self_reference-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_dir_self_reference (method)">#evade_uri_dir_self_reference</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_encode_mode-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_encode_mode (method)">#evade_uri_encode_mode</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_fake_end-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_fake_end (method)">#evade_uri_fake_end</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_fake_params_start-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_fake_params_start (method)">#evade_uri_fake_params_start</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_full_url-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_full_url (method)">#evade_uri_full_url</a></span>, <span class='object_link'><a href="HTTP.html#evade_uri_use_backslashes-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_uri_use_backslashes (method)">#evade_uri_use_backslashes</a></span>, <span class='object_link'><a href="HTTP.html#evade_version_random_invalid-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_version_random_invalid (method)">#evade_version_random_invalid</a></span>, <span class='object_link'><a href="HTTP.html#evade_version_random_valid-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#evade_version_random_valid (method)">#evade_version_random_valid</a></span>, <span class='object_link'><a href="HTTP.html#http_password-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#http_password (method)">#http_password</a></span>, <span class='object_link'><a href="HTTP.html#http_success_codes-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#http_success_codes (method)">#http_success_codes</a></span>, <span class='object_link'><a href="HTTP.html#http_username-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#http_username (method)">#http_username</a></span>, <span class='object_link'><a href="HTTP.html#keep_connection_alive-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#keep_connection_alive (method)">#keep_connection_alive</a></span>, <span class='object_link'><a href="HTTP.html#kerberos_authenticator_factory-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#kerberos_authenticator_factory (method)">#kerberos_authenticator_factory</a></span>, <span class='object_link'><a href="HTTP.html#method-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#method (method)">#method</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_domain-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_domain (method)">#ntlm_domain</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_send_lm-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_send_lm (method)">#ntlm_send_lm</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_send_ntlm-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_send_ntlm (method)">#ntlm_send_ntlm</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_send_spn-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_send_spn (method)">#ntlm_send_spn</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_use_lm_key-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_use_lm_key (method)">#ntlm_use_lm_key</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_use_ntlmv2-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_use_ntlmv2 (method)">#ntlm_use_ntlmv2</a></span>, <span class='object_link'><a href="HTTP.html#ntlm_use_ntlmv2_session-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#ntlm_use_ntlmv2_session (method)">#ntlm_use_ntlmv2_session</a></span>, <span class='object_link'><a href="HTTP.html#uri-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#uri (method)">#uri</a></span>, <span class='object_link'><a href="HTTP.html#user_agent-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#user_agent (method)">#user_agent</a></span>, <span class='object_link'><a href="HTTP.html#vhost-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#vhost (method)">#vhost</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attempt_login-instance_method" title="#attempt_login (instance method)">#<strong>attempt_login</strong>(credential)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_setup-instance_method" title="#check_setup (instance method)">#<strong>check_setup</strong>  &#x21d2; Boolean, String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the target is OPNSense.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_cookie_value-instance_method" title="#get_cookie_value (instance method)">#<strong>get_cookie_value</strong>(response, wanted_cookie_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieve the wanted cookie value by name from the HTTP response.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#query_magic_value_and_cookies-instance_method" title="#query_magic_value_and_cookies (instance method)">#<strong>query_magic_value_and_cookies</strong>  &#x21d2; Hash&lt;Symbol, Object&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Query the magic value and cookies from the OPNSense login page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#try_login-instance_method" title="#try_login (instance method)">#<strong>try_login</strong>(username, password, magic_value, cookies)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Each individual login needs their own magic name and value.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="HTTP.html" title="Metasploit::Framework::LoginScanner::HTTP (class)">HTTP</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="HTTP.html#authentication_required%3F-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#authentication_required? (method)">#authentication_required?</a></span>, <span class='object_link'><a href="HTTP.html#send_request-instance_method" title="Metasploit::Framework::LoginScanner::HTTP#send_request (method)">#send_request</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="attempt_login-instance_method">
  
    #<strong>attempt_login</strong>(credential)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/opnsense.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attempt_login'>attempt_login</span><span class='lparen'>(</span><span class='id identifier rubyid_credential'>credential</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result_options'>result_options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>credential:</span>   <span class='id identifier rubyid_credential'>credential</span><span class='comma'>,</span>
    <span class='label'>host:</span>         <span class='ivar'>@host</span><span class='comma'>,</span>
    <span class='label'>port:</span>         <span class='ivar'>@port</span><span class='comma'>,</span>
    <span class='label'>protocol:</span>     <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>service_name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>opnsense</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>

  <span class='comment'># Each login needs its own magic name and value
</span>  <span class='id identifier rubyid_magic_value_and_cookies'>magic_value_and_cookies</span> <span class='op'>=</span> <span class='id identifier rubyid_query_magic_value_and_cookies'>query_magic_value_and_cookies</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_magic_value_and_cookies'>magic_value_and_cookies</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='symbol'>:success</span>
    <span class='id identifier rubyid_result_options'>result_options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>status:</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>UNTRIED</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='id identifier rubyid_magic_value_and_cookies'>magic_value_and_cookies</span><span class='lbracket'>[</span><span class='symbol'>:error</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result_options'>result_options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_login_result'>login_result</span> <span class='op'>=</span> <span class='id identifier rubyid_try_login'>try_login</span><span class='lparen'>(</span><span class='id identifier rubyid_credential'>credential</span><span class='period'>.</span><span class='id identifier rubyid_public'>public</span><span class='comma'>,</span> <span class='id identifier rubyid_credential'>credential</span><span class='period'>.</span><span class='id identifier rubyid_private'>private</span><span class='comma'>,</span> <span class='id identifier rubyid_magic_value_and_cookies'>magic_value_and_cookies</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:magic_value</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_magic_value_and_cookies'>magic_value_and_cookies</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:cookies</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_login_result'>login_result</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_result_options'>result_options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>status:</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>UNABLE_TO_CONNECT</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unable to connect to OPNSense</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result_options'>result_options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># 200 is incorrect result
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_login_result'>login_result</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='int'>200</span> <span class='op'>||</span> <span class='id identifier rubyid_login_result'>login_result</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Username or Password incorrect</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_result_options'>result_options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>status:</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>INCORRECT</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Username or Password incorrect</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result_options'>result_options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_login_status'>login_status</span> <span class='op'>=</span> <span class='id identifier rubyid_login_result'>login_result</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='int'>302</span> <span class='op'>?</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>SUCCESSFUL</span> <span class='op'>:</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>INCORRECT</span>
  <span class='id identifier rubyid_result_options'>result_options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>status:</span> <span class='id identifier rubyid_login_status'>login_status</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='id identifier rubyid_login_result'>login_result</span><span class='lbracket'>[</span><span class='symbol'>:result</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result_options'>result_options</span><span class='rparen'>)</span>

<span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>ConnectionError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__e'>_e</span>
  <span class='id identifier rubyid_result_options'>result_options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='label'>status:</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Login</span><span class='op'>::</span><span class='const'>Status</span><span class='op'>::</span><span class='const'>UNABLE_TO_CONNECT</span><span class='comma'>,</span> <span class='label'>proof:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unable to connect to OPNSense</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Result.html" title="Metasploit::Framework::LoginScanner::Result (class)">Result</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Result.html#initialize-instance_method" title="Metasploit::Framework::LoginScanner::Result#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result_options'>result_options</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_setup-instance_method">
  
    #<strong>check_setup</strong>  &#x21d2; <tt>Boolean</tt>, <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if the target is OPNSense. The login module should call this.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>FalseClass if target is OPNSense, otherwise String</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/opnsense.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_setup'>check_setup</span>
  <span class='id identifier rubyid_request_params'>request_params</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>method</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GET</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_normalize_uri'>normalize_uri</span><span class='lparen'>(</span><span class='ivar'>@uri</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_request_params'>request_params</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='int'>200</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='op'>&amp;.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Login | OPNsense</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to locate \&quot;Login | OPNsense\&quot; in body. (Is this really OPNSense?)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_cookie_value-instance_method">
  
    #<strong>get_cookie_value</strong>(response, wanted_cookie_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Retrieve the wanted cookie value by name from the HTTP response.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>response</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Rex/Proto/Http/Response.html" title="Rex::Proto::Http::Response (class)">Rex::Proto::Http::Response</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The response from which to extract cookie values</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wanted_cookie_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The cookie name for which to get the value</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/opnsense.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cookie_value'>get_cookie_value</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid_wanted_cookie_name'>wanted_cookie_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_get_cookies'>get_cookies</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>; </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cookie'>cookie</span><span class='op'>|</span> <span class='id identifier rubyid_cookie'>cookie</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_wanted_cookie_name'>wanted_cookie_name</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>=</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="query_magic_value_and_cookies-instance_method">
  
    #<strong>query_magic_value_and_cookies</strong>  &#x21d2; <tt>Hash&lt;Symbol, Object&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Query the magic value and cookies from the OPNSense login page.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol, Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash of the status and error or result.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/opnsense.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_query_magic_value_and_cookies'>query_magic_value_and_cookies</span>
  <span class='id identifier rubyid_request_params'>request_params</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>method</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GET</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_normalize_uri'>normalize_uri</span><span class='lparen'>(</span><span class='ivar'>@uri</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_request_params'>request_params</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:failure</span><span class='comma'>,</span> <span class='label'>error:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Did not receive response to a GET request</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span> <span class='op'>!=</span> <span class='int'>200</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:failure</span><span class='comma'>,</span> <span class='label'>error:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected return code from GET request - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:failure</span><span class='comma'>,</span> <span class='label'>error:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Received an empty body from GET request</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># The magic name and value are hidden on the login form, so we extract them using get_html_document
</span>  <span class='id identifier rubyid_form_input'>form_input</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_get_html_document'>get_html_document</span><span class='op'>&amp;.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>input</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_form_input'>form_input</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_form_input'>form_input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hidden</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:failure</span><span class='comma'>,</span> <span class='label'>error:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Could not find hidden magic field in the login form.</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_magic_value'>magic_value</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='id identifier rubyid_form_input'>form_input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='id identifier rubyid_form_input'>form_input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_cookies'>cookies</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PHPSESSID=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_cookie_value'>get_cookie_value</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PHPSESSID</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>; cookie_test=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_cookie_value'>get_cookie_value</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cookie_test</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:success</span><span class='comma'>,</span> <span class='label'>result:</span> <span class='lbrace'>{</span> <span class='label'>magic_value:</span> <span class='id identifier rubyid_magic_value'>magic_value</span><span class='comma'>,</span> <span class='label'>cookies:</span> <span class='id identifier rubyid_cookies'>cookies</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="try_login-instance_method">
  
    #<strong>try_login</strong>(username, password, magic_value, cookies)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Each individual login needs their own magic name and value. This magic value comes from the login form received in response to a GET request to the login page. Each login attempt also requires specific cookies to be set, otherwise an error is returned.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>username</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Username</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Password</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>magic_value</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing the magic_value name and value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cookies</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A cookie string</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/metasploit/framework/login_scanner/opnsense.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_try_login'>try_login</span><span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='id identifier rubyid_magic_value'>magic_value</span><span class='comma'>,</span> <span class='id identifier rubyid_cookies'>cookies</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request_params'>request_params</span> <span class='op'>=</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>method</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>POST</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uri</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_normalize_uri'>normalize_uri</span><span class='lparen'>(</span><span class='ivar'>@uri</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cookie</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cookies'>cookies</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vars_post</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
        <span class='id identifier rubyid_magic_value'>magic_value</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_magic_value'>magic_value</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>usernamefld</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_username'>username</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>passwordfld</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>login</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

  <span class='lbrace'>{</span> <span class='label'>status:</span> <span class='symbol'>:success</span><span class='comma'>,</span> <span class='label'>result:</span> <span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_request_params'>request_params</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan 29 04:42:49 2026 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>