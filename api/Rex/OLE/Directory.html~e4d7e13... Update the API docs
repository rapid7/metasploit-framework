<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Rex::OLE::Directory
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Rex/OLE/Directory.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../OLE.html" title="Rex::OLE (module)">OLE</a></span></span>
     &raquo; 
    <span class="title">Directory</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Rex::OLE::Directory
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="DirEntry.html" title="Rex::OLE::DirEntry (class)">DirEntry</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="DirEntry.html" title="Rex::OLE::DirEntry (class)">DirEntry</a></span></li>
          
            <li class="next">Rex::OLE::Directory</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rex/ole/directory.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class serves as the root directory entry in addition to an abstraction
around the concept of a directory as a whole.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#num_entries-instance_method" title="#num_entries (instance method)">- (Object) <strong>num_entries</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>XXX: num_entries is not maintained once a stream/storage is added!.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="DirEntry.html" title="Rex::OLE::DirEntry (class)">DirEntry</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DirEntry.html#_sidChild-instance_method" title="Rex::OLE::DirEntry#_sidChild (method)">#_sidChild</a></span>, <span class='object_link'><a href="DirEntry.html#_sidLeftSib-instance_method" title="Rex::OLE::DirEntry#_sidLeftSib (method)">#_sidLeftSib</a></span>, <span class='object_link'><a href="DirEntry.html#_sidRightSib-instance_method" title="Rex::OLE::DirEntry#_sidRightSib (method)">#_sidRightSib</a></span>, <span class='object_link'><a href="DirEntry.html#sid-instance_method" title="Rex::OLE::DirEntry#sid (method)">#sid</a></span></p>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_entry-instance_method" title="#each_entry (instance method)">- (Object) <strong>each_entry</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flatten_tree-instance_method" title="#flatten_tree (instance method)">- (Object) <strong>flatten_tree</strong>(entries, parent) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>NOTE: this may not be necessary if we were to use each_entry.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_s-instance_method" title="#from_s (instance method)">- (Object) <strong>from_s</strong>(sid, buf) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>low-level functions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Directory) <strong>initialize</strong>(stg) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#link_item-instance_method" title="#link_item (instance method)">- (Object) <strong>link_item</strong>(parent, child) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#populate_children-instance_method" title="#populate_children (instance method)">- (Object) <strong>populate_children</strong>(entries, parent, sid) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>recursively add entries to their proper parents :).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read-instance_method" title="#read (instance method)">- (Object) <strong>read</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_ministream_params-instance_method" title="#set_ministream_params (instance method)">- (Object) <strong>set_ministream_params</strong>(start, size) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write-instance_method" title="#write (instance method)">- (Object) <strong>write</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#yield_entries-instance_method" title="#yield_entries (instance method)">- (Object) <strong>yield_entries</strong>(de, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>woop, recursive each.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="DirEntry.html" title="Rex::OLE::DirEntry (class)">DirEntry</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DirEntry.html#%3C%3C-instance_method" title="Rex::OLE::DirEntry#&lt;&lt; (method)">#<<</a></span>, <span class='object_link'><a href="DirEntry.html#each-instance_method" title="Rex::OLE::DirEntry#each (method)">#each</a></span>, <span class='object_link'><a href="DirEntry.html#find_by_sid-instance_method" title="Rex::OLE::DirEntry#find_by_sid (method)">#find_by_sid</a></span>, <span class='object_link'><a href="DirEntry.html#find_stream_by_name_and_type-instance_method" title="Rex::OLE::DirEntry#find_stream_by_name_and_type (method)">#find_stream_by_name_and_type</a></span>, <span class='object_link'><a href="DirEntry.html#length-instance_method" title="Rex::OLE::DirEntry#length (method)">#length</a></span>, <span class='object_link'><a href="DirEntry.html#name-instance_method" title="Rex::OLE::DirEntry#name (method)">#name</a></span>, <span class='object_link'><a href="DirEntry.html#name%3D-instance_method" title="Rex::OLE::DirEntry#name= (method)">#name=</a></span>, <span class='object_link'><a href="DirEntry.html#pack-instance_method" title="Rex::OLE::DirEntry#pack (method)">#pack</a></span>, <span class='object_link'><a href="DirEntry.html#start_sector-instance_method" title="Rex::OLE::DirEntry#start_sector (method)">#start_sector</a></span>, <span class='object_link'><a href="DirEntry.html#start_sector%3D-instance_method" title="Rex::OLE::DirEntry#start_sector= (method)">#start_sector=</a></span>, <span class='object_link'><a href="DirEntry.html#to_s-instance_method" title="Rex::OLE::DirEntry#to_s (method)">#to_s</a></span>, <span class='object_link'><a href="DirEntry.html#type-instance_method" title="Rex::OLE::DirEntry#type (method)">#type</a></span>, <span class='object_link'><a href="DirEntry.html#type%3D-instance_method" title="Rex::OLE::DirEntry#type= (method)">#type=</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Rex::OLE::Directory (class)">Directory</a></span></tt>) <strong>initialize</strong>(stg) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Directory</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 22</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_stg'>stg</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='ivar'>@num_entries</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="num_entries=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="num_entries-instance_method">
  
    - (<tt>Object</tt>) <strong>num_entries</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>XXX: num_entries is not maintained once a stream/storage is added!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_num_entries'>num_entries</span>
  <span class='ivar'>@num_entries</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="each_entry-instance_method">
  
    - (<tt>Object</tt>) <strong>each_entry</strong>(&amp;block) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_entry'>each_entry</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_yield_entries'>yield_entries</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flatten_tree-instance_method">
  
    - (<tt>Object</tt>) <strong>flatten_tree</strong>(entries, parent) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>NOTE: this may not be necessary if we were to use each_entry</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 169</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flatten_tree'>flatten_tree</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entries'>entries</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_parent'>parent</span>
  <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span>
    <span class='id identifier rubyid_flatten_tree'>flatten_tree</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_el'>el</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="from_s-instance_method">
  
    - (<tt>Object</tt>) <strong>from_s</strong>(sid, buf) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>low-level functions</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_sid'>sid</span><span class='comma'>,</span> <span class='id identifier rubyid_buf'>buf</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@_sidRightSib</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root Entry is invalid! (has right sibling)</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@_sidLeftSib</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root Entry is invalid! (has left sibling)</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="link_item-instance_method">
  
    - (<tt>Object</tt>) <strong>link_item</strong>(parent, child) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_link_item'>link_item</span><span class='lparen'>(</span><span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='id identifier rubyid_child'>child</span><span class='rparen'>)</span>
  <span class='comment'># set sid, advance count
</span>  <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span> <span class='op'>=</span> <span class='ivar'>@num_entries</span>
  <span class='ivar'>@num_entries</span> <span class='op'>+=</span> <span class='int'>1</span>

  <span class='comment'># link item to siblings and/or parent
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid__sidChild'>_sidChild</span> <span class='op'>==</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid__sidChild'>_sidChild</span> <span class='op'>=</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span>
    <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Linking </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as THE child of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as sid </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sib'>sib</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_el'>el</span><span class='period'>.</span><span class='id identifier rubyid__sidLeftSib'>_sidLeftSib</span> <span class='op'>==</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_sib'>sib</span> <span class='op'>=</span> <span class='id identifier rubyid_el'>el</span>
        <span class='id identifier rubyid_el'>el</span><span class='period'>.</span><span class='id identifier rubyid__sidLeftSib'>_sidLeftSib</span> <span class='op'>=</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span>
        <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Linking </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as the LEFT sibling of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sib'>sib</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as sid </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_el'>el</span><span class='period'>.</span><span class='id identifier rubyid__sidRightSib'>_sidRightSib</span> <span class='op'>==</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_sib'>sib</span> <span class='op'>=</span> <span class='id identifier rubyid_el'>el</span>
        <span class='id identifier rubyid_el'>el</span><span class='period'>.</span><span class='id identifier rubyid__sidRightSib'>_sidRightSib</span> <span class='op'>=</span> <span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span>
        <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Linking </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as the RIGHT sibling of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sib'>sib</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> as sid </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_sid'>sid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_sib'>sib</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unable to find a sibling to link to in the directory</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_parent'>parent</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_child'>child</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="populate_children-instance_method">
  
    - (<tt>Object</tt>) <strong>populate_children</strong>(entries, parent, sid) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>recursively add entries to their proper parents :)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 153</span>

<span class='kw'>def</span> <span class='id identifier rubyid_populate_children'>populate_children</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='id identifier rubyid_sid'>sid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_node'>node</span> <span class='op'>=</span> <span class='id identifier rubyid_entries'>entries</span><span class='lbracket'>[</span><span class='id identifier rubyid_sid'>sid</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>populate_children(entries, \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sid'>sid</span><span class='embexpr_end'>}</span><span class='tstring_content'>) - node: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parent'>parent</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_node'>node</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>STGTY_STORAGE</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidChild'>_sidChild</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_populate_children'>populate_children</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidChild'>_sidChild</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidLeftSib'>_sidLeftSib</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_populate_children'>populate_children</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidLeftSib'>_sidLeftSib</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidRightSib'>_sidRightSib</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_populate_children'>populate_children</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid__sidRightSib'>_sidRightSib</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read-instance_method">
  
    - (<tt>Object</tt>) <strong>read</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read'>read</span>
  <span class='ivar'>@children</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_entries'>entries</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_root_node'>root_node</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_sect'>sect</span> <span class='op'>=</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid__sectDirStart'>_sectDirStart</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_sect'>sect</span> <span class='op'>!=</span> <span class='const'>SECT_END</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_sect'>sect</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Sector chain loop detected (0x%08x)</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_sect'>sect</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_visited'>visited</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sect'>sect</span>

    <span class='id identifier rubyid_sbuf'>sbuf</span> <span class='op'>=</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_read_sector'>read_sector</span><span class='lparen'>(</span><span class='id identifier rubyid_sect'>sect</span><span class='comma'>,</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_sector_size'>sector_size</span><span class='rparen'>)</span>
    <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_sbuf'>sbuf</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='const'>DIRENTRY_SZ</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_debuf'>debuf</span> <span class='op'>=</span> <span class='id identifier rubyid_sbuf'>sbuf</span><span class='period'>.</span><span class='id identifier rubyid_slice!'>slice!</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='const'>DIRENTRY_SZ</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_get8'>get8</span><span class='lparen'>(</span><span class='id identifier rubyid_debuf'>debuf</span><span class='comma'>,</span> <span class='int'>0x42</span><span class='rparen'>)</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
      <span class='kw'>when</span> <span class='const'>STGTY_ROOT</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root Entry found, but not first encountered!</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_root_node'>root_node</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Multiple root directory sectors detected (0x%08x)</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_sect'>sect</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_de'>de</span> <span class='op'>=</span> <span class='kw'>self</span>
        <span class='id identifier rubyid_root_node'>root_node</span> <span class='op'>=</span> <span class='id identifier rubyid_de'>de</span>

      <span class='kw'>when</span> <span class='const'>STGTY_STORAGE</span>
        <span class='id identifier rubyid_de'>de</span> <span class='op'>=</span> <span class='const'>SubStorage</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='ivar'>@stg</span>

      <span class='kw'>when</span> <span class='const'>STGTY_STREAM</span>
        <span class='id identifier rubyid_de'>de</span> <span class='op'>=</span> <span class='const'>Stream</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='ivar'>@stg</span>

      <span class='kw'>when</span> <span class='const'>STGTY_INVALID</span>
        <span class='comment'># skip invalid entries
</span>        <span class='kw'>next</span>

      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Unsupported directory entry type (0x%02x)</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_type'>type</span>
      <span class='kw'>end</span>

      <span class='comment'># read content
</span>      <span class='id identifier rubyid_de'>de</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_debuf'>debuf</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_entries'>entries</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_de'>de</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_sect'>sect</span> <span class='op'>=</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_next_sector'>next_sector</span><span class='lparen'>(</span><span class='id identifier rubyid_sect'>sect</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@num_entries</span> <span class='op'>=</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>

  <span class='comment'># sort out the tree structure, starting with the root
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@_sidChild</span> <span class='op'>!=</span> <span class='const'>DIR_NOSTREAM</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_populate_children'>populate_children</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='id identifier rubyid_root_node'>root_node</span><span class='comma'>,</span> <span class='ivar'>@_sidChild</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_ministream_params-instance_method">
  
    - (<tt>Object</tt>) <strong>set_ministream_params</strong>(start, size) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 41</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_ministream_params'>set_ministream_params</span><span class='lparen'>(</span><span class='id identifier rubyid_start'>start</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='ivar'>@_sectStart</span> <span class='op'>=</span> <span class='id identifier rubyid_start'>start</span>
  <span class='ivar'>@_ulSize</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write-instance_method">
  
    - (<tt>Object</tt>) <strong>write</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write'>write</span>
  <span class='comment'># flatten the directory again
</span>  <span class='id identifier rubyid_entries'>entries</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_flatten_tree'>flatten_tree</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>flattened tree has </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> entries...</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>

  <span class='comment'># count directory sectors
</span>  <span class='id identifier rubyid_ds_count'>ds_count</span> <span class='op'>=</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='int'>4</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>%</span> <span class='int'>4</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='comment'># one more sector to hold the rest
</span>    <span class='id identifier rubyid_ds_count'>ds_count</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='comment'># put the root entry first
</span>  <span class='id identifier rubyid_sbuf'>sbuf</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span>

  <span class='comment'># add the rest
</span>  <span class='id identifier rubyid_prev_sect'>prev_sect</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_dir_start'>dir_start</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_de'>de</span><span class='op'>|</span>
    <span class='comment'># we already got the root entry, no more!
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_de'>de</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'>STGTY_ROOT</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dir'>dir</span> <span class='op'>=</span> <span class='id identifier rubyid_de'>de</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span>
    <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>writing dir entry </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_de'>de</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rex</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sbuf'>sbuf</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dir'>dir</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_sbuf'>sbuf</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_sector_size'>sector_size</span><span class='rparen'>)</span>
      <span class='comment'># we have a full sector, add it!
</span>      <span class='id identifier rubyid_sect'>sect</span> <span class='op'>=</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_write_sector'>write_sector</span><span class='lparen'>(</span><span class='id identifier rubyid_sbuf'>sbuf</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_prev_sect'>prev_sect</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_prev_sect'>prev_sect</span> <span class='op'>=</span> <span class='id identifier rubyid_sect'>sect</span>
      <span class='id identifier rubyid_dir_start'>dir_start</span> <span class='op'>||=</span> <span class='id identifier rubyid_sect'>sect</span>
      <span class='comment'># reset..
</span>      <span class='id identifier rubyid_sbuf'>sbuf</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='comment'># still a partial sector left?
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_sbuf'>sbuf</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='comment'># add it! (NOTE: it will get padded with nul bytes if its not sector sized)
</span>    <span class='id identifier rubyid_sect'>sect</span> <span class='op'>=</span> <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_write_sector'>write_sector</span><span class='lparen'>(</span><span class='id identifier rubyid_sbuf'>sbuf</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_prev_sect'>prev_sect</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_prev_sect'>prev_sect</span> <span class='op'>=</span> <span class='id identifier rubyid_sect'>sect</span>
    <span class='id identifier rubyid_dir_start'>dir_start</span> <span class='op'>||=</span> <span class='id identifier rubyid_sect'>sect</span>
  <span class='kw'>end</span>

  <span class='ivar'>@stg</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid__sectDirStart'>_sectDirStart</span> <span class='op'>=</span> <span class='id identifier rubyid_dir_start'>dir_start</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="yield_entries-instance_method">
  
    - (<tt>Object</tt>) <strong>yield_entries</strong>(de, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>woop, recursive each</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/ole/directory.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_yield_entries'>yield_entries</span><span class='lparen'>(</span><span class='id identifier rubyid_de'>de</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_de'>de</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_de'>de</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span>
    <span class='id identifier rubyid_yield_entries'>yield_entries</span><span class='lparen'>(</span><span class='id identifier rubyid_el'>el</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Nov  7 14:38:01 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.4).
</div>

  </body>
</html>