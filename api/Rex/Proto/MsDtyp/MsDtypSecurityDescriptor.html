<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Proto::MsDtyp::MsDtypSecurityDescriptor
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Proto::MsDtyp::MsDtypSecurityDescriptor";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../MsDtyp.html" title="Rex::Proto::MsDtyp (module)">MsDtyp</a></span></span>
     &raquo; 
    <span class="title">MsDtypSecurityDescriptor</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Proto::MsDtyp::MsDtypSecurityDescriptor
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">BinData::Record</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">BinData::Record</li>
          
            <li class="next">Rex::Proto::MsDtyp::MsDtypSecurityDescriptor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/ms_dtyp.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>[2.4.6 SECURITY_DESCRIPTOR](<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/7d4dac05-9cef-4563-a058-f108abecce1d">learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/7d4dac05-9cef-4563-a058-f108abecce1d</a>)</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dacl-instance_method" title="#dacl (instance method)">#<strong>dacl</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dacl.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#group_sid-instance_method" title="#group_sid (instance method)">#<strong>group_sid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute group_sid.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#owner_sid-instance_method" title="#owner_sid (instance method)">#<strong>owner_sid</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute owner_sid.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sacl-instance_method" title="#sacl (instance method)">#<strong>sacl</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute sacl.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_sddl_text-class_method" title="from_sddl_text (class method)">.<strong>from_sddl_text</strong>(sddl_text, domain_sid:)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dacl_to_sddl_text-instance_method" title="#dacl_to_sddl_text (instance method)">#<strong>dacl_to_sddl_text</strong>(domain_sid: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_read-instance_method" title="#do_read (instance method)">#<strong>do_read</strong>(val)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize_instance-instance_method" title="#initialize_instance (instance method)">#<strong>initialize_instance</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize_shared_instance-instance_method" title="#initialize_shared_instance (instance method)">#<strong>initialize_shared_instance</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sacl_to_sddl_text-instance_method" title="#sacl_to_sddl_text (instance method)">#<strong>sacl_to_sddl_text</strong>(domain_sid: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#snapshot-instance_method" title="#snapshot (instance method)">#<strong>snapshot</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_sddl_text-instance_method" title="#to_sddl_text (instance method)">#<strong>to_sddl_text</strong>(domain_sid: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="dacl=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="dacl-instance_method">
  
    #<strong>dacl</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dacl.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


878
879
880</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 878</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dacl'>dacl</span>
  <span class='ivar'>@dacl</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="group_sid=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="group_sid-instance_method">
  
    #<strong>group_sid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute group_sid.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


879
880
881</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 879</span>

<span class='kw'>def</span> <span class='id identifier rubyid_group_sid'>group_sid</span>
  <span class='ivar'>@group_sid</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="owner_sid=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="owner_sid-instance_method">
  
    #<strong>owner_sid</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute owner_sid.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


879
880
881</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 879</span>

<span class='kw'>def</span> <span class='id identifier rubyid_owner_sid'>owner_sid</span>
  <span class='ivar'>@owner_sid</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sacl=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sacl-instance_method">
  
    #<strong>sacl</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute sacl.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


878
879
880</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 878</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sacl'>sacl</span>
  <span class='ivar'>@sacl</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="from_sddl_text-class_method">
  
    .<strong>from_sddl_text</strong>(sddl_text, domain_sid:)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 726</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_from_sddl_text'>from_sddl_text</span><span class='lparen'>(</span><span class='id identifier rubyid_sddl_text'>sddl_text</span><span class='comma'>,</span> <span class='label'>domain_sid:</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sacl_set'>sacl_set</span> <span class='op'>=</span> <span class='id identifier rubyid_dacl_set'>dacl_set</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_sd'>sd</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>=</span> <span class='id identifier rubyid_sddl_text'>sddl_text</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'># start by removing all whitespace
</span>  <span class='id identifier rubyid_sddl_text'>sddl_text</span><span class='period'>.</span><span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>([OGDS]:(?:.(?!:))*)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='comma'>,</span><span class='op'>|</span>
    <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_part'>part</span><span class='period'>.</span><span class='id identifier rubyid_partition'>partition</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_component'>component</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>O</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_owner_sid'>owner_sid</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>extra owner SID</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_owner_sid'>owner_sid</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypSid.html" title="Rex::Proto::MsDtyp::MsDtypSid (class)">MsDtypSid</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_sddl_text'><span class='object_link'><a href="MsDtypSid.html#from_sddl_text-class_method" title="Rex::Proto::MsDtyp::MsDtypSid.from_sddl_text (method)">from_sddl_text</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>G</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_group_sid'>group_sid</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>extra group SID</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_group_sid'>group_sid</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypSid.html" title="Rex::Proto::MsDtyp::MsDtypSid (class)">MsDtypSid</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_sddl_text'><span class='object_link'><a href="MsDtypSid.html#from_sddl_text-class_method" title="Rex::Proto::MsDtyp::MsDtypSid.from_sddl_text (method)">from_sddl_text</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>D</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>extra DACL</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_dacl_set'>dacl_set</span>

      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_upcase!'>upcase!</span>
      <span class='id identifier rubyid_dacl_set'>dacl_set</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_access_control'>access_control</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(P|AR|AI|NO_ACCESS_CONTROL)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_flag'>flag</span><span class='op'>|</span>
        <span class='kw'>case</span> <span class='id identifier rubyid_flag'>flag</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AI</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_di'>di</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AR</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_dc'>dc</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_pd'>pd</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NO_ACCESS_CONTROL</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_access_control'>access_control</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown DACL flag: </span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_flag'>flag</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_access_control'>access_control</span>

      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_dacl'>dacl</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypAcl.html" title="Rex::Proto::MsDtyp::MsDtypAcl (class)">MsDtypAcl</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_dacl'>dacl</span><span class='period'>.</span><span class='id identifier rubyid_aces'>aces</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_aces_from_sddl_text'>aces_from_sddl_text</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_delete_prefix'>delete_prefix</span><span class='lparen'>(</span><span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>extra SACL</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_sacl_set'>sacl_set</span>

      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_upcase!'>upcase!</span>
      <span class='id identifier rubyid_sacl_set'>sacl_set</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_access_control'>access_control</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(P|AR|AI|NO_ACCESS_CONTROL)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_flag'>flag</span><span class='op'>|</span>
        <span class='kw'>case</span> <span class='id identifier rubyid_flag'>flag</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AI</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_si'>si</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AR</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_sc'>sc</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_ps'>ps</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NO_ACCESS_CONTROL</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_access_control'>access_control</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown SACL flag: </span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_flag'>flag</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_access_control'>access_control</span>

      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_sacl'>sacl</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypAcl.html" title="Rex::Proto::MsDtyp::MsDtypAcl (class)">MsDtypAcl</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='id identifier rubyid_sd'>sd</span><span class='period'>.</span><span class='id identifier rubyid_sacl'>sacl</span><span class='period'>.</span><span class='id identifier rubyid_aces'>aces</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_aces_from_sddl_text'>aces_from_sddl_text</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_delete_prefix'>delete_prefix</span><span class='lparen'>(</span><span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="SDDLParseError.html" title="Rex::Proto::MsDtyp::SDDLParseError (class)">SDDLParseError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown directive: </span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_part'>part</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sd'>sd</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="dacl_to_sddl_text-instance_method">
  
    #<strong>dacl_to_sddl_text</strong>(domain_sid: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


696
697
698
699
700
701
702
703
704
705
706
707
708
709</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 696</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dacl_to_sddl_text'>dacl_to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_dacl?'>dacl?</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NO_ACCESS_CONTROL</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_pd'>pd</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AR</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_dc'>dc</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AI</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_di'>di</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dacl'>dacl</span><span class='period'>.</span><span class='id identifier rubyid_aces'>aces</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ace'>ace</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ace'>ace</span><span class='period'>.</span><span class='id identifier rubyid_to_sddl_text'>to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'><span class='object_link'><a href="../../../top-level-namespace.html#join-instance_method" title="#join (method)">join</a></span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sddl_text'>sddl_text</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="do_read-instance_method">
  
    #<strong>do_read</strong>(val)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 842</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_read'>do_read</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>super</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_offset_owner'>offset_owner</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='ivar'>@owner_sid</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypSid.html" title="Rex::Proto::MsDtyp::MsDtypSid (class)">MsDtypSid</a></span></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset_owner'>offset_owner</span> <span class='op'>-</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_rel_offset'>rel_offset</span><span class='op'>..</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_offset_group'>offset_group</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='ivar'>@group_sid</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypSid.html" title="Rex::Proto::MsDtyp::MsDtypSid (class)">MsDtypSid</a></span></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset_group'>offset_group</span> <span class='op'>-</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_rel_offset'>rel_offset</span><span class='op'>..</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_offset_sacl'>offset_sacl</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='ivar'>@sacl</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypAcl.html" title="Rex::Proto::MsDtyp::MsDtypAcl (class)">MsDtypAcl</a></span></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset_sacl'>offset_sacl</span> <span class='op'>-</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_rel_offset'>rel_offset</span><span class='op'>..</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_offset_dacl'>offset_dacl</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='ivar'>@dacl</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="MsDtypAcl.html" title="Rex::Proto::MsDtyp::MsDtypAcl (class)">MsDtypAcl</a></span></span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset_dacl'>offset_dacl</span> <span class='op'>-</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_rel_offset'>rel_offset</span><span class='op'>..</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize_instance-instance_method">
  
    #<strong>initialize_instance</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


833
834
835
836
837
838
839
840</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 833</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_instance'>initialize_instance</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>super</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_owner_sid'>owner_sid</span> <span class='op'>=</span> <span class='id identifier rubyid_get_parameter'>get_parameter</span><span class='lparen'>(</span><span class='symbol'>:owner_sid</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group_sid'>group_sid</span> <span class='op'>=</span> <span class='id identifier rubyid_get_parameter'>get_parameter</span><span class='lparen'>(</span><span class='symbol'>:group_sid</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sacl'>sacl</span> <span class='op'>=</span> <span class='id identifier rubyid_get_parameter'>get_parameter</span><span class='lparen'>(</span><span class='symbol'>:sacl</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dacl'>dacl</span> <span class='op'>=</span> <span class='id identifier rubyid_get_parameter'>get_parameter</span><span class='lparen'>(</span><span class='symbol'>:dacl</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize_shared_instance-instance_method">
  
    #<strong>initialize_shared_instance</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


824
825
826
827
828
829
830
831</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 824</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_shared_instance'>initialize_shared_instance</span>
  <span class='comment'># define accessor methods for the custom fields to expose the same API as BinData
</span>  <span class='id identifier rubyid_define_field_accessors_for2'>define_field_accessors_for2</span><span class='lparen'>(</span><span class='symbol'>:owner_sid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_define_field_accessors_for2'>define_field_accessors_for2</span><span class='lparen'>(</span><span class='symbol'>:group_sid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_define_field_accessors_for2'>define_field_accessors_for2</span><span class='lparen'>(</span><span class='symbol'>:sacl</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_define_field_accessors_for2'>define_field_accessors_for2</span><span class='lparen'>(</span><span class='symbol'>:dacl</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sacl_to_sddl_text-instance_method">
  
    #<strong>sacl_to_sddl_text</strong>(domain_sid: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


711
712
713
714
715
716
717
718
719
720
721
722
723
724</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 711</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sacl_to_sddl_text'>sacl_to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_sacl?'>sacl?</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NO_ACCESS_CONTROL</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>P</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_ps'>ps</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AR</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_sc'>sc</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AI</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_control'>control</span><span class='period'>.</span><span class='id identifier rubyid_si'>si</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_sacl'>sacl</span><span class='period'>.</span><span class='id identifier rubyid_aces'>aces</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ace'>ace</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ace'>ace</span><span class='period'>.</span><span class='id identifier rubyid_to_sddl_text'>to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'><span class='object_link'><a href="../../../top-level-namespace.html#join-instance_method" title="#join (method)">join</a></span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sddl_text'>sddl_text</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="snapshot-instance_method">
  
    #<strong>snapshot</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


859
860
861
862
863
864
865
866</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 859</span>

<span class='kw'>def</span> <span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_snap'>snap</span> <span class='op'>=</span> <span class='kw'>super</span>
  <span class='id identifier rubyid_snap'>snap</span><span class='lbracket'>[</span><span class='symbol'>:owner_sid</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_owner_sid'>owner_sid</span><span class='op'>&amp;.</span><span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_snap'>snap</span><span class='lbracket'>[</span><span class='symbol'>:group_sid</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_group_sid'>group_sid</span><span class='op'>&amp;.</span><span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_snap'>snap</span><span class='lbracket'>[</span><span class='symbol'>:sacl</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_sacl'>sacl</span><span class='op'>&amp;.</span><span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_snap'>snap</span><span class='lbracket'>[</span><span class='symbol'>:dacl</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_dacl'>dacl</span><span class='op'>&amp;.</span><span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_snap'>snap</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_sddl_text-instance_method">
  
    #<strong>to_sddl_text</strong>(domain_sid: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


686
687
688
689
690
691
692
693
694</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/ms_dtyp.rb', line 686</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_sddl_text'>to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>O:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_owner_sid'>owner_sid</span><span class='period'>.</span><span class='id identifier rubyid_to_sddl_text'>to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_owner_sid?'>owner_sid?</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>G:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_group_sid'>group_sid</span><span class='period'>.</span><span class='id identifier rubyid_to_sddl_text'>to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_group_sid?'>group_sid?</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>D:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dacl_to_sddl_text'>dacl_to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_dacl?'>dacl?</span>
  <span class='id identifier rubyid_sddl_text'>sddl_text</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sacl_to_sddl_text'>sacl_to_sddl_text</span><span class='lparen'>(</span><span class='label'>domain_sid:</span> <span class='id identifier rubyid_domain_sid'>domain_sid</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_sacl?'>sacl?</span>

  <span class='id identifier rubyid_sddl_text'>sddl_text</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Oct 31 12:10:19 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>