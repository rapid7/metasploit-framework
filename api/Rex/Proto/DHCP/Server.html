<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Proto::DHCP::Server
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Proto::DHCP::Server";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DHCP.html" title="Rex::Proto::DHCP (module)">DHCP</a></span></span>
     &raquo; 
    <span class="title">Server</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Proto::DHCP::Server
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Proto::DHCP::Server</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Socket</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/dhcp/server.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>DHCP Server class not completely configurable - written specifically for a PXE server</p>
<ul><li>
<p>scriptjunkie</p>
</li></ul>

<p>extended to support testing/exploiting CVE-2011-0997</p>
<ul><li>
<p>apconole@yahoo.com</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#broadcasta-instance_method" title="#broadcasta (instance method)">#<strong>broadcasta</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute broadcasta.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute context.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_ip-instance_method" title="#current_ip (instance method)">#<strong>current_ip</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute current_ip.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dnsserv-instance_method" title="#dnsserv (instance method)">#<strong>dnsserv</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dnsserv.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#domain_name-instance_method" title="#domain_name (instance method)">#<strong>domain_name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute domain_name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#end_ip-instance_method" title="#end_ip (instance method)">#<strong>end_ip</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute end_ip.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#give_hostname-instance_method" title="#give_hostname (instance method)">#<strong>give_hostname</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute give_hostname.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ipstring-instance_method" title="#ipstring (instance method)">#<strong>ipstring</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute ipstring.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#leasetime-instance_method" title="#leasetime (instance method)">#<strong>leasetime</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute leasetime.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#listen_host-instance_method" title="#listen_host (instance method)">#<strong>listen_host</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute listen_host.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#listen_port-instance_method" title="#listen_port (instance method)">#<strong>listen_port</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute listen_port.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#myfilename-instance_method" title="#myfilename (instance method)">#<strong>myfilename</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute myfilename.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#netmaskn-instance_method" title="#netmaskn (instance method)">#<strong>netmaskn</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute netmaskn.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy_auto_discovery-instance_method" title="#proxy_auto_discovery (instance method)">#<strong>proxy_auto_discovery</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute proxy_auto_discovery.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pxealtconfigfile-instance_method" title="#pxealtconfigfile (instance method)">#<strong>pxealtconfigfile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute pxealtconfigfile.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pxeconfigfile-instance_method" title="#pxeconfigfile (instance method)">#<strong>pxeconfigfile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute pxeconfigfile.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pxepathprefix-instance_method" title="#pxepathprefix (instance method)">#<strong>pxepathprefix</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute pxepathprefix.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pxereboottime-instance_method" title="#pxereboottime (instance method)">#<strong>pxereboottime</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute pxereboottime.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#relayip-instance_method" title="#relayip (instance method)">#<strong>relayip</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute relayip.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reporter-instance_method" title="#reporter (instance method)">#<strong>reporter</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute reporter.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#router-instance_method" title="#router (instance method)">#<strong>router</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute router.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#served-instance_method" title="#served (instance method)">#<strong>served</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute served.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#served_hostname-instance_method" title="#served_hostname (instance method)">#<strong>served_hostname</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute served_hostname.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#served_over-instance_method" title="#served_over (instance method)">#<strong>served_over</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute served_over.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#serveOnce-instance_method" title="#serveOnce (instance method)">#<strong>serveOnce</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute serveOnce.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#serveOnlyPXE-instance_method" title="#serveOnlyPXE (instance method)">#<strong>serveOnlyPXE</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute serveOnlyPXE.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#servePXE-instance_method" title="#servePXE (instance method)">#<strong>servePXE</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute servePXE.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sock-instance_method" title="#sock (instance method)">#<strong>sock</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute sock.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_ip-instance_method" title="#start_ip (instance method)">#<strong>start_ip</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute start_ip.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#thread-instance_method" title="#thread (instance method)">#<strong>thread</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute thread.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#url-instance_method" title="#url (instance method)">#<strong>url</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute url.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#dhcpoption-instance_method" title="#dhcpoption (instance method)">#<strong>dhcpoption</strong>(type, val = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#dispatch_request-instance_method" title="#dispatch_request (instance method)">#<strong>dispatch_request</strong>(from, buf)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Dispatch a packet that we received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(hash, context = {})  &#x21d2; Server </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Server.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#monitor_socket-instance_method" title="#monitor_socket (instance method)">#<strong>monitor_socket</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>See if there is anything to do..</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#report-instance_method" title="#report (instance method)">#<strong>report</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_packet-instance_method" title="#send_packet (instance method)">#<strong>send_packet</strong>(ip, pkt)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Send a single packet to the specified host.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_option-instance_method" title="#set_option (instance method)">#<strong>set_option</strong>(opts)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set an option.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start the DHCP server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">#<strong>stop</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stop the DHCP server.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(hash, context = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Proto::DHCP::Server (class)">Server</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Server.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_listen_host'>listen_host</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># clients don&#39;t already have addresses. Needs to be 0.0.0.0
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_listen_port'>listen_port</span> <span class='op'>=</span> <span class='int'>67</span> <span class='comment'># mandatory (bootps)
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myfilename'>myfilename</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILENAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myfilename'>myfilename</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='lparen'>(</span><span class='int'>128</span> <span class='op'>-</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myfilename'>myfilename</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SRVHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_source_address'>source_address</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ipstart'>ipstart</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DHCPIPSTART</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ipstart'>ipstart</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_start_ip'>start_ip</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_atoi'>addr_atoi</span><span class='lparen'>(</span><span class='id identifier rubyid_ipstart'>ipstart</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'># Use the first 3 octets of the server&#39;s IP to construct the
</span>    <span class='comment'># default range of x.x.x.32-254
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_start_ip'>start_ip</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>2</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\x20</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span> <span class='op'>=</span> <span class='id identifier rubyid_start_ip'>start_ip</span>

  <span class='id identifier rubyid_ipend'>ipend</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DHCPIPEND</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ipend'>ipend</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_end_ip'>end_ip</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_atoi'>addr_atoi</span><span class='lparen'>(</span><span class='id identifier rubyid_ipend'>ipend</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'># Use the first 3 octets of the server&#39;s IP to construct the
</span>    <span class='comment'># default range of x.x.x.32-254
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_end_ip'>end_ip</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>2</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\xfe</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>

  <span class='comment'># netmask
</span>  <span class='id identifier rubyid_netmask'>netmask</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NETMASK</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>255.255.255.0</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_netmaskn'>netmaskn</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_netmask'>netmask</span><span class='rparen'>)</span>

  <span class='comment'># router
</span>  <span class='id identifier rubyid_router'>router</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ROUTER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_source'>source</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_router'>router</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_router'>router</span><span class='rparen'>)</span>

  <span class='comment'># dns
</span>  <span class='id identifier rubyid_dnsserv'>dnsserv</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DNSSERVER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_source'>source</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dnsserv'>dnsserv</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_dnsserv'>dnsserv</span><span class='rparen'>)</span>

  <span class='comment'># broadcast
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BROADCAST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_broadcasta'>broadcasta</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_aton'>addr_aton</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BROADCAST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_broadcasta'>broadcasta</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_itoa'>addr_itoa</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_start_ip'>start_ip</span> <span class='op'>|</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_ntoi'>addr_ntoi</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_netmaskn'>netmaskn</span><span class='rparen'>)</span> <span class='op'>^</span> <span class='int'>0xffffffff</span><span class='rparen'>)</span> <span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serveOnce'>serveOnce</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SERVEONCE</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_servePXE'>servePXE</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PXE</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>or</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILENAME</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>or</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PXEONLY</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serveOnlyPXE'>serveOnlyPXE</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PXEONLY</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Always assume we don&#39;t give out hostnames ...
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_give_hostname'>give_hostname</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOSTNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_give_hostname'>give_hostname</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_hostname'>served_hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOSTNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='lparen'>(</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOSTSTART</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HOSTSTART</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_leasetime'>leasetime</span> <span class='op'>=</span> <span class='int'>600</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_relayip'>relayip</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00\x00\x00\x00</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># relay ip - not currently supported
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxeconfigfile'>pxeconfigfile</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update2</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxealtconfigfile'>pxealtconfigfile</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update0</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxepathprefix'>pxepathprefix</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxereboottime'>pxereboottime</span> <span class='op'>=</span> <span class='int'>2000</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_domain_name'>domain_name</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DOMAINNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>nil</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>URL</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>URL</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="broadcasta=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="broadcasta-instance_method">
  
    #<strong>broadcasta</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute broadcasta.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_broadcasta'>broadcasta</span>
  <span class='ivar'>@broadcasta</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="context=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="context-instance_method">
  
    #<strong>context</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute context.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='ivar'>@context</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="current_ip=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="current_ip-instance_method">
  
    #<strong>current_ip</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute current_ip.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_ip'>current_ip</span>
  <span class='ivar'>@current_ip</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="dnsserv=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="dnsserv-instance_method">
  
    #<strong>dnsserv</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dnsserv.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dnsserv'>dnsserv</span>
  <span class='ivar'>@dnsserv</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="domain_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="domain_name-instance_method">
  
    #<strong>domain_name</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute domain_name.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 156</span>

<span class='kw'>def</span> <span class='id identifier rubyid_domain_name'>domain_name</span>
  <span class='ivar'>@domain_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="end_ip=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="end_ip-instance_method">
  
    #<strong>end_ip</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute end_ip.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_end_ip'>end_ip</span>
  <span class='ivar'>@end_ip</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="give_hostname=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="give_hostname-instance_method">
  
    #<strong>give_hostname</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute give_hostname.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_give_hostname'>give_hostname</span>
  <span class='ivar'>@give_hostname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="ipstring=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="ipstring-instance_method">
  
    #<strong>ipstring</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute ipstring.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ipstring'>ipstring</span>
  <span class='ivar'>@ipstring</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="leasetime=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="leasetime-instance_method">
  
    #<strong>leasetime</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute leasetime.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_leasetime'>leasetime</span>
  <span class='ivar'>@leasetime</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="listen_host=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="listen_host-instance_method">
  
    #<strong>listen_host</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute listen_host.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_listen_host'>listen_host</span>
  <span class='ivar'>@listen_host</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="listen_port=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="listen_port-instance_method">
  
    #<strong>listen_port</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute listen_port.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_listen_port'>listen_port</span>
  <span class='ivar'>@listen_port</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="myfilename=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="myfilename-instance_method">
  
    #<strong>myfilename</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute myfilename.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_myfilename'>myfilename</span>
  <span class='ivar'>@myfilename</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="netmaskn=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="netmaskn-instance_method">
  
    #<strong>netmaskn</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute netmaskn.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_netmaskn'>netmaskn</span>
  <span class='ivar'>@netmaskn</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="proxy_auto_discovery=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="proxy_auto_discovery-instance_method">
  
    #<strong>proxy_auto_discovery</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute proxy_auto_discovery.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 156</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_auto_discovery'>proxy_auto_discovery</span>
  <span class='ivar'>@proxy_auto_discovery</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="pxealtconfigfile=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="pxealtconfigfile-instance_method">
  
    #<strong>pxealtconfigfile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute pxealtconfigfile.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pxealtconfigfile'>pxealtconfigfile</span>
  <span class='ivar'>@pxealtconfigfile</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="pxeconfigfile=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="pxeconfigfile-instance_method">
  
    #<strong>pxeconfigfile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute pxeconfigfile.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pxeconfigfile'>pxeconfigfile</span>
  <span class='ivar'>@pxeconfigfile</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="pxepathprefix=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="pxepathprefix-instance_method">
  
    #<strong>pxepathprefix</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute pxepathprefix.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pxepathprefix'>pxepathprefix</span>
  <span class='ivar'>@pxepathprefix</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="pxereboottime=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="pxereboottime-instance_method">
  
    #<strong>pxereboottime</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute pxereboottime.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pxereboottime'>pxereboottime</span>
  <span class='ivar'>@pxereboottime</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="relayip=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="relayip-instance_method">
  
    #<strong>relayip</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute relayip.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_relayip'>relayip</span>
  <span class='ivar'>@relayip</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="reporter=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="reporter-instance_method">
  
    #<strong>reporter</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute reporter.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reporter'>reporter</span>
  <span class='ivar'>@reporter</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="router=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="router-instance_method">
  
    #<strong>router</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute router.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_router'>router</span>
  <span class='ivar'>@router</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="served=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="served-instance_method">
  
    #<strong>served</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute served.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_served'>served</span>
  <span class='ivar'>@served</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="served_hostname=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="served_hostname-instance_method">
  
    #<strong>served_hostname</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute served_hostname.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_served_hostname'>served_hostname</span>
  <span class='ivar'>@served_hostname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="served_over=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="served_over-instance_method">
  
    #<strong>served_over</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute served_over.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_served_over'>served_over</span>
  <span class='ivar'>@served_over</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="serveOnce=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="serveOnce-instance_method">
  
    #<strong>serveOnce</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute serveOnce.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_serveOnce'>serveOnce</span>
  <span class='ivar'>@serveOnce</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="serveOnlyPXE=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="serveOnlyPXE-instance_method">
  
    #<strong>serveOnlyPXE</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute serveOnlyPXE.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_serveOnlyPXE'>serveOnlyPXE</span>
  <span class='ivar'>@serveOnlyPXE</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="servePXE=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="servePXE-instance_method">
  
    #<strong>servePXE</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute servePXE.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_servePXE'>servePXE</span>
  <span class='ivar'>@servePXE</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sock=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sock-instance_method">
  
    #<strong>sock</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute sock.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sock'>sock</span>
  <span class='ivar'>@sock</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="start_ip=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="start_ip-instance_method">
  
    #<strong>start_ip</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute start_ip.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_ip'>start_ip</span>
  <span class='ivar'>@start_ip</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="thread=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="thread-instance_method">
  
    #<strong>thread</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute thread.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_thread'>thread</span>
  <span class='ivar'>@thread</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="url=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="url-instance_method">
  
    #<strong>url</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute url.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
  <span class='ivar'>@url</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="dhcpoption-instance_method">
  
    #<strong>dhcpoption</strong>(type, val = nil)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ret'>ret</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_ret'>ret</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span>
    <span class='id identifier rubyid_ret'>ret</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_ret'>ret</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dispatch_request-instance_method">
  
    #<strong>dispatch_request</strong>(from, buf)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Dispatch a packet that we received</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 196</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatch_request'>dispatch_request</span><span class='lparen'>(</span><span class='id identifier rubyid_from'>from</span><span class='comma'>,</span> <span class='id identifier rubyid_buf'>buf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#Request-constant" title="Rex::Proto::DHCP::Constants::Request (constant)">Request</a></span></span><span class='rparen'>)</span>
    <span class='comment'>#dlog(&quot;Unknown DHCP request type: #{type}&quot;)
</span>    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='comment'># parse out the members
</span>  <span class='id identifier rubyid__hwtype'>_hwtype</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_hwlen'>hwlen</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid__hops'>_hops</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>3</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__txid'>_txid</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>4</span><span class='op'>..</span><span class='int'>7</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__elapsed'>_elapsed</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>8</span><span class='op'>..</span><span class='int'>9</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__flags'>_flags</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>10</span><span class='op'>..</span><span class='int'>11</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_clientip'>clientip</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>12</span><span class='op'>..</span><span class='int'>15</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__givenip'>_givenip</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>16</span><span class='op'>..</span><span class='int'>19</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__nextip'>_nextip</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>20</span><span class='op'>..</span><span class='int'>23</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__relayip'>_relayip</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>24</span><span class='op'>..</span><span class='int'>27</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__clienthwaddr'>_clienthwaddr</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='lparen'>(</span><span class='int'>27</span><span class='op'>+</span><span class='id identifier rubyid_hwlen'>hwlen</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_servhostname'>servhostname</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>44</span><span class='op'>..</span><span class='int'>107</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid__filename'>_filename</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>108</span><span class='op'>..</span><span class='int'>235</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_magic'>magic</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>236</span><span class='op'>..</span><span class='int'>239</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_magic'>magic</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPMagic-constant" title="Rex::Proto::DHCP::Constants::DHCPMagic (constant)">DHCPMagic</a></span></span><span class='rparen'>)</span>
    <span class='comment'>#dlog(&quot;Invalid DHCP request - bad magic.&quot;)
</span>    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_pxeclient'>pxeclient</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='comment'># options parsing loop
</span>  <span class='id identifier rubyid_spot'>spot</span> <span class='op'>=</span> <span class='int'>240</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_spot'>spot</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_buf'>buf</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>3</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_optionType'>optionType</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='id identifier rubyid_spot'>spot</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_optionType'>optionType</span> <span class='op'>==</span> <span class='int'>0xff</span>

    <span class='id identifier rubyid_optionLen'>optionLen</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='id identifier rubyid_spot'>spot</span> <span class='op'>+</span> <span class='int'>1</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_optionValue'>optionValue</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='lparen'>(</span><span class='id identifier rubyid_spot'>spot</span> <span class='op'>+</span> <span class='int'>2</span><span class='rparen'>)</span><span class='op'>..</span><span class='lparen'>(</span><span class='id identifier rubyid_spot'>spot</span> <span class='op'>+</span> <span class='id identifier rubyid_optionLen'>optionLen</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_spot'>spot</span> <span class='op'>=</span> <span class='id identifier rubyid_spot'>spot</span> <span class='op'>+</span> <span class='id identifier rubyid_optionLen'>optionLen</span> <span class='op'>+</span> <span class='int'>2</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_optionType'>optionType</span> <span class='op'>==</span> <span class='int'>53</span>
      <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>=</span> <span class='id identifier rubyid_optionValue'>optionValue</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_optionType'>optionType</span> <span class='op'>==</span> <span class='int'>150</span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='id identifier rubyid_optionType'>optionType</span> <span class='op'>==</span> <span class='int'>60</span> <span class='kw'>and</span> <span class='id identifier rubyid_optionValue'>optionValue</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PXEClient</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_pxeclient'>pxeclient</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># don&#39;t serve if only serving PXE and not PXE request
</span>  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_pxeclient'>pxeclient</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serveOnlyPXE'>serveOnlyPXE</span> <span class='op'>==</span> <span class='kw'>true</span>

  <span class='comment'># prepare response
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#Response-constant" title="Rex::Proto::DHCP::Constants::Response (constant)">Response</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='int'>7</span><span class='rbracket'>]</span> <span class='comment'>#hwtype, hwlen, hops, txid
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00\x00\x00\x00</span><span class='tstring_end'>&quot;</span></span>  <span class='comment'>#elapsed, flags
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_clientip'>clientip</span>

  <span class='comment'># if this is somebody we&#39;ve seen before, use the saved IP
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_iton'>addr_iton</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='lbracket'>[</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span> <span class='comment'># otherwise go to next ip address
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span> <span class='op'>&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_end_ip'>end_ip</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_start_ip'>start_ip</span>
    <span class='kw'>end</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span><span class='comma'>,</span> <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPRequest-constant" title="Rex::Proto::DHCP::Constants::DHCPRequest (constant)">DHCPRequest</a></span></span> <span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_addr_iton'>addr_iton</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_ip'>current_ip</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span> <span class='comment'>#next server ip
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_relayip'>relayip</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span> <span class='comment'>#client hw address
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_servhostname'>servhostname</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myfilename'>myfilename</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_magic'>magic</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x35\x01</span><span class='tstring_end'>&quot;</span></span> <span class='comment'>#Option
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPDiscover-constant" title="Rex::Proto::DHCP::Constants::DHCPDiscover (constant)">DHCPDiscover</a></span></span>  <span class='comment'>#DHCP Discover - send DHCP Offer
</span>    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPOffer-constant" title="Rex::Proto::DHCP::Constants::DHCPOffer (constant)">DHCPOffer</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='comment'># check if already served an Ack based on hw addr (MAC address)
</span>    <span class='comment'># if serveOnce &amp; PXE, don&#39;t reply to another PXE request
</span>    <span class='comment'># if serveOnce &amp; ! PXE, don&#39;t reply to anything
</span>    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serveOnce'>serveOnce</span> <span class='op'>==</span> <span class='kw'>true</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>and</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='lbracket'>[</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_pxeclient'>pxeclient</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='kw'>or</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_servePXE'>servePXE</span> <span class='op'>==</span> <span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPRequest-constant" title="Rex::Proto::DHCP::Constants::DHCPRequest (constant)">DHCPRequest</a></span></span> <span class='comment'>#DHCP Request - send DHCP ACK
</span>    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPAck-constant" title="Rex::Proto::DHCP::Constants::DHCPAck (constant)">DHCPAck</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='comment'># now we ignore their discovers (but we&#39;ll respond to requests in case a packet was lost)
</span>    <span class='kw'>if</span> <span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='rparen'>)</span>
      <span class='comment'># NOTE: this is sufficient for low-traffic net
</span>      <span class='comment'># for high-traffic, this will probably lead to
</span>      <span class='comment'># hostname collision
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span>  <span class='comment'># ignore unknown DHCP request
</span>  <span class='kw'>end</span>

  <span class='comment'># Options!
</span>  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpProxyAutodiscovery-constant" title="Rex::Proto::DHCP::Constants::OpProxyAutodiscovery (constant)">OpProxyAutodiscovery</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_proxy_auto_discovery'>proxy_auto_discovery</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_proxy_auto_discovery'>proxy_auto_discovery</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpDHCPServer-constant" title="Rex::Proto::DHCP::Constants::OpDHCPServer (constant)">OpDHCPServer</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpLeaseTime-constant" title="Rex::Proto::DHCP::Constants::OpLeaseTime (constant)">OpLeaseTime</a></span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_leasetime'>leasetime</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpSubnetMask-constant" title="Rex::Proto::DHCP::Constants::OpSubnetMask (constant)">OpSubnetMask</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_netmaskn'>netmaskn</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpRouter-constant" title="Rex::Proto::DHCP::Constants::OpRouter (constant)">OpRouter</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_router'>router</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpDns-constant" title="Rex::Proto::DHCP::Constants::OpDns (constant)">OpDns</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dnsserv'>dnsserv</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpDomainName-constant" title="Rex::Proto::DHCP::Constants::OpDomainName (constant)">OpDomainName</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_domain_name'>domain_name</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_domain_name'>domain_name</span>

  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_servePXE'>servePXE</span>  <span class='comment'># PXE options
</span>    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpPXEMagic-constant" title="Rex::Proto::DHCP::Constants::OpPXEMagic (constant)">OpPXEMagic</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#PXEMagic-constant" title="Rex::Proto::DHCP::Constants::PXEMagic (constant)">PXEMagic</a></span></span><span class='rparen'>)</span>
    <span class='comment'># We already got this one, serve localboot file
</span>    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serveOnce'>serveOnce</span> <span class='op'>==</span> <span class='kw'>true</span> <span class='kw'>and</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>and</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='lbracket'>[</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_pxeclient'>pxeclient</span> <span class='op'>==</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpPXEConfigFile-constant" title="Rex::Proto::DHCP::Constants::OpPXEConfigFile (constant)">OpPXEConfigFile</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxealtconfigfile'>pxealtconfigfile</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='comment'># We are handing out an IP and our PXE attack
</span>      <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reporter'>reporter</span><span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reporter'>reporter</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipstring'>ipstring</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpPXEConfigFile-constant" title="Rex::Proto::DHCP::Constants::OpPXEConfigFile (constant)">OpPXEConfigFile</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxeconfigfile'>pxeconfigfile</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpPXEPathPrefix-constant" title="Rex::Proto::DHCP::Constants::OpPXEPathPrefix (constant)">OpPXEPathPrefix</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxepathprefix'>pxepathprefix</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpPXERebootTime-constant" title="Rex::Proto::DHCP::Constants::OpPXERebootTime (constant)">OpPXERebootTime</a></span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pxereboottime'>pxereboottime</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_give_hostname'>give_hostname</span> <span class='op'>==</span> <span class='kw'>true</span> <span class='rparen'>)</span>
      <span class='id identifier rubyid_send_hostname'>send_hostname</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_hostname'>served_hostname</span>
      <span class='kw'>if</span> <span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='rparen'>)</span>
        <span class='comment'># NOTE : see above comments for the &#39;uniqueness&#39; of this value
</span>        <span class='id identifier rubyid_send_hostname'>send_hostname</span> <span class='op'>+=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served_over'>served_over</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpHostname-constant" title="Rex::Proto::DHCP::Constants::OpHostname (constant)">OpHostname</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_send_hostname'>send_hostname</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpURL-constant" title="Rex::Proto::DHCP::Constants::OpURL (constant)">OpURL</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span>
  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_dhcpoption'>dhcpoption</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#OpEnd-constant" title="Rex::Proto::DHCP::Constants::OpEnd (constant)">OpEnd</a></span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='int'>32</span><span class='rparen'>)</span> <span class='comment'>#padding
</span>
  <span class='comment'># And now we mark as requested
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span><span class='lbracket'>[</span><span class='id identifier rubyid_buf'>buf</span><span class='lbracket'>[</span><span class='int'>28</span><span class='op'>..</span><span class='int'>43</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_messageType'>messageType</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Rex::Proto::DHCP::Constants (module)">Constants</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Constants.html#DHCPRequest-constant" title="Rex::Proto::DHCP::Constants::DHCPRequest (constant)">DHCPRequest</a></span></span>

  <span class='id identifier rubyid_send_packet'>send_packet</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="monitor_socket-instance_method">
  
    #<strong>monitor_socket</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>See if there is anything to do.. If so, dispatch it.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 166</span>

<span class='kw'>def</span> <span class='id identifier rubyid_monitor_socket'>monitor_socket</span>
  <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_rds'>rds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@sock</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_wds'>wds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_eds'>eds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@sock</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span><span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='id identifier rubyid_rds'>rds</span><span class='comma'>,</span><span class='id identifier rubyid_wds'>wds</span><span class='comma'>,</span><span class='id identifier rubyid_eds'>eds</span><span class='comma'>,</span><span class='int'>1</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='kw'>and</span> <span class='id identifier rubyid_r'>r</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_buf'>buf</span><span class='comma'>,</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_recvfrom'>recvfrom</span><span class='lparen'>(</span><span class='int'>65535</span><span class='rparen'>)</span>
      <span class='comment'># Lame compatabilitiy :-/
</span>      <span class='id identifier rubyid_from'>from</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_dispatch_request'>dispatch_request</span><span class='lparen'>(</span><span class='id identifier rubyid_from'>from</span><span class='comma'>,</span> <span class='id identifier rubyid_buf'>buf</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="report-instance_method">
  
    #<strong>report</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reporter'>reporter</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_packet-instance_method">
  
    #<strong>send_packet</strong>(ip, pkt)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Send a single packet to the specified host</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_packet'>send_packet</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='int'>68</span> <span class='comment'># bootpc
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_sendto'>sendto</span><span class='lparen'>(</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_sendto'>sendto</span><span class='lparen'>(</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>255.255.255.255</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_sendto'>sendto</span><span class='lparen'>(</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_broadcasta'>broadcasta</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_option-instance_method">
  
    #<strong>set_option</strong>(opts)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set an option</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133
134
135
136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 127</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_option'>set_option</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_allowed_options'>allowed_options</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='symbol'>:serveOnce</span><span class='comma'>,</span> <span class='symbol'>:pxealtconfigfile</span><span class='comma'>,</span> <span class='symbol'>:servePXE</span><span class='comma'>,</span> <span class='symbol'>:relayip</span><span class='comma'>,</span> <span class='symbol'>:leasetime</span><span class='comma'>,</span> <span class='symbol'>:dnsserv</span><span class='comma'>,</span>
    <span class='symbol'>:pxeconfigfile</span><span class='comma'>,</span> <span class='symbol'>:pxepathprefix</span><span class='comma'>,</span> <span class='symbol'>:pxereboottime</span><span class='comma'>,</span> <span class='symbol'>:router</span><span class='comma'>,</span> <span class='symbol'>:proxy_auto_discovery</span><span class='comma'>,</span>
    <span class='symbol'>:give_hostname</span><span class='comma'>,</span> <span class='symbol'>:served_hostname</span><span class='comma'>,</span> <span class='symbol'>:served_over</span><span class='comma'>,</span> <span class='symbol'>:serveOnlyPXE</span><span class='comma'>,</span> <span class='symbol'>:domain_name</span><span class='comma'>,</span> <span class='symbol'>:url</span>
  <span class='rbracket'>]</span>

  <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_v'>v</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_allowed_options'>allowed_options</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start the DHCP server</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>Udp</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LocalHost</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_listen_host'>listen_host</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LocalPort</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_listen_port'>listen_port</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Context</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_context'>context</span>
  <span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_thread'>thread</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../ThreadFactory.html" title="Rex::ThreadFactory (class)">ThreadFactory</a></span></span><span class='period'>.</span><span class='id identifier rubyid_spawn'><span class='object_link'><a href="../../ThreadFactory.html#spawn-class_method" title="Rex::ThreadFactory.spawn (method)">spawn</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DHCPServerMonitor</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_monitor_socket'>monitor_socket</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    #<strong>stop</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stop the DHCP server</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dhcp/server.rb', line 119</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop'>stop</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_thread'>thread</span><span class='period'>.</span><span class='id identifier rubyid_kill'>kill</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_served'>served</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Oct 31 12:10:25 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>