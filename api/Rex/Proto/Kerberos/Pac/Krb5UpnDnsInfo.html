<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Proto::Kerberos::Pac::Krb5UpnDnsInfo
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Proto::Kerberos::Pac::Krb5UpnDnsInfo";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (K)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pac.html" title="Rex::Proto::Kerberos::Pac (module)">Pac</a></span></span>
     &raquo; 
    <span class="title">Krb5UpnDnsInfo</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Proto::Kerberos::Pac::Krb5UpnDnsInfo
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">BinData::Record</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">BinData::Record</li>
          
            <li class="next">Rex::Proto::Kerberos::Pac::Krb5UpnDnsInfo</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/kerberos/pac/krb5_pac.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>See [2.10 UPN_DNS_INFO](<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/1c0d6e11-6443-4846-b744-f9f810a504eb">learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/1c0d6e11-6443-4846-b744-f9f810a504eb</a>)</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dns_domain_name-instance_method" title="#dns_domain_name (instance method)">#<strong>dns_domain_name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The DNS Domain Name (e.g. WINDOMAIN.LOCAL).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dns_domain_name_length-instance_method" title="#dns_domain_name_length (instance method)">#<strong>dns_domain_name_length</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The length of the DNS domain name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dns_domain_name_offset-instance_method" title="#dns_domain_name_offset (instance method)">#<strong>dns_domain_name_offset</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The relative offset of the DNS domain name from the beginning of this structure.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#flags-instance_method" title="#flags (instance method)">#<strong>flags</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>U flag (bit 0) The user account object does not have the userPrincipalName attribute.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sam_name-instance_method" title="#sam_name (instance method)">#<strong>sam_name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The SAM Name (e.g. test).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sam_name_length-instance_method" title="#sam_name_length (instance method)">#<strong>sam_name_length</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Only available if the S flag is set.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sam_name_offset-instance_method" title="#sam_name_offset (instance method)">#<strong>sam_name_offset</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Only available if the S flag is set.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sid-instance_method" title="#sid (instance method)">#<strong>sid</strong>  &#x21d2; MsDtypSid </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The SID (e.g. S-1-5-32-544).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sid_length-instance_method" title="#sid_length (instance method)">#<strong>sid_length</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Only available if the S flag is set.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sid_offset-instance_method" title="#sid_offset (instance method)">#<strong>sid_offset</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Only available if the S flag is set.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ul_type-instance_method" title="#ul_type (instance method)">#<strong>ul_type</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Describes the type of data present in the buffer.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#upn-instance_method" title="#upn (instance method)">#<strong>upn</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The UPN (User Principal Name) (e.g. test@windomain.local).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#upn_length-instance_method" title="#upn_length (instance method)">#<strong>upn_length</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The length of the UPN.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#upn_offset-instance_method" title="#upn_offset (instance method)">#<strong>upn_offset</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The relative offset of the UPN from the beginning of this structure.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_num_bytes-instance_method" title="#do_num_bytes (instance method)">#<strong>do_num_bytes</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_s_flag%3F-instance_method" title="#has_s_flag? (instance method)">#<strong>has_s_flag?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>def initialize_instance(*args)   super   set_offsets! end.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_u_flag%3F-instance_method" title="#has_u_flag? (instance method)">#<strong>has_u_flag?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of the U flag.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_offsets!-instance_method" title="#set_offsets! (instance method)">#<strong>set_offsets!</strong>(upn: nil, dns_domain_name: nil, sam_name: nil, sid: nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Allows you to specify the offsets for the contents, otherwise defaults them.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_s_flag-instance_method" title="#set_s_flag (instance method)">#<strong>set_s_flag</strong>(bool)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_u_flag-instance_method" title="#set_u_flag (instance method)">#<strong>set_u_flag</strong>(bool)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="dns_domain_name=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="dns_domain_name-instance_method">
  
    #<strong>dns_domain_name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The DNS Domain Name (e.g. WINDOMAIN.LOCAL).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The DNS Domain Name (e.g. WINDOMAIN.LOCAL)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


730
731
732</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 730</span>

<span class='id identifier rubyid_delayed_io'>delayed_io</span> <span class='symbol'>:dns_domain_name</span><span class='comma'>,</span> <span class='label'>read_abs_offset:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abs_offset'>abs_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_dns_domain_name_offset'>dns_domain_name_offset</span> <span class='rbrace'>}</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_string16'>string16</span> <span class='label'>read_length:</span> <span class='symbol'>:dns_domain_name_length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="dns_domain_name_length=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="dns_domain_name_length-instance_method">
  
    #<strong>dns_domain_name_length</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The length of the DNS domain name.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The length of the DNS domain name</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


689</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 689</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:dns_domain_name_length</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_dns_domain_name'>dns_domain_name</span><span class='period'>.</span><span class='id identifier rubyid_num_bytes'>num_bytes</span> <span class='rbrace'>}</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="dns_domain_name_offset=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="dns_domain_name_offset-instance_method">
  
    #<strong>dns_domain_name_offset</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The relative offset of the DNS domain name from the beginning of this structure.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset of the DNS domain name from the beginning of this structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


693</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 693</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:dns_domain_name_offset</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="flags=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="flags-instance_method">
  
    #<strong>flags</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>U flag (bit 0) The user account object does not have the userPrincipalName attribute. S flag (bit 1) The structure has been extended with the user account’s SAM Name and SID. The remaining bits are ignored.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


700</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 700</span>

<span class='id identifier rubyid_uint32'>uint32</span> <span class='symbol'>:flags</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sam_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sam_name-instance_method">
  
    #<strong>sam_name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The SAM Name (e.g. test).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SAM Name (e.g. test)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


736
737
738</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 736</span>

<span class='id identifier rubyid_delayed_io'>delayed_io</span> <span class='symbol'>:sam_name</span><span class='comma'>,</span> <span class='label'>read_abs_offset:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abs_offset'>abs_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_sam_name_offset'>sam_name_offset</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_has_s_flag?'>has_s_flag?</span> <span class='rbrace'>}</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_string16'>string16</span> <span class='label'>read_length:</span> <span class='symbol'>:sam_name_length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sam_name_length=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sam_name_length-instance_method">
  
    #<strong>sam_name_length</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Only available if the S flag is set</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The length of the SAM name</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


705</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 705</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:sam_name_length</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_sam_name'>sam_name</span><span class='period'>.</span><span class='id identifier rubyid_num_bytes'>num_bytes</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='symbol'>:has_s_flag?</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sam_name_offset=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sam_name_offset-instance_method">
  
    #<strong>sam_name_offset</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Only available if the S flag is set</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset of the SAM name from the beginning of this structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


710</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 710</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:sam_name_offset</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='symbol'>:has_s_flag?</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sid=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sid-instance_method">
  
    #<strong>sid</strong>  &#x21d2; <tt>MsDtypSid</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The SID (e.g. S-1-5-32-544).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>MsDtypSid</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SID (e.g. S-1-5-32-544)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


742
743
744</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 742</span>

<span class='id identifier rubyid_delayed_io'>delayed_io</span> <span class='symbol'>:sid</span><span class='comma'>,</span> <span class='label'>read_abs_offset:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abs_offset'>abs_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_sid_offset'>sid_offset</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_has_s_flag?'>has_s_flag?</span> <span class='rbrace'>}</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_ms_dtyp_sid'>ms_dtyp_sid</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sid_length=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sid_length-instance_method">
  
    #<strong>sid_length</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Only available if the S flag is set</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The length of the SID</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


715</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 715</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:sid_length</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_sid'>sid</span><span class='period'>.</span><span class='id identifier rubyid_num_bytes'>num_bytes</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='symbol'>:has_s_flag?</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="sid_offset=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="sid_offset-instance_method">
  
    #<strong>sid_offset</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Only available if the S flag is set</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset of the SID from the beginning of this structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


720</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 720</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:sid_offset</span><span class='comma'>,</span> <span class='label'>onlyif:</span> <span class='symbol'>:has_s_flag?</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="ul_type-instance_method">
  
    #<strong>ul_type</strong>  &#x21d2; <tt>Integer</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Describes the type of data present in the buffer.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Describes the type of data present in the buffer</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


677</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 677</span>

<span class='id identifier rubyid_virtual'>virtual</span> <span class='symbol'>:ul_type</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='const'><span class='object_link'><a href="Krb5PacElementType.html" title="Rex::Proto::Kerberos::Pac::Krb5PacElementType (module)">Krb5PacElementType</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Krb5PacElementType.html#USER_PRINCIPAL_NAME_AND_DNS_INFORMATION-constant" title="Rex::Proto::Kerberos::Pac::Krb5PacElementType::USER_PRINCIPAL_NAME_AND_DNS_INFORMATION (constant)">USER_PRINCIPAL_NAME_AND_DNS_INFORMATION</a></span></span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="upn=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="upn-instance_method">
  
    #<strong>upn</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The UPN (User Principal Name) (e.g. test@windomain.local).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The UPN (User Principal Name) (e.g. test@windomain.local)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


724
725
726</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 724</span>

<span class='id identifier rubyid_delayed_io'>delayed_io</span> <span class='symbol'>:upn</span><span class='comma'>,</span> <span class='label'>read_abs_offset:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_abs_offset'>abs_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_upn_offset'>upn_offset</span> <span class='rbrace'>}</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_string16'>string16</span> <span class='label'>read_length:</span> <span class='symbol'>:upn_length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="upn_length=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="upn_length-instance_method">
  
    #<strong>upn_length</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The length of the UPN.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The length of the UPN</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


681</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 681</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:upn_length</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_upn'>upn</span><span class='period'>.</span><span class='id identifier rubyid_num_bytes'>num_bytes</span> <span class='rbrace'>}</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="upn_offset=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="upn_offset-instance_method">
  
    #<strong>upn_offset</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The relative offset of the UPN from the beginning of this structure.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset of the UPN from the beginning of this structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


685</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 685</span>

<span class='id identifier rubyid_uint16'>uint16</span> <span class='symbol'>:upn_offset</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="do_num_bytes-instance_method">
  
    #<strong>do_num_bytes</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


746
747
748
749
750
751
752
753</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 746</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_num_bytes'>do_num_bytes</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_has_s_flag?'>has_s_flag?</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_sid_offset'>sid_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_sid_length'>sid_length</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_dns_domain_name_offset'>dns_domain_name_offset</span> <span class='op'>+</span> <span class='id identifier rubyid_dns_domain_name_length'>dns_domain_name_length</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_s_flag?-instance_method">
  
    #<strong>has_s_flag?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>def initialize_instance(*args)</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>super</span>
<span class='id identifier rubyid_set_offsets!'>set_offsets!</span>
</code></pre>

<p>end</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns the value of the S flag</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


760
761
762</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 760</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_s_flag?'>has_s_flag?</span>
  <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_anybits?'>anybits?</span><span class='lparen'>(</span><span class='int'>0b10</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_u_flag?-instance_method">
  
    #<strong>has_u_flag?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of the U flag</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns the value of the U flag</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


771
772
773</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 771</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_u_flag?'>has_u_flag?</span>
  <span class='id identifier rubyid_flags'>flags</span><span class='period'>.</span><span class='id identifier rubyid_anybits?'>anybits?</span><span class='lparen'>(</span><span class='int'>0b01</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_offsets!-instance_method">
  
    #<strong>set_offsets!</strong>(upn: nil, dns_domain_name: nil, sam_name: nil, sid: nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Allows you to specify the offsets for the contents, otherwise defaults them</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>upn</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset for the upn</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>dns_domain_name</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset for the dns_domain_name</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sam_name</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset for the sam_name</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sid</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The relative offset for the sid</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


788
789
790
791
792
793</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 788</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_offsets!'>set_offsets!</span><span class='lparen'>(</span><span class='label'>upn:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>dns_domain_name:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>sam_name:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>sid:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_upn_offset'>upn_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_upn'>upn</span> <span class='op'>||</span> <span class='id identifier rubyid_calc_upn_offset'>calc_upn_offset</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dns_domain_name_offset'>dns_domain_name_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_dns_domain_name'>dns_domain_name</span> <span class='op'>||</span> <span class='id identifier rubyid_calc_dns_domain_name_offset'>calc_dns_domain_name_offset</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sam_name_offset'>sam_name_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_sam_name'>sam_name</span> <span class='op'>||</span> <span class='id identifier rubyid_calc_sam_name_offset'>calc_sam_name_offset</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sid_offset'>sid_offset</span> <span class='op'>=</span> <span class='id identifier rubyid_sid'>sid</span> <span class='op'>||</span> <span class='id identifier rubyid_calc_sid_offset'>calc_sid_offset</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_s_flag-instance_method">
  
    #<strong>set_s_flag</strong>(bool)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>bool</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The value to set the S flag to</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


766
767
768</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 766</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_s_flag'>set_s_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_bool'>bool</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_flag_bit'>set_flag_bit</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_u_flag-instance_method">
  
    #<strong>set_u_flag</strong>(bool)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>bool</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The value to set the U flag to</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


777
778
779</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/kerberos/pac/krb5_pac.rb', line 777</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_u_flag'>set_u_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_bool'>bool</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_flag_bit'>set_flag_bit</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_bool'>bool</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Oct 31 12:10:40 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>