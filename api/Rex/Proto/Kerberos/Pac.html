<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Rex::Proto::Kerberos::Pac
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Proto::Kerberos::Pac";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span>
     &raquo; 
    <span class="title">Pac</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Rex::Proto::Kerberos::Pac
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/kerberos/pac/krb5_pac.rb<span class="defines">,<br />
  lib/rex/proto/kerberos/pac.rb,<br /> lib/rex/proto/kerberos/pac/error.rb,<br /> lib/rex/proto/kerberos/pac/krb5_pac_element_type.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>full MIDL spec for PAC <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/1d4912dd-5115-4124-94b6-fa414add575f">learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/1d4912dd-5115-4124-94b6-fa414add575f</a></p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Pac/Error.html" title="Rex::Proto::Kerberos::Pac::Error (module)">Error</a></span>, <span class='object_link'><a href="Pac/Krb5PacElementType.html" title="Rex::Proto::Kerberos::Pac::Krb5PacElementType (module)">Krb5PacElementType</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Pac/CypherBlock.html" title="Rex::Proto::Kerberos::Pac::CypherBlock (class)">CypherBlock</a></span>, <span class='object_link'><a href="Pac/GroupAttributes.html" title="Rex::Proto::Kerberos::Pac::GroupAttributes (class)">GroupAttributes</a></span>, <span class='object_link'><a href="Pac/Krb5ClientInfo.html" title="Rex::Proto::Kerberos::Pac::Krb5ClientInfo (class)">Krb5ClientInfo</a></span>, <span class='object_link'><a href="Pac/Krb5FullPacChecksum.html" title="Rex::Proto::Kerberos::Pac::Krb5FullPacChecksum (class)">Krb5FullPacChecksum</a></span>, <span class='object_link'><a href="Pac/Krb5LogonInformation.html" title="Rex::Proto::Kerberos::Pac::Krb5LogonInformation (class)">Krb5LogonInformation</a></span>, <span class='object_link'><a href="Pac/Krb5NtlmSupplementalCredential.html" title="Rex::Proto::Kerberos::Pac::Krb5NtlmSupplementalCredential (class)">Krb5NtlmSupplementalCredential</a></span>, <span class='object_link'><a href="Pac/Krb5Pac.html" title="Rex::Proto::Kerberos::Pac::Krb5Pac (class)">Krb5Pac</a></span>, <span class='object_link'><a href="Pac/Krb5PacAttributes.html" title="Rex::Proto::Kerberos::Pac::Krb5PacAttributes (class)">Krb5PacAttributes</a></span>, <span class='object_link'><a href="Pac/Krb5PacCredentialData.html" title="Rex::Proto::Kerberos::Pac::Krb5PacCredentialData (class)">Krb5PacCredentialData</a></span>, <span class='object_link'><a href="Pac/Krb5PacCredentialDataPtr.html" title="Rex::Proto::Kerberos::Pac::Krb5PacCredentialDataPtr (class)">Krb5PacCredentialDataPtr</a></span>, <span class='object_link'><a href="Pac/Krb5PacCredentialInfo.html" title="Rex::Proto::Kerberos::Pac::Krb5PacCredentialInfo (class)">Krb5PacCredentialInfo</a></span>, <span class='object_link'><a href="Pac/Krb5PacElement.html" title="Rex::Proto::Kerberos::Pac::Krb5PacElement (class)">Krb5PacElement</a></span>, <span class='object_link'><a href="Pac/Krb5PacInfoBuffer.html" title="Rex::Proto::Kerberos::Pac::Krb5PacInfoBuffer (class)">Krb5PacInfoBuffer</a></span>, <span class='object_link'><a href="Pac/Krb5PacPrivServerChecksum.html" title="Rex::Proto::Kerberos::Pac::Krb5PacPrivServerChecksum (class)">Krb5PacPrivServerChecksum</a></span>, <span class='object_link'><a href="Pac/Krb5PacRequestor.html" title="Rex::Proto::Kerberos::Pac::Krb5PacRequestor (class)">Krb5PacRequestor</a></span>, <span class='object_link'><a href="Pac/Krb5PacServerChecksum.html" title="Rex::Proto::Kerberos::Pac::Krb5PacServerChecksum (class)">Krb5PacServerChecksum</a></span>, <span class='object_link'><a href="Pac/Krb5PacSignatureData.html" title="Rex::Proto::Kerberos::Pac::Krb5PacSignatureData (class)">Krb5PacSignatureData</a></span>, <span class='object_link'><a href="Pac/Krb5SecpkgSupplementalCred.html" title="Rex::Proto::Kerberos::Pac::Krb5SecpkgSupplementalCred (class)">Krb5SecpkgSupplementalCred</a></span>, <span class='object_link'><a href="Pac/Krb5SecpkgSupplementalCredByteArrayPtr.html" title="Rex::Proto::Kerberos::Pac::Krb5SecpkgSupplementalCredByteArrayPtr (class)">Krb5SecpkgSupplementalCredByteArrayPtr</a></span>, <span class='object_link'><a href="Pac/Krb5SerializedPacCredentialData.html" title="Rex::Proto::Kerberos::Pac::Krb5SerializedPacCredentialData (class)">Krb5SerializedPacCredentialData</a></span>, <span class='object_link'><a href="Pac/Krb5SidAndAttributes.html" title="Rex::Proto::Kerberos::Pac::Krb5SidAndAttributes (class)">Krb5SidAndAttributes</a></span>, <span class='object_link'><a href="Pac/Krb5SidAndAttributesPtr.html" title="Rex::Proto::Kerberos::Pac::Krb5SidAndAttributesPtr (class)">Krb5SidAndAttributesPtr</a></span>, <span class='object_link'><a href="Pac/Krb5SignatureType.html" title="Rex::Proto::Kerberos::Pac::Krb5SignatureType (class)">Krb5SignatureType</a></span>, <span class='object_link'><a href="Pac/Krb5TicketChecksum.html" title="Rex::Proto::Kerberos::Pac::Krb5TicketChecksum (class)">Krb5TicketChecksum</a></span>, <span class='object_link'><a href="Pac/Krb5UpnDnsInfo.html" title="Rex::Proto::Kerberos::Pac::Krb5UpnDnsInfo (class)">Krb5UpnDnsInfo</a></span>, <span class='object_link'><a href="Pac/Krb5ValidationInfo.html" title="Rex::Proto::Kerberos::Pac::Krb5ValidationInfo (class)">Krb5ValidationInfo</a></span>, <span class='object_link'><a href="Pac/Krb5ValidationInfoPtr.html" title="Rex::Proto::Kerberos::Pac::Krb5ValidationInfoPtr (class)">Krb5ValidationInfoPtr</a></span>, <span class='object_link'><a href="Pac/PacAttributesFlags.html" title="Rex::Proto::Kerberos::Pac::PacAttributesFlags (class)">PacAttributesFlags</a></span>, <span class='object_link'><a href="Pac/UnknownPacElement.html" title="Rex::Proto::Kerberos::Pac::UnknownPacElement (class)">UnknownPacElement</a></span>, <span class='object_link'><a href="Pac/UpnDnsInfoAttributes.html" title="Rex::Proto::Kerberos::Pac::UpnDnsInfoAttributes (class)">UpnDnsInfoAttributes</a></span>, <span class='object_link'><a href="Pac/UserAccountAttributes.html" title="Rex::Proto::Kerberos::Pac::UserAccountAttributes (class)">UserAccountAttributes</a></span>, <span class='object_link'><a href="Pac/UserFlagAttributes.html" title="Rex::Proto::Kerberos::Pac::UserFlagAttributes (class)">UserFlagAttributes</a></span>, <span class='object_link'><a href="Pac/UserSessionKey.html" title="Rex::Proto::Kerberos::Pac::UserSessionKey (class)">UserSessionKey</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='int'>0</span></pre></dd>
      
        <dt id="NETLOGON_FLAG-constant" class="">NETLOGON_FLAG =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x20000</span></pre></dd>
      
        <dt id="SE_GROUP_MANDATORY-constant" class="">SE_GROUP_MANDATORY =
          <div class="docstring">
  <div class="discussion">
    
<p>Kerberos: <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/311aab27-ebdf-47f7-b939-13dc99b15341">learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/311aab27-ebdf-47f7-b939-13dc99b15341</a> Reference with details on flags: <a href="https://learn.microsoft.com/en-gb/windows/win32/api/winnt/ns-winnt-token_groups?redirectedfrom=MSDN#members">learn.microsoft.com/en-gb/windows/win32/api/winnt/ns-winnt-token_groups?redirectedfrom=MSDN#members</a></p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>0x00000001</span></pre></dd>
      
        <dt id="SE_GROUP_ENABLED_BY_DEFAULT-constant" class="">SE_GROUP_ENABLED_BY_DEFAULT =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000002</span></pre></dd>
      
        <dt id="SE_GROUP_ENABLED-constant" class="">SE_GROUP_ENABLED =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000004</span></pre></dd>
      
        <dt id="SE_GROUP_OWNER-constant" class="">SE_GROUP_OWNER =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000008</span></pre></dd>
      
        <dt id="SE_GROUP_RESOURCE-constant" class="">SE_GROUP_RESOURCE =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x20000000</span></pre></dd>
      
        <dt id="SE_GROUP_ALL-constant" class="">SE_GROUP_ALL =
          <div class="docstring">
  <div class="discussion">
    
<p>XXX: Does not include some of the newer SE_GROUP_* flags</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="#SE_GROUP_MANDATORY-constant" title="Rex::Proto::Kerberos::Pac::SE_GROUP_MANDATORY (constant)">SE_GROUP_MANDATORY</a></span></span> <span class='op'>|</span> <span class='const'><span class='object_link'><a href="#SE_GROUP_ENABLED_BY_DEFAULT-constant" title="Rex::Proto::Kerberos::Pac::SE_GROUP_ENABLED_BY_DEFAULT (constant)">SE_GROUP_ENABLED_BY_DEFAULT</a></span></span> <span class='op'>|</span> <span class='const'><span class='object_link'><a href="#SE_GROUP_ENABLED-constant" title="Rex::Proto::Kerberos::Pac::SE_GROUP_ENABLED (constant)">SE_GROUP_ENABLED</a></span></span></pre></dd>
      
        <dt id="PAC_WAS_GIVEN_IMPLICITLY-constant" class="">PAC_WAS_GIVEN_IMPLICITLY =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000001</span></pre></dd>
      
        <dt id="USER_NORMAL_ACCOUNT-constant" class="">USER_NORMAL_ACCOUNT =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000010</span></pre></dd>
      
        <dt id="USER_DONT_EXPIRE_PASSWORD-constant" class="">USER_DONT_EXPIRE_PASSWORD =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x00000200</span></pre></dd>
      
        <dt id="PAC_LOGON_INFO-constant" class="">PAC_LOGON_INFO =
          
        </dt>
        <dd><pre class="code"><span class='int'>1</span></pre></dd>
      
        <dt id="PAC_CREDENTIALS_INFO-constant" class="">PAC_CREDENTIALS_INFO =
          
        </dt>
        <dd><pre class="code"><span class='int'>2</span></pre></dd>
      
        <dt id="PAC_SERVER_CHECKSUM-constant" class="">PAC_SERVER_CHECKSUM =
          
        </dt>
        <dd><pre class="code"><span class='int'>6</span></pre></dd>
      
        <dt id="PAC_PRIVSVR_CHECKSUM-constant" class="">PAC_PRIVSVR_CHECKSUM =
          
        </dt>
        <dd><pre class="code"><span class='int'>7</span></pre></dd>
      
        <dt id="PAC_CLIENT_INFO-constant" class="">PAC_CLIENT_INFO =
          
        </dt>
        <dd><pre class="code"><span class='int'>10</span></pre></dd>
      
        <dt id="AD_WIN2K_PAC-constant" class="">AD_WIN2K_PAC =
          
        </dt>
        <dd><pre class="code"><span class='int'>128</span></pre></dd>
      
        <dt id="SEC_TO_UNIX_EPOCH-constant" class="">SEC_TO_UNIX_EPOCH =
          
        </dt>
        <dd><pre class="code"><span class='int'>11644473600</span></pre></dd>
      
        <dt id="WINDOWS_TICK-constant" class="">WINDOWS_TICK =
          
        </dt>
        <dd><pre class="code"><span class='int'>10000000</span></pre></dd>
      
        <dt id="NEVER_EXPIRE-constant" class="">NEVER_EXPIRE =
          
        </dt>
        <dd><pre class="code"><span class='int'>0x7fffffffffffffff</span></pre></dd>
      
        <dt id="DOMAIN_ADMINS-constant" class="">DOMAIN_ADMINS =
          
        </dt>
        <dd><pre class="code"><span class='int'>512</span></pre></dd>
      
        <dt id="DOMAIN_USERS-constant" class="">DOMAIN_USERS =
          
        </dt>
        <dd><pre class="code"><span class='int'>513</span></pre></dd>
      
        <dt id="SCHEMA_ADMINISTRATORS-constant" class="">SCHEMA_ADMINISTRATORS =
          
        </dt>
        <dd><pre class="code"><span class='int'>518</span></pre></dd>
      
        <dt id="ENTERPRISE_ADMINS-constant" class="">ENTERPRISE_ADMINS =
          
        </dt>
        <dd><pre class="code"><span class='int'>519</span></pre></dd>
      
        <dt id="GROUP_POLICY_CREATOR_OWNERS-constant" class="">GROUP_POLICY_CREATOR_OWNERS =
          
        </dt>
        <dd><pre class="code"><span class='int'>520</span></pre></dd>
      
        <dt id="DEFAULT_ADMIN_RID-constant" class="">DEFAULT_ADMIN_RID =
          
        </dt>
        <dd><pre class="code"><span class='int'>500</span></pre></dd>
      
        <dt id="DEFAULT_USER_RID-constant" class="">DEFAULT_USER_RID =
          
        </dt>
        <dd><pre class="code"><span class='int'>1000</span></pre></dd>
      
        <dt id="NT_AUTHORITY_SID-constant" class="">NT_AUTHORITY_SID =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S-1-5</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="CHECKSUM_SIGNATURE_LENGTH-constant" class="">CHECKSUM_SIGNATURE_LENGTH =
          <div class="docstring">
  <div class="discussion">
    
<p><a href="https://github.com/rapid7/metasploit-framework/blob/b2eb348d943af25adfc41e6fa689d9da00154685/lib/rex/proto/kerberos/crypto.rb#L37-L42">github.com/rapid7/metasploit-framework/blob/b2eb348d943af25adfc41e6fa689d9da00154685/lib/rex/proto/kerberos/crypto.rb#L37-L42</a> <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/6e95edd3-af93-41d4-8303-6c7955297315">learn.microsoft.com/en-us/openspecs/windows_protocols/ms-pac/6e95edd3-af93-41d4-8303-6c7955297315</a></p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='comment'># Used by: modules/auxiliary/admin/kerberos/ms14_068_kerberos_checksum.rb.
</span>  <span class='comment'># Not defined in the specification explicitly, but the exploit uses a weaker checksum to bypass Microsoft&#39;s PAC security methods
</span>  <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto.html" title="Rex::Proto::Kerberos::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html" title="Rex::Proto::Kerberos::Crypto::Checksum (module)">Checksum</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html#RSA_MD5-constant" title="Rex::Proto::Kerberos::Crypto::Checksum::RSA_MD5 (constant)">RSA_MD5</a></span></span> <span class='op'>=&gt;</span> <span class='int'>16</span><span class='comma'>,</span>
  <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto.html" title="Rex::Proto::Kerberos::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html" title="Rex::Proto::Kerberos::Crypto::Checksum (module)">Checksum</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html#SHA1_AES128-constant" title="Rex::Proto::Kerberos::Crypto::Checksum::SHA1_AES128 (constant)">SHA1_AES128</a></span></span> <span class='op'>=&gt;</span> <span class='int'>12</span><span class='comma'>,</span>
  <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto.html" title="Rex::Proto::Kerberos::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html" title="Rex::Proto::Kerberos::Crypto::Checksum (module)">Checksum</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html#SHA1_AES256-constant" title="Rex::Proto::Kerberos::Crypto::Checksum::SHA1_AES256 (constant)">SHA1_AES256</a></span></span> <span class='op'>=&gt;</span> <span class='int'>12</span><span class='comma'>,</span>
  <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Kerberos.html" title="Rex::Proto::Kerberos (module)">Kerberos</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto.html" title="Rex::Proto::Kerberos::Crypto (module)">Crypto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html" title="Rex::Proto::Kerberos::Crypto::Checksum (module)">Checksum</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Crypto/Checksum.html#HMAC_MD5-constant" title="Rex::Proto::Kerberos::Crypto::Checksum::HMAC_MD5 (constant)">HMAC_MD5</a></span></span> <span class='op'>=&gt;</span> <span class='int'>16</span><span class='comma'>,</span>
  <span class='int'>0xffffff76</span> <span class='op'>=&gt;</span> <span class='int'>16</span> <span class='comment'># Negative 138 two&#39;s complement (HMAC_MD5)
</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  









</div>

      <div id="footer">
  Generated on Thu Jan 29 04:41:47 2026 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>