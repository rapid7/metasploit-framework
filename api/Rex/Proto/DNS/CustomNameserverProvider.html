<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Rex::Proto::DNS::CustomNameserverProvider
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Proto::DNS::CustomNameserverProvider";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DNS.html" title="Rex::Proto::DNS (module)">DNS</a></span></span>
     &raquo; 
    <span class="title">CustomNameserverProvider</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Rex::Proto::DNS::CustomNameserverProvider
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/proto/dns/custom_nameserver_provider.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Provides a DNS resolver the ability to use different nameservers for different requests, based on the domain being queried.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="CustomNameserverProvider/CommSink.html" title="Rex::Proto::DNS::CustomNameserverProvider::CommSink (class)">CommSink</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="CONFIG_KEY_BASE-constant" class="">CONFIG_KEY_BASE =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>framework/dns</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="CONFIG_VERSION-constant" class="">CONFIG_VERSION =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Version.html" title="Rex::Version (class)">Version</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Version.html#initialize-instance_method" title="Rex::Version#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1.0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extended-class_method" title="extended (class method)">.<strong>extended</strong>(mod)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_upstream_rule-instance_method" title="#add_upstream_rule (instance method)">#<strong>add_upstream_rule</strong>(resolvers, comm: nil, wildcard: &#39;*&#39;, index: -1))  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a custom nameserver entry to the custom provider.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush-instance_method" title="#flush (instance method)">#<strong>flush</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_config%3F-instance_method" title="#has_config? (instance method)">#<strong>has_config?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check whether or not there is configuration data in Metasploit’s configuration file which is persisted on disk.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#init-instance_method" title="#init (instance method)">#<strong>init</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_config-instance_method" title="#load_config (instance method)">#<strong>load_config</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load the custom settings from the MSF config file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reinit-instance_method" title="#reinit (instance method)">#<strong>reinit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reinitialize the configuration to its original state.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_ids-instance_method" title="#remove_ids (instance method)">#<strong>remove_ids</strong>(ids)  &#x21d2; Array&lt;UpstreamRule&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove upstream rules with the given indices Ignore entries that are not found.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reorder_ids-instance_method" title="#reorder_ids (instance method)">#<strong>reorder_ids</strong>(ids, new_id)  &#x21d2; Array&lt;UpstreamRule&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Move upstream rules with the given indices into the location provided.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_config-instance_method" title="#save_config (instance method)">#<strong>save_config</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Save the custom settings to the MSF config file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_framework-instance_method" title="#set_framework (instance method)">#<strong>set_framework</strong>(framework)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upstream_resolvers_for_packet-instance_method" title="#upstream_resolvers_for_packet (instance method)">#<strong>upstream_resolvers_for_packet</strong>(packet)  &#x21d2; Array&lt;Array&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The nameservers that match the given packet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upstream_rules-instance_method" title="#upstream_rules (instance method)">#<strong>upstream_rules</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="extended-class_method">
  
    .<strong>extended</strong>(mod)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 228</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_extended'>extended</span><span class='lparen'>(</span><span class='id identifier rubyid_mod'>mod</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mod'>mod</span><span class='period'>.</span><span class='id identifier rubyid_init'>init</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_upstream_rule-instance_method">
  
    #<strong>add_upstream_rule</strong>(resolvers, comm: nil, wildcard: &#39;*&#39;, index: -1))  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a custom nameserver entry to the custom provider.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>resolvers</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The list of upstream resolvers that would be used for this custom rule.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>comm</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Msf/Session/Comm.html" title="Msf::Session::Comm (module)">Msf::Session::Comm</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The communication channel to be used for these DNS requests.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wildcard</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;*&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The wildcard rule to match a DNS request against.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>-1)</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The index at which to insert the rule, defaults to -1 to append it at the end.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127
128
129
130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_upstream_rule'>add_upstream_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_resolvers'>resolvers</span><span class='comma'>,</span> <span class='label'>comm:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>wildcard:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>index:</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resolvers'>resolvers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_resolvers'>resolvers</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_resolvers'>resolvers</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='comment'># coerce into an array of strings
</span>
  <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="UpstreamRule.html" title="Rex::Proto::DNS::UpstreamRule (class)">UpstreamRule</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="UpstreamRule.html#initialize-instance_method" title="Rex::Proto::DNS::UpstreamRule#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>wildcard:</span> <span class='id identifier rubyid_wildcard'>wildcard</span><span class='comma'>,</span>
    <span class='label'>resolvers:</span> <span class='id identifier rubyid_resolvers'>resolvers</span><span class='comma'>,</span>
    <span class='label'>comm:</span> <span class='id identifier rubyid_comm'>comm</span>
  <span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flush-instance_method">
  
    #<strong>flush</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flush'>flush</span>
  <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_config?-instance_method">
  
    #<strong>has_config?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check whether or not there is configuration data in Metasploit’s configuration file which is persisted on disk.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_config?'>has_config?</span>
  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Msf/Config.html" title="Msf::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="../../../Msf/Config.html#load-class_method" title="Msf::Config.load (method)">load</a></span></span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CONFIG_KEY_BASE-constant" title="Rex::Proto::DNS::CustomNameserverProvider::CONFIG_KEY_BASE (constant)">CONFIG_KEY_BASE</a></span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>configuration_version</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DNS configuration can not be loaded because the version is missing</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_their_version'>their_version</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Version.html" title="Rex::Version (class)">Version</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Version.html#initialize-instance_method" title="Rex::Version#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_their_version'>their_version</span> <span class='op'>&gt;</span> <span class='const'><span class='object_link'><a href="#CONFIG_VERSION-constant" title="Rex::Proto::DNS::CustomNameserverProvider::CONFIG_VERSION (constant)">CONFIG_VERSION</a></span></span> <span class='comment'># if the config is newer, it&#39;s incompatible (we only guarantee backwards compat)
</span>    <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DNS configuration version </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_their_version'>their_version</span><span class='embexpr_end'>}</span><span class='tstring_content'> can not be loaded because it is too new</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_my_minimum_version'>my_minimum_version</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Version.html" title="Rex::Version (class)">Version</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Version.html#initialize-instance_method" title="Rex::Version#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CONFIG_VERSION-constant" title="Rex::Proto::DNS::CustomNameserverProvider::CONFIG_VERSION (constant)">CONFIG_VERSION</a></span></span><span class='period'>.</span><span class='id identifier rubyid_canonical_segments'>canonical_segments</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_their_version'>their_version</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_my_minimum_version'>my_minimum_version</span> <span class='comment'># can not be older than our major version
</span>    <span class='ivar'>@logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DNS configuration version </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_their_version'>their_version</span><span class='embexpr_end'>}</span><span class='tstring_content'> can not be loaded because it is too old</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="init-instance_method">
  
    #<strong>init</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_init'>init</span>
  <span class='ivar'>@upstream_rules</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_resolvers'>resolvers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="UpstreamResolver.html" title="Rex::Proto::DNS::UpstreamResolver (class)">UpstreamResolver</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create_static'><span class='object_link'><a href="UpstreamResolver.html#create_static-class_method" title="Rex::Proto::DNS::UpstreamResolver.create_static (method)">create_static</a></span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:nameservers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># if no nameservers are specified, fallback to the system
</span>    <span class='id identifier rubyid_resolvers'>resolvers</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="UpstreamResolver.html" title="Rex::Proto::DNS::UpstreamResolver (class)">UpstreamResolver</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create_system'><span class='object_link'><a href="UpstreamResolver.html#create_system-class_method" title="Rex::Proto::DNS::UpstreamResolver.create_system (method)">create_system</a></span></span>
  <span class='kw'>else</span>
    <span class='comment'># migrate the originally configured name servers
</span>    <span class='id identifier rubyid_resolvers'>resolvers</span> <span class='op'>+=</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:nameservers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_s</span><span class='rparen'>)</span>
    <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:nameservers</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_add_upstream_rule'>add_upstream_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_resolvers'>resolvers</span><span class='rparen'>)</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_config-instance_method">
  
    #<strong>load_config</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load the custom settings from the MSF config file</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112
113
114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 109</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_config'>load_config</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_has_config?'>has_config?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ResolverError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>There is no compatible configuration data to load</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_load_config_entries'>load_config_entries</span>
  <span class='id identifier rubyid_load_config_static_hostnames'>load_config_static_hostnames</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reinit-instance_method">
  
    #<strong>reinit</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reinitialize the configuration to its original state.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reinit'>reinit</span>
  <span class='id identifier rubyid_parse_config_file'>parse_config_file</span>
  <span class='id identifier rubyid_parse_environment_variables'>parse_environment_variables</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_static_hostnames'>static_hostnames</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_static_hostnames'>static_hostnames</span><span class='period'>.</span><span class='id identifier rubyid_parse_hosts_file'>parse_hosts_file</span>

  <span class='id identifier rubyid_init'>init</span>

  <span class='id identifier rubyid_cache'>cache</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span> <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:cache</span><span class='rparen'>)</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_ids-instance_method">
  
    #<strong>remove_ids</strong>(ids)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="UpstreamRule.html" title="Rex::Proto::DNS::UpstreamRule (class)">UpstreamRule</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove upstream rules with the given indices Ignore entries that are not found</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ids</span>
      
      
        <span class='type'>(<tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The IDs to remove</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="UpstreamRule.html" title="Rex::Proto::DNS::UpstreamRule (class)">UpstreamRule</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The removed entries</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_ids'>remove_ids</span><span class='lparen'>(</span><span class='id identifier rubyid_ids'>ids</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_removed'>removed</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
    <span class='id identifier rubyid_upstream_rule'>upstream_rule</span> <span class='op'>=</span> <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_removed'>removed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span> <span class='kw'>if</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_removed'>removed</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reorder_ids-instance_method">
  
    #<strong>reorder_ids</strong>(ids, new_id)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="UpstreamRule.html" title="Rex::Proto::DNS::UpstreamRule (class)">UpstreamRule</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Move upstream rules with the given indices into the location provided. If multiple IDs are provided, they will all be inserted into the provided location, in the order provided. Ignore entries that are not found</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ids</span>
      
      
        <span class='type'>(<tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The IDs to move</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>insertion_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ID to insert the entries at (in the order provided), or -1 to insert at the end</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="UpstreamRule.html" title="Rex::Proto::DNS::UpstreamRule (class)">UpstreamRule</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The moved entries</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reorder_ids'>reorder_ids</span><span class='lparen'>(</span><span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_new_id'>new_id</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_new_id'>new_id</span> <span class='op'>==</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_new_id'>new_id</span> <span class='op'>=</span> <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_new_id'>new_id</span> <span class='op'>&gt;</span> <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Insertion ID is past the end of the ruleset</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_to_move'>to_move</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_to_subtract'>to_subtract</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='comment'># Get the entries before we delete (gets too complicated with indices changing otherwise)
</span>  <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
    <span class='id identifier rubyid_upstream_rule'>upstream_rule</span> <span class='op'>=</span> <span class='ivar'>@upstream_rules</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_to_move'>to_move</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_new_id'>new_id</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_id'>id</span>
        <span class='id identifier rubyid_to_subtract'>to_subtract</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='comment'># Adjust for the fact that are about to delete one, so the indices would be off-by-one after that index is deleted
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_new_id'>new_id</span> <span class='op'>-=</span> <span class='id identifier rubyid_to_subtract'>to_subtract</span>

  <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
    <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_to_move'>to_move</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
    <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_new_id'>new_id</span><span class='comma'>,</span> <span class='id identifier rubyid_rule'>rule</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_to_move'>to_move</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save_config-instance_method">
  
    #<strong>save_config</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Save the custom settings to the MSF config file</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_config'>save_config</span>
  <span class='id identifier rubyid_new_config'>new_config</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>configuration_version</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><span class='object_link'><a href="#CONFIG_VERSION-constant" title="Rex::Proto::DNS::CustomNameserverProvider::CONFIG_VERSION (constant)">CONFIG_VERSION</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='rbrace'>}</span>
  <span class='const'><span class='object_link'><a href="../../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Msf/Config.html" title="Msf::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_save'><span class='object_link'><a href="../../../Msf/Config.html#save-class_method" title="Msf::Config.save (method)">save</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CONFIG_KEY_BASE-constant" title="Rex::Proto::DNS::CustomNameserverProvider::CONFIG_KEY_BASE (constant)">CONFIG_KEY_BASE</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_new_config'>new_config</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_save_config_upstream_rules'>save_config_upstream_rules</span>
  <span class='id identifier rubyid_save_config_static_hostnames'>save_config_static_hostnames</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_framework-instance_method">
  
    #<strong>set_framework</strong>(framework)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 232</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_framework'>set_framework</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_feature_set'>feature_set</span> <span class='op'>=</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upstream_resolvers_for_packet-instance_method">
  
    #<strong>upstream_resolvers_for_packet</strong>(packet)  &#x21d2; <tt>Array&lt;Array&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The nameservers that match the given packet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>packet</span>
      
      
        <span class='type'>(<tt>Dnsruby::Message</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The DNS packet to be sent</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A list of nameservers, each with Rex::Socket options</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ResolveError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the packet contains multiple questions, which would end up sending to a different set of nameservers</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 199</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upstream_resolvers_for_packet'>upstream_resolvers_for_packet</span><span class='lparen'>(</span><span class='id identifier rubyid_packet'>packet</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_feature_set'>feature_set</span><span class='period'>.</span><span class='id identifier rubyid_enabled?'>enabled?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Msf/FeatureManager.html" title="Msf::FeatureManager (class)">FeatureManager</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Msf/FeatureManager.html#DNS-constant" title="Msf::FeatureManager::DNS (constant)">DNS</a></span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>super</span>
  <span class='kw'>end</span>
  <span class='comment'># Leaky abstraction: a packet could have multiple question entries,
</span>  <span class='comment'># and each of these could have different nameservers, or travel via
</span>  <span class='comment'># different comm channels. We can&#39;t allow DNS leaks, so for now, we
</span>  <span class='comment'># will throw an error here.
</span>  <span class='id identifier rubyid_results_from_all_questions'>results_from_all_questions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_question'>question</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_question'>question</span><span class='op'>|</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_question'>question</span><span class='period'>.</span><span class='id identifier rubyid_qname'>qname</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_upstream_rule'>upstream_rule</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_upstream_rules'>upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ur'>ur</span><span class='op'>|</span> <span class='id identifier rubyid_ur'>ur</span><span class='period'>.</span><span class='id identifier rubyid_matches_name?'>matches_name?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span>
      <span class='id identifier rubyid_upstream_resolvers'>upstream_resolvers</span> <span class='op'>=</span> <span class='id identifier rubyid_upstream_rule'>upstream_rule</span><span class='period'>.</span><span class='id identifier rubyid_resolvers'>resolvers</span>
    <span class='kw'>else</span>
      <span class='comment'># Fall back to default nameservers
</span>      <span class='id identifier rubyid_upstream_resolvers'>upstream_resolvers</span> <span class='op'>=</span> <span class='kw'>super</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_results_from_all_questions'>results_from_all_questions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_upstream_resolvers'>upstream_resolvers</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_results_from_all_questions'>results_from_all_questions</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_results_from_all_questions'>results_from_all_questions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ResolverError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Inconsistent nameserver entries attempted to be sent in the one packet</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_results_from_all_questions'>results_from_all_questions</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upstream_rules-instance_method">
  
    #<strong>upstream_rules</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


236
237
238</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/proto/dns/custom_nameserver_provider.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upstream_rules'>upstream_rules</span>
  <span class='ivar'>@upstream_rules</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan 29 04:41:50 2026 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>