<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Post::Meterpreter::Extensions::Extapi::Adsi::Adsi
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Post::Meterpreter::Extensions::Extapi::Adsi::Adsi";
  relpath = '../../../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Extensions.html" title="Rex::Post::Meterpreter::Extensions (module)">Extensions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Extapi.html" title="Rex::Post::Meterpreter::Extensions::Extapi (module)">Extapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Adsi.html" title="Rex::Post::Meterpreter::Extensions::Extapi::Adsi (module)">Adsi</a></span></span>
     &raquo; 
    <span class="title">Adsi</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Post::Meterpreter::Extensions::Extapi::Adsi::Adsi
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Post::Meterpreter::Extensions::Extapi::Adsi::Adsi</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This meterpreter extension contains extended API functions for querying and managing desktop windows.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#client-instance_method" title="#client (instance method)">#<strong>client</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute client.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#domain_query-instance_method" title="#domain_query (instance method)">#<strong>domain_query</strong>(domain_name, filter, max_results, page_size, fields)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Perform a generic domain query against ADSI.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#extract_results-instance_method" title="#extract_results (instance method)">#<strong>extract_results</strong>(response)  &#x21d2; Array[Array[[Hash]]] Collection of results from the ADSI query. </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieve the results of the query from the response   packet that was returned from Meterpreter.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#extract_value-instance_method" title="#extract_value (instance method)">#<strong>extract_value</strong>(v)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert a single ADSI result value into a usable   value that also describes its type.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#extract_values-instance_method" title="#extract_values (instance method)">#<strong>extract_values</strong>(tlv_container)  &#x21d2; Array[Hash] </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Extract a single row of results from a TLV group.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(client)  &#x21d2; Adsi </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Adsi.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(client)  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Extensions::Extapi::Adsi::Adsi (class)">Adsi</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Adsi.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_client'>client</span><span class='rparen'>)</span>
  <span class='ivar'>@client</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="client=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="client-instance_method">
  
    #<strong>client</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute client.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_client'>client</span>
  <span class='ivar'>@client</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="domain_query-instance_method">
  
    #<strong>domain_query</strong>(domain_name, filter, max_results, page_size, fields)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Perform a generic domain query against ADSI.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>domain_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The FQDN of the target domain.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>filter</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The filter to apply to the query in LDAP format.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_results</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of results to return.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>page_size</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The size of the page of results to return.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>fields</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of string fields to return for each result found</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Array of field names with associated results.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_domain_query'>domain_query</span><span class='lparen'>(</span><span class='id identifier rubyid_domain_name'>domain_name</span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span><span class='comma'>,</span> <span class='id identifier rubyid_max_results'>max_results</span><span class='comma'>,</span> <span class='id identifier rubyid_page_size'>page_size</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Packet.html" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create_request'><span class='object_link'><a href="../../../Packet.html#create_request-class_method" title="Rex::Post::Meterpreter::Packet.create_request (method)">create_request</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#COMMAND_ID_EXTAPI_ADSI_DOMAIN_QUERY-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::COMMAND_ID_EXTAPI_ADSI_DOMAIN_QUERY (constant)">COMMAND_ID_EXTAPI_ADSI_DOMAIN_QUERY</a></span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_DOMAIN-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_DOMAIN (constant)">TLV_TYPE_EXT_ADSI_DOMAIN</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_domain_name'>domain_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_FILTER-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_FILTER (constant)">TLV_TYPE_EXT_ADSI_FILTER</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_filter'>filter</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_MAXRESULTS-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_MAXRESULTS (constant)">TLV_TYPE_EXT_ADSI_MAXRESULTS</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_max_results'>max_results</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_PAGESIZE-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_PAGESIZE (constant)">TLV_TYPE_EXT_ADSI_PAGESIZE</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_page_size'>page_size</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_add_tlv'>add_tlv</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_FIELD-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_FIELD (constant)">TLV_TYPE_EXT_ADSI_FIELD</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_results'>extract_results</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='lbrace'>{</span>
    <span class='symbol'>:fields</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_fields'>fields</span><span class='comma'>,</span>
    <span class='symbol'>:results</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_results'>results</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_results-instance_method">
  
    #<strong>extract_results</strong>(response)  &#x21d2; <tt>Array[Array[[Hash]]] Collection of results from
the ADSI query.</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Retrieve the results of the query from the response</p>

<pre class="code ruby"><code class="ruby">packet that was returned from Meterpreter.
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>response</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Packet.html" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Reference to the received packet that was returned from Meterpreter.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array[Array[[Hash]]] Collection of results from
the ADSI query.</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p><a href="Hash">Array[Array[</a>]] Collection of results from the ADSI query.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 73</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_results'>extract_results</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_RESULT-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_RESULT (constant)">TLV_TYPE_EXT_ADSI_RESULT</a></span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_extract_values'>extract_values</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_results'>results</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_value-instance_method">
  
    #<strong>extract_value</strong>(v)  &#x21d2; <tt>Hash</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert a single ADSI result value into a usable</p>

<pre class="code ruby"><code class="ruby">value that also describes its type.
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>v</span>
      
      
        <span class='type'>(<tt>TLV</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The TLV item that contains the value.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type/value pair from the TLV.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 108</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_value'>extract_value</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='symbol'>:unknown</span>
  <span class='rbrace'>}</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_STRING-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_STRING (constant)">TLV_TYPE_EXT_ADSI_STRING</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>  <span class='op'>=&gt;</span> <span class='symbol'>:string</span><span class='comma'>,</span>
      <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_NUMBER-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_NUMBER (constant)">TLV_TYPE_EXT_ADSI_NUMBER</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_BIGNUMBER-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_BIGNUMBER (constant)">TLV_TYPE_EXT_ADSI_BIGNUMBER</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>  <span class='op'>=&gt;</span> <span class='symbol'>:number</span><span class='comma'>,</span>
      <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_BOOL-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_BOOL (constant)">TLV_TYPE_EXT_ADSI_BOOL</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>  <span class='op'>=&gt;</span> <span class='symbol'>:bool</span><span class='comma'>,</span>
      <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_RAW-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_RAW (constant)">TLV_TYPE_EXT_ADSI_RAW</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>  <span class='op'>=&gt;</span> <span class='symbol'>:raw</span><span class='comma'>,</span>
      <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_ARRAY-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_ARRAY (constant)">TLV_TYPE_EXT_ADSI_ARRAY</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>  <span class='op'>=&gt;</span> <span class='symbol'>:array</span><span class='comma'>,</span>
      <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_extract_values'>extract_values</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_PATH-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_PATH (constant)">TLV_TYPE_EXT_ADSI_PATH</a></span></span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>     <span class='op'>=&gt;</span> <span class='symbol'>:path</span><span class='comma'>,</span>
      <span class='symbol'>:volume</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_PATH_VOL-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_PATH_VOL (constant)">TLV_TYPE_EXT_ADSI_PATH_VOL</a></span></span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='symbol'>:path</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_PATH_PATH-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_PATH_PATH (constant)">TLV_TYPE_EXT_ADSI_PATH_PATH</a></span></span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='symbol'>:vol_type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_get_tlv_value'>get_tlv_value</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_PATH_TYPE-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_PATH_TYPE (constant)">TLV_TYPE_EXT_ADSI_PATH_TYPE</a></span></span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_DN-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_DN (constant)">TLV_TYPE_EXT_ADSI_DN</a></span></span>
    <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_get_tlvs'>get_tlvs</span><span class='lparen'>(</span><span class='const'>TLV_TYPE_ALL</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='symbol'>:type</span>   <span class='op'>=&gt;</span> <span class='symbol'>:dn</span><span class='comma'>,</span>
      <span class='symbol'>:label</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../../Extapi.html#TLV_TYPE_EXT_ADSI_STRING-constant" title="Rex::Post::Meterpreter::Extensions::Extapi::TLV_TYPE_EXT_ADSI_STRING (constant)">TLV_TYPE_EXT_ADSI_STRING</a></span></span>
      <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='symbol'>:string</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='symbol'>:raw</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_values-instance_method">
  
    #<strong>extract_values</strong>(tlv_container)  &#x21d2; <tt>Array[Hash]</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Extract a single row of results from a TLV group.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tlv_container</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Packet.html" title="Rex::Post::Meterpreter::Packet (class)">Packet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Reference to the TLV group to pull the values from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array[Hash]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Collection of values from the single ADSI query result row.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/extapi/adsi/adsi.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_values'>extract_values</span><span class='lparen'>(</span><span class='id identifier rubyid_tlv_container'>tlv_container</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tlv_container'>tlv_container</span><span class='period'>.</span><span class='id identifier rubyid_get_tlvs'>get_tlvs</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../../Meterpreter.html#TLV_TYPE_ANY-constant" title="Rex::Post::Meterpreter::TLV_TYPE_ANY (constant)">TLV_TYPE_ANY</a></span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_values'>values</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_extract_value'>extract_value</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_values'>values</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Mar 31 00:34:00 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>