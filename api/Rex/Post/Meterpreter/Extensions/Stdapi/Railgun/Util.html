<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util";
  relpath = '../../../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../../../_index.html">Index (U)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Extensions.html" title="Rex::Post::Meterpreter::Extensions (module)">Extensions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Stdapi.html" title="Rex::Post::Meterpreter::Extensions::Stdapi (module)">Stdapi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Railgun.html" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun (module)">Railgun</a></span></span>
     &raquo; 
    <span class="title">Util</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="LibraryHelper.html" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper (module)">LibraryHelper</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Utility methods and constants for dealing with most types of variables.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="PRIMITIVE_TYPE_SIZES-constant" class="">PRIMITIVE_TYPE_SIZES =
          <div class="docstring">
  <div class="discussion">
    
<p>Data type size info: <a href="http://msdn.microsoft.com/en-us/library/s3f49ktz(v=vs.80).aspx">msdn.microsoft.com/en-us/library/s3f49ktz(v=vs.80).aspx</a></p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='symbol'>:int</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:__int8</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbol'>:__int16</span> <span class='op'>=&gt;</span> <span class='int'>2</span><span class='comma'>,</span>
  <span class='symbol'>:__int32</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:__int64</span> <span class='op'>=&gt;</span> <span class='int'>8</span><span class='comma'>,</span>
  <span class='symbol'>:bool</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbol'>:char</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='comma'>,</span>
  <span class='symbol'>:short</span> <span class='op'>=&gt;</span> <span class='int'>2</span><span class='comma'>,</span>
  <span class='symbol'>:long</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:long_long</span> <span class='op'>=&gt;</span> <span class='int'>8</span><span class='comma'>,</span>
  <span class='symbol'>:float</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='comma'>,</span>
  <span class='symbol'>:double</span> <span class='op'>=&gt;</span> <span class='int'>8</span><span class='comma'>,</span>
  <span class='symbol'>:long_double</span> <span class='op'>=&gt;</span> <span class='int'>8</span><span class='comma'>,</span>
  <span class='symbol'>:wchar_t</span> <span class='op'>=&gt;</span> <span class='int'>2</span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="TYPE_DEFINITIONS-constant" class="">TYPE_DEFINITIONS =
          <div class="docstring">
  <div class="discussion">
    
<p>Maps a data type to its corresponding primitive or special type <code>:pointer</code>.  Note, primitive types are mapped to themselves.</p>

<p>typedef info: <a href="http://msdn.microsoft.com/en-us/library/aa383751(v=vs.85).aspx">msdn.microsoft.com/en-us/library/aa383751(v=vs.85).aspx</a></p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='comment'>##
</span>  <span class='comment'># Primitives
</span>  <span class='comment'>##
</span>  <span class='symbol'>:int</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='symbol'>:__int8</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int8</span><span class='comma'>,</span>
  <span class='symbol'>:__int16</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int16</span><span class='comma'>,</span>
  <span class='symbol'>:__int32</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int32</span><span class='comma'>,</span>
  <span class='symbol'>:__int64</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int64</span><span class='comma'>,</span>
  <span class='symbol'>:bool</span> <span class='op'>=&gt;</span> <span class='symbol'>:bool</span><span class='comma'>,</span>
  <span class='symbol'>:char</span> <span class='op'>=&gt;</span> <span class='symbol'>:char</span><span class='comma'>,</span>
  <span class='symbol'>:short</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='symbol'>:long</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='symbol'>:long_long</span> <span class='op'>=&gt;</span> <span class='symbol'>:long_long</span><span class='comma'>,</span>
  <span class='symbol'>:float</span> <span class='op'>=&gt;</span> <span class='symbol'>:float</span><span class='comma'>,</span>
  <span class='symbol'>:double</span> <span class='op'>=&gt;</span> <span class='symbol'>:double</span><span class='comma'>,</span>
  <span class='symbol'>:long_double</span> <span class='op'>=&gt;</span> <span class='symbol'>:long_double</span><span class='comma'>,</span>
  <span class='symbol'>:wchar_t</span> <span class='op'>=&gt;</span> <span class='symbol'>:wchar_t</span><span class='comma'>,</span>
  <span class='comment'>##
</span>  <span class='comment'># Non-pointers
</span>  <span class='comment'>##
</span>  <span class='comment'>#typedef WORD ATOM;
</span>  <span class='symbol'>:ATOM</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='comment'>#typedef int BOOL;
</span>  <span class='symbol'>:BOOL</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef BYTE BOOLEAN;
</span>  <span class='symbol'>:BOOLEAN</span> <span class='op'>=&gt;</span> <span class='symbol'>:char</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned char BYTE;
</span>  <span class='symbol'>:BYTE</span> <span class='op'>=&gt;</span> <span class='symbol'>:char</span><span class='comma'>,</span>
  <span class='comment'>#typedef char CHAR;
</span>  <span class='symbol'>:CHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:char</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD COLORREF;
</span>  <span class='symbol'>:COLORREF</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned long DWORD;
</span>  <span class='symbol'>:DWORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned int DWORD32;
</span>  <span class='symbol'>:DWORD32</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned __int64 DWORD64;
</span>  <span class='symbol'>:DWORD64</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int64</span><span class='comma'>,</span>
  <span class='comment'>#typedef float FLOAT;
</span>  <span class='symbol'>:FLOAT</span> <span class='op'>=&gt;</span> <span class='symbol'>:float</span><span class='comma'>,</span>
  <span class='comment'>#typedef int HFILE;
</span>  <span class='symbol'>:HFILE</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONG HRESULT;
</span>  <span class='symbol'>:HRESULT</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef int INT;
</span>  <span class='symbol'>:INT</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef signed int INT32;
</span>  <span class='symbol'>:INT32</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef signed __int64 INT64;
</span>  <span class='symbol'>:INT64</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int64</span><span class='comma'>,</span>
  <span class='comment'>#typedef WORD LANGID;
</span>  <span class='symbol'>:LANGID</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD LCID;
</span>  <span class='symbol'>:LCID</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD LCTYPE;
</span>  <span class='symbol'>:LCTYPE</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD LGRPID;
</span>  <span class='symbol'>:LGRPID</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef long LONG;
</span>  <span class='symbol'>:LONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef signed int LONG32;
</span>  <span class='symbol'>:LONG32</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef __int64 LONG64;
</span>  <span class='symbol'>:LONG64</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int64</span><span class='comma'>,</span>
  <span class='comment'>#typedef PDWORD PLCID;
</span>  <span class='symbol'>:PLCID</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LPVOID SC_LOCK;
</span>  <span class='symbol'>:SC_LOCK</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef short SHORT;
</span>  <span class='symbol'>:SHORT</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned char UCHAR;
</span>  <span class='symbol'>:UCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:char</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned int UINT;
</span>  <span class='symbol'>:UINT</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned int UINT32;
</span>  <span class='symbol'>:UINT32</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned long ULONG;
</span>  <span class='symbol'>:ULONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:long</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned int ULONG32;
</span>  <span class='symbol'>:ULONG32</span> <span class='op'>=&gt;</span> <span class='symbol'>:int</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned __int64 ULONG64;
</span>  <span class='symbol'>:ULONG64</span> <span class='op'>=&gt;</span> <span class='symbol'>:__int64</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned short USHORT;
</span>  <span class='symbol'>:USHORT</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='comment'>#typedef wchar_t WCHAR;
</span>  <span class='symbol'>:WCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:wchar_t</span><span class='comma'>,</span>
  <span class='comment'>#typedef unsigned short WORD;
</span>  <span class='symbol'>:WORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:short</span><span class='comma'>,</span>
  <span class='comment'>##
</span>  <span class='comment'># Pointers declared with *
</span>  <span class='comment'>##
</span>  <span class='comment'>#typedef DWORD* LPCOLORREF;
</span>  <span class='symbol'>:LPCOLORREF</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef void* LPCVOID;
</span>  <span class='symbol'>:LPCVOID</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WCHAR* LPCWSTR;
</span>  <span class='symbol'>:LPCWSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD* LPDWORD;
</span>  <span class='symbol'>:LPDWORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE* LPHANDLE;
</span>  <span class='symbol'>:LPHANDLE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef int* LPINT;
</span>  <span class='symbol'>:LPINT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef long* LPLONG;
</span>  <span class='symbol'>:LPLONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef CHAR* LPSTR;
</span>  <span class='symbol'>:LPSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef void* LPVOID;
</span>  <span class='symbol'>:LPVOID</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WORD* LPWORD;
</span>  <span class='symbol'>:LPWORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WCHAR* LPWSTR;
</span>  <span class='symbol'>:LPWSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef BOOL* PBOOL;
</span>  <span class='symbol'>:PBOOL</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef BOOLEAN* PBOOLEAN;
</span>  <span class='symbol'>:PBOOLEAN</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef BYTE* PBYTE;
</span>  <span class='symbol'>:PBYTE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef CHAR* PCHAR;
</span>  <span class='symbol'>:PCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef CHAR* PCSTR;
</span>  <span class='symbol'>:PCSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WCHAR* PCWSTR;
</span>  <span class='symbol'>:PCWSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD* PDWORD;
</span>  <span class='symbol'>:PDWORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORDLONG* PDWORDLONG;
</span>  <span class='symbol'>:PDWORDLONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD_PTR* PDWORD_PTR;
</span>  <span class='symbol'>:PDWORD_PTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD32* PDWORD32;
</span>  <span class='symbol'>:PDWORD32</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef DWORD64* PDWORD64;
</span>  <span class='symbol'>:PDWORD64</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef FLOAT* PFLOAT;
</span>  <span class='symbol'>:PFLOAT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE* PHANDLE;
</span>  <span class='symbol'>:PHANDLE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HKEY* PHKEY;
</span>  <span class='symbol'>:PHKEY</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef int* PINT;
</span>  <span class='symbol'>:PINT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef INT_PTR* PINT_PTR;
</span>  <span class='symbol'>:PINT_PTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef INT32* PINT32;
</span>  <span class='symbol'>:PINT32</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef INT64* PINT64;
</span>  <span class='symbol'>:PINT64</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONG* PLONG;
</span>  <span class='symbol'>:PLONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONGLONG* PLONGLONG;
</span>  <span class='symbol'>:PLONGLONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONG_PTR* PLONG_PTR;
</span>  <span class='symbol'>:PLONG_PTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONG32* PLONG32;
</span>  <span class='symbol'>:PLONG32</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef LONG64* PLONG64;
</span>  <span class='symbol'>:PLONG64</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef SHORT* PSHORT;
</span>  <span class='symbol'>:PSHORT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef SIZE_T* PSIZE_T;
</span>  <span class='symbol'>:PSIZE_T</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef SSIZE_T* PSSIZE_T;
</span>  <span class='symbol'>:PSSIZE_T</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef CHAR* PSTR;
</span>  <span class='symbol'>:PSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef TBYTE* PTBYTE;
</span>  <span class='symbol'>:PTBYTE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef TCHAR* PTCHAR;
</span>  <span class='symbol'>:PTCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef UCHAR* PUCHAR;
</span>  <span class='symbol'>:PUCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef UINT* PUINT;
</span>  <span class='symbol'>:PUINT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef UINT_PTR* PUINT_PTR;
</span>  <span class='symbol'>:PUINT_PTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef UINT32* PUINT32;
</span>  <span class='symbol'>:PUINT32</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef UINT64* PUINT64;
</span>  <span class='symbol'>:PUINT64</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef ULONG* PULONG;
</span>  <span class='symbol'>:PULONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef ULONGLONG* PULONGLONG;
</span>  <span class='symbol'>:PULONGLONG</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef ULONG_PTR* PULONG_PTR;
</span>  <span class='symbol'>:PULONG_PTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef ULONG32* PULONG32;
</span>  <span class='symbol'>:PULONG32</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef ULONG64* PULONG64;
</span>  <span class='symbol'>:PULONG64</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef USHORT* PUSHORT;
</span>  <span class='symbol'>:PUSHORT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef void* PVOID;
</span>  <span class='symbol'>:PVOID</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WCHAR* PWCHAR;
</span>  <span class='symbol'>:PWCHAR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WORD* PWORD;
</span>  <span class='symbol'>:PWORD</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef WCHAR* PWSTR;
</span>  <span class='symbol'>:PWSTR</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HACCEL;
</span>  <span class='symbol'>:HACCEL</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>##
</span>  <span class='comment'>#  Handles
</span>  <span class='comment'>##
</span>  <span class='comment'>#typedef PVOID HANDLE;
</span>  <span class='symbol'>:HANDLE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HBITMAP;
</span>  <span class='symbol'>:HBITMAP</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HBRUSH;
</span>  <span class='symbol'>:HBRUSH</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HCOLORSPACE;
</span>  <span class='symbol'>:HCOLORSPACE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HCONV;
</span>  <span class='symbol'>:HCONV</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HCONVLIST;
</span>  <span class='symbol'>:HCONVLIST</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HDC;
</span>  <span class='symbol'>:HDC</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HDDEDATA;
</span>  <span class='symbol'>:HDDEDATA</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HDESK;
</span>  <span class='symbol'>:HDESK</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HDROP;
</span>  <span class='symbol'>:HDROP</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HDWP;
</span>  <span class='symbol'>:HDWP</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HENHMETAFILE;
</span>  <span class='symbol'>:HENHMETAFILE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HFONT;
</span>  <span class='symbol'>:HFONT</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HGDIOBJ;
</span>  <span class='symbol'>:HGDIOBJ</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HGLOBAL;
</span>  <span class='symbol'>:HGLOBAL</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HHOOK;
</span>  <span class='symbol'>:HHOOK</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HICON;
</span>  <span class='symbol'>:HICON</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HINSTANCE;
</span>  <span class='symbol'>:HINSTANCE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HKEY;
</span>  <span class='symbol'>:HKEY</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HKL;
</span>  <span class='symbol'>:HKL</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HLOCAL;
</span>  <span class='symbol'>:HLOCAL</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HMENU;
</span>  <span class='symbol'>:HMENU</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HMETAFILE;
</span>  <span class='symbol'>:HMETAFILE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HPALETTE;
</span>  <span class='symbol'>:HPALETTE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HPEN;
</span>  <span class='symbol'>:HPEN</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HRGN;
</span>  <span class='symbol'>:HRGN</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HRSRC;
</span>  <span class='symbol'>:HRSRC</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HSZ;
</span>  <span class='symbol'>:HSZ</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE WINSTA;
</span>  <span class='symbol'>:WINSTA</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE HWND;
</span>  <span class='symbol'>:HWND</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE SC_HANDLE;
</span>  <span class='symbol'>:SC_HANDLE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
  <span class='comment'>#typedef HANDLE SERVICE_STATUS_HANDLE;
</span>  <span class='symbol'>:SERVICE_STATUS_HANDLE</span> <span class='op'>=&gt;</span> <span class='symbol'>:pointer</span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#is_64bit-instance_method" title="#is_64bit (instance method)">#<strong>is_64bit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute is_64bit.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#railgun-instance_method" title="#railgun (instance method)">#<strong>railgun</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute railgun.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#alloc_and_write_data-instance_method" title="#alloc_and_write_data (instance method)">#<strong>alloc_and_write_data</strong>(data)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#alloc_and_write_string-instance_method" title="#alloc_and_write_string (instance method)">#<strong>alloc_and_write_string</strong>(value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Write ASCII strings to memory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#alloc_and_write_wstring-instance_method" title="#alloc_and_write_wstring (instance method)">#<strong>alloc_and_write_wstring</strong>(value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Write Unicode strings to memory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#calc_padding-instance_method" title="#calc_padding (instance method)">#<strong>calc_padding</strong>(offset)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Number of bytes that needed to be added to be aligned.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#free_data-instance_method" title="#free_data (instance method)">#<strong>free_data</strong>(*ptrs)  &#x21d2; Object </a>
    

    
      (also: #free_wstring, #free_string)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(railgun, arch)  &#x21d2; Util </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>param ‘railgun’ is a Railgun instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_array_type%3F-instance_method" title="#is_array_type? (instance method)">#<strong>is_array_type?</strong>(type)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the given type represents an array of another type For example <a href="3">BYTE</a>, <a href="ENCRYPTED_PWLEN">BYTE</a>, or even <a href="23">PDWORD</a>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_null_pointer-instance_method" title="#is_null_pointer (instance method)">#<strong>is_null_pointer</strong>(pointer)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if <code>pointer</code> will be considered a ‘null’ pointer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_pointer_type%3F-instance_method" title="#is_pointer_type? (instance method)">#<strong>is_pointer_type?</strong>(type)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the data type is a pointer, false otherwise.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_struct_type%3F-instance_method" title="#is_struct_type? (instance method)">#<strong>is_struct_type?</strong>(type)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the type passed describes a data structure, false otherwise.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#judge_bit_field-instance_method" title="#judge_bit_field (instance method)">#<strong>judge_bit_field</strong>(value, mappings)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Evaluates a bit field, returning a hash representing the meaning and state of each bit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#memread-instance_method" title="#memread (instance method)">#<strong>memread</strong>(address, size, buffer = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read a given number of bytes from memory or from a provided buffer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pointer_size-instance_method" title="#pointer_size (instance method)">#<strong>pointer_size</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the pointer size for this architecture.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_array-instance_method" title="#read_array (instance method)">#<strong>read_array</strong>(type, length, bufptr, buffer = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read <code>length</code> number of instances of <code>type</code> from <code>bufptr</code> .</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_data-instance_method" title="#read_data (instance method)">#<strong>read_data</strong>(type, position, buffer = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reads data structures and several windows data types.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_pointer-instance_method" title="#read_pointer (instance method)">#<strong>read_pointer</strong>(buffer, offset = 0)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read and unpack a pointer from the given buffer at a given offset.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_string-instance_method" title="#read_string (instance method)">#<strong>read_string</strong>(pointer, length = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reads null-terminated ASCII strings from memory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_struct-instance_method" title="#read_struct (instance method)">#<strong>read_struct</strong>(definition, buffer, offset = 0)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Construct the data structure described in <code>definition</code> from <code>buffer</code> starting from the index <code>offset</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_wstring-instance_method" title="#read_wstring (instance method)">#<strong>read_wstring</strong>(pointer, length = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reads null-terminated unicode strings from memory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#required_alignment-instance_method" title="#required_alignment (instance method)">#<strong>required_alignment</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p><a href="http://en.wikipedia.org/wiki/Data_structure_alignment">en.wikipedia.org/wiki/Data_structure_alignment</a>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sizeof_struct-instance_method" title="#sizeof_struct (instance method)">#<strong>sizeof_struct</strong>(struct)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculates the size of <code>struct</code> after alignment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sizeof_type-instance_method" title="#sizeof_type (instance method)">#<strong>sizeof_type</strong>(type)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the size, in bytes, of the given type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#split_array_type-instance_method" title="#split_array_type (instance method)">#<strong>split_array_type</strong>(type)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given an explicit array definition (e.g. <a href="23">BYTE</a>) return size (e.g. 23) and and <code>type</code> (e.g. BYTE).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#struct_offsets-instance_method" title="#struct_offsets (instance method)">#<strong>struct_offsets</strong>(definition, offset)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a description of a data structure, returns an Array containing the offset from the beginning for each subsequent element, taking into consideration alignment and padding.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unpack_pointer-instance_method" title="#unpack_pointer (instance method)">#<strong>unpack_pointer</strong>(packed_pointer)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a packed pointer, unpacks it according to architecture.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="LibraryHelper.html" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper (module)">LibraryHelper</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="LibraryHelper.html#asciiz_to_str-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#asciiz_to_str (method)">#asciiz_to_str</a></span>, <span class='object_link'><a href="LibraryHelper.html#assemble_buffer-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#assemble_buffer (method)">#assemble_buffer</a></span>, <span class='object_link'><a href="LibraryHelper.html#param_to_number-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#param_to_number (method)">#param_to_number</a></span>, <span class='object_link'><a href="LibraryHelper.html#str_to_ascii_z-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#str_to_ascii_z (method)">#str_to_ascii_z</a></span>, <span class='object_link'><a href="LibraryHelper.html#str_to_uni_z-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#str_to_uni_z (method)">#str_to_uni_z</a></span>, <span class='object_link'><a href="LibraryHelper.html#uniz_to_str-instance_method" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::LibraryHelper#uniz_to_str (method)">#uniz_to_str</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(railgun, arch)  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util (class)">Util</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>param ‘railgun’ is a Railgun instance. param ‘arch’ is the client.arch</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


317
318
319
320
321</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_railgun'>railgun</span><span class='comma'>,</span> <span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span>
  <span class='ivar'>@railgun</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span>
  <span class='ivar'>@is_64bit</span> <span class='op'>=</span> <span class='id identifier rubyid_arch'>arch</span> <span class='op'>==</span> <span class='const'>ARCH_X64</span>
  <span class='ivar'>@process_heap</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="is_64bit=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="is_64bit-instance_method">
  
    #<strong>is_64bit</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute is_64bit.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


712
713
714</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 712</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_64bit'>is_64bit</span>
  <span class='ivar'>@is_64bit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="railgun=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="railgun-instance_method">
  
    #<strong>railgun</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute railgun.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


712
713
714</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 712</span>

<span class='kw'>def</span> <span class='id identifier rubyid_railgun'>railgun</span>
  <span class='ivar'>@railgun</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="alloc_and_write_data-instance_method">
  
    #<strong>alloc_and_write_data</strong>(data)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


352
353
354
355
356
357
358
359
360
361
362</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 352</span>

<span class='kw'>def</span> <span class='id identifier rubyid_alloc_and_write_data'>alloc_and_write_data</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_process_heap'>process_heap</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_kernel32'>kernel32</span><span class='period'>.</span><span class='const'>HeapAlloc</span><span class='lparen'>(</span><span class='id identifier rubyid_process_heap'>process_heap</span><span class='comma'>,</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_const'>const</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HEAP_ZERO</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>return</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>return</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_memwrite'>memwrite</span><span class='lparen'>(</span><span class='id identifier rubyid_addr'>addr</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_addr'>addr</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="alloc_and_write_string-instance_method">
  
    #<strong>alloc_and_write_string</strong>(value)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Write ASCII strings to memory.</p>

<p>Given a  string, returns a pointer to a null terminated CHARs array. InitializeStr(&amp;Str,“string”);</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


420
421
422
423
424</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 420</span>

<span class='kw'>def</span> <span class='id identifier rubyid_alloc_and_write_string'>alloc_and_write_string</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_alloc_and_write_data'>alloc_and_write_data</span><span class='lparen'>(</span><span class='id identifier rubyid_str_to_ascii_z'>str_to_ascii_z</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="alloc_and_write_wstring-instance_method">
  
    #<strong>alloc_and_write_wstring</strong>(value)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Write Unicode strings to memory.</p>

<p>Given a string, returns a pointer to a null terminated WCHARs array.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


406
407
408
409
410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 406</span>

<span class='kw'>def</span> <span class='id identifier rubyid_alloc_and_write_wstring'>alloc_and_write_wstring</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_alloc_and_write_data'>alloc_and_write_data</span><span class='lparen'>(</span><span class='id identifier rubyid_str_to_uni_z'>str_to_uni_z</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="calc_padding-instance_method">
  
    #<strong>calc_padding</strong>(offset)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Number of bytes that needed to be added to be aligned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


658
659
660
661
662
663
664
665
666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 658</span>

<span class='kw'>def</span> <span class='id identifier rubyid_calc_padding'>calc_padding</span><span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_align'>align</span> <span class='op'>=</span> <span class='id identifier rubyid_required_alignment'>required_alignment</span>

  <span class='comment'># If offset is not aligned...
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>%</span> <span class='id identifier rubyid_align'>align</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='comment'># Calculate padding needed to be aligned
</span>    <span class='id identifier rubyid_align'>align</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_align'>align</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='int'>0</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="free_data-instance_method">
  
    #<strong>free_data</strong>(*ptrs)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='free_wstring-instance_method'>free_wstring</span>, <span id='free_string-instance_method'>free_string</span></span>
    </span>
  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


364
365
366
367
368
369
370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 364</span>

<span class='kw'>def</span> <span class='id identifier rubyid_free_data'>free_data</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_ptrs'>ptrs</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_ptrs'>ptrs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_process_heap'>process_heap</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_multi'>multi</span><span class='lparen'>(</span>
    <span class='id identifier rubyid_ptrs'>ptrs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ptr'>ptr</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>kernel32</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HeapFree</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_process_heap'>process_heap</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_ptr'>ptr</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='rparen'>)</span>
  <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>return</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_array_type?-instance_method">
  
    #<strong>is_array_type?</strong>(type)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the given type represents an array of another type For example <a href="3">BYTE</a>, <a href="ENCRYPTED_PWLEN">BYTE</a>, or even <a href="23">PDWORD</a></p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


565
566
567</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 565</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_array_type?'>is_array_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\w+\[\w+\]$</span><span class='regexp_end'>/</span></span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_null_pointer-instance_method">
  
    #<strong>is_null_pointer</strong>(pointer)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if <code>pointer</code> will be considered a ‘null’ pointer.</p>

<p>If <code>pointer</code> is nil or 0, returns true If <code>pointer</code> is a String, if 0 after unpacking, returns true false otherwise</p>

<p>See #unpack_pointer</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


344
345
346
347
348
349
350</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 344</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_null_pointer'>is_null_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_pointer'>pointer</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>String</span>
    <span class='id identifier rubyid_pointer'>pointer</span> <span class='op'>=</span> <span class='id identifier rubyid_unpack_pointer'>unpack_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_pointer'>pointer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_pointer'>pointer</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_pointer_type?-instance_method">
  
    #<strong>is_pointer_type?</strong>(type)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the data type is a pointer, false otherwise</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


559
560
561</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 559</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_pointer_type?'>is_pointer_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="#TYPE_DEFINITIONS-constant" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util::TYPE_DEFINITIONS (constant)">TYPE_DEFINITIONS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='symbol'>:pointer</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_struct_type?-instance_method">
  
    #<strong>is_struct_type?</strong>(type)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the type passed describes a data structure, false otherwise</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


570
571
572</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 570</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_struct_type?'>is_struct_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>Array</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="judge_bit_field-instance_method">
  
    #<strong>judge_bit_field</strong>(value, mappings)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Evaluates a bit field, returning a hash representing the meaning and state of each bit.</p>

<p>Parameters:</p>

<pre class="code ruby"><code class="ruby">+value+:: a bit field represented by a Integer
+mappings+:: { &#39;WINAPI_CONSTANT_NAME&#39; =&gt; :descriptive_symbol, ... }
</code></pre>

<p>Returns:</p>

<pre class="code ruby"><code class="ruby">{ :descriptive_symbol =&gt; true/false, ... }
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


700
701
702
703
704
705
706
707
708</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 700</span>

<span class='kw'>def</span> <span class='id identifier rubyid_judge_bit_field'>judge_bit_field</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_mappings'>mappings</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_mappings'>mappings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
    <span class='id identifier rubyid_flags'>flags</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_const'>const</span><span class='lparen'>(</span><span class='id identifier rubyid_constant_name'>constant_name</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_flags'>flags</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="memread-instance_method">
  
    #<strong>memread</strong>(address, size, buffer = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read a given number of bytes from memory or from a provided buffer.</p>

<p>If <code>buffer</code> is not provided, read <code>size</code> bytes from the client’s memory. If <code>buffer</code> is provided, reads <code>size</code> characters from the index of <code>address</code>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


454
455
456
457
458
459
460</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 454</span>

<span class='kw'>def</span> <span class='id identifier rubyid_memread'>memread</span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_memread'>memread</span><span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_address'>address</span> <span class='op'>..</span> <span class='lparen'>(</span><span class='id identifier rubyid_address'>address</span> <span class='op'>+</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pointer_size-instance_method">
  
    #<strong>pointer_size</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the pointer size for this architecture</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


576
577
578</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 576</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pointer_size'>pointer_size</span>
  <span class='id identifier rubyid_is_64bit'>is_64bit</span> <span class='op'>?</span> <span class='int'>8</span> <span class='op'>:</span> <span class='int'>4</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_array-instance_method">
  
    #<strong>read_array</strong>(type, length, bufptr, buffer = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read <code>length</code> number of instances of <code>type</code> from <code>bufptr</code> .</p>

<p><code>bufptr</code> is an index in <code>buffer</code> or, if <code>buffer</code> is nil, a memory address</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 519</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_array'>read_array</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_bufptr'>bufptr</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;=</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='comment'># Grab the bytes that the array consists of
</span>  <span class='id identifier rubyid_buffer'>buffer</span> <span class='op'>=</span> <span class='id identifier rubyid_memread'>memread</span><span class='lparen'>(</span><span class='id identifier rubyid_bufptr'>bufptr</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>*</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_upto'>upto</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_read_data'>read_data</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>+</span> <span class='id identifier rubyid_size'>size</span>

    <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_data-instance_method">
  
    #<strong>read_data</strong>(type, position, buffer = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reads data structures and several windows data types</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 472</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_data'>read_data</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_buffer'>buffer</span> <span class='op'>=</span> <span class='id identifier rubyid_memread'>memread</span><span class='lparen'>(</span><span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_position'>position</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='comment'># If we&#39;re asked to read a data structure, deligate to read_struct
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_is_struct_type?'>is_struct_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_read_struct'>read_struct</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='comma'>,</span> <span class='id identifier rubyid_position'>position</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If the type is an array with a given size...
</span>  <span class='comment'>#    BYTE[3] for example or BYTE[ENCRYPTED_PWLEN] or even PDWORD[23]
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_is_array_type?'>is_array_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='comment'># Separate the element type from the size of the array
</span>    <span class='id identifier rubyid_element_type'>element_type</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_split_array_type'>split_array_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>

    <span class='comment'># Have read_array take care of the rest
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_read_array'>read_array</span><span class='lparen'>(</span><span class='id identifier rubyid_element_type'>element_type</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raw'>raw</span>  <span class='op'>=</span> <span class='id identifier rubyid_memread'>memread</span><span class='lparen'>(</span><span class='id identifier rubyid_position'>position</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>

  <span class='comment'># read/unpack data for the types we have hard-coded support for
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
  <span class='kw'>when</span> <span class='symbol'>:LPWSTR</span>
    <span class='comment'># null-terminated string of 16-bit Unicode characters
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_read_wstring'>read_wstring</span><span class='lparen'>(</span><span class='id identifier rubyid_read_pointer'>read_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='symbol'>:DWORD</span>
    <span class='comment'># Both on x86 and x64, DWORD is 32 bits
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>when</span> <span class='symbol'>:BOOL</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='kw'>when</span> <span class='symbol'>:LONG</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>

  <span class='comment'>#If nothing worked thus far, return it raw
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_pointer-instance_method">
  
    #<strong>read_pointer</strong>(buffer, offset = 0)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read and unpack a pointer from the given buffer at a given offset</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


465
466
467</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 465</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_pointer'>read_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_unpack_pointer'>unpack_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_buffer'>buffer</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span> <span class='op'>+</span> <span class='id identifier rubyid_pointer_size'>pointer_size</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_string-instance_method">
  
    #<strong>read_string</strong>(pointer, length = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reads null-terminated ASCII strings from memory.</p>

<p>Given a pointer to a null terminated array of CHARs, return a ruby String. If <code>pointer</code> is NULL (see #is_null_pointer) returns an empty string.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


435
436
437
438
439
440
441
442
443
444
445
446</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 435</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_string'>read_string</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_is_null_pointer'>is_null_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_length'>length</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_kernel32'>kernel32</span><span class='period'>.</span><span class='id identifier rubyid_lstrlenA'>lstrlenA</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>return</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_chars'>chars</span> <span class='op'>=</span> <span class='id identifier rubyid_read_array'>read_array</span><span class='lparen'>(</span><span class='symbol'>:CHAR</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_chars'>chars</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_struct-instance_method">
  
    #<strong>read_struct</strong>(definition, buffer, offset = 0)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Construct the data structure described in <code>definition</code> from <code>buffer</code> starting from the index <code>offset</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


543
544
545
546
547
548
549
550
551
552
553
554
555</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 543</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_struct'>read_struct</span><span class='lparen'>(</span><span class='id identifier rubyid_definition'>definition</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_offsets'>offsets</span> <span class='op'>=</span> <span class='id identifier rubyid_struct_offsets'>struct_offsets</span><span class='lparen'>(</span><span class='id identifier rubyid_definition'>definition</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mapping'>mapping</span><span class='op'>|</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data_type'>data_type</span> <span class='op'>=</span> <span class='id identifier rubyid_mapping'>mapping</span>

    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_read_data'>read_data</span><span class='lparen'>(</span><span class='id identifier rubyid_data_type'>data_type</span><span class='comma'>,</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span><span class='comma'>,</span> <span class='id identifier rubyid_buffer'>buffer</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_wstring-instance_method">
  
    #<strong>read_wstring</strong>(pointer, length = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reads null-terminated unicode strings from memory.</p>

<p>Given a pointer to a null terminated array of WCHARs, return a ruby String. If <code>pointer</code> is NULL (see #is_null_pointer) returns an empty string.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 381</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_wstring'>read_wstring</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Return an empty string for null pointers
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_is_null_pointer'>is_null_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># If length not provided, use lstrlenW
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_kernel32'>kernel32</span><span class='period'>.</span><span class='id identifier rubyid_lstrlenW'>lstrlenW</span><span class='lparen'>(</span><span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>return</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Retrieve the array of characters
</span>  <span class='id identifier rubyid_chars'>chars</span> <span class='op'>=</span> <span class='id identifier rubyid_read_array'>read_array</span><span class='lparen'>(</span><span class='symbol'>:WCHAR</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_pointer'>pointer</span><span class='rparen'>)</span>

  <span class='comment'># Concatenate the characters and convert to a ruby string
</span>  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_uniz_to_str'>uniz_to_str</span><span class='lparen'>(</span><span class='id identifier rubyid_chars'>chars</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="required_alignment-instance_method">
  
    #<strong>required_alignment</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p><a href="http://en.wikipedia.org/wiki/Data_structure_alignment">en.wikipedia.org/wiki/Data_structure_alignment</a></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


651
652
653</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 651</span>

<span class='kw'>def</span> <span class='id identifier rubyid_required_alignment'>required_alignment</span>
  <span class='id identifier rubyid_is_64bit'>is_64bit</span> <span class='op'>?</span> <span class='int'>8</span> <span class='op'>:</span> <span class='int'>4</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sizeof_struct-instance_method">
  
    #<strong>sizeof_struct</strong>(struct)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculates the size of <code>struct</code> after alignment.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


619
620
621
622
623
624
625</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 619</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sizeof_struct'>sizeof_struct</span><span class='lparen'>(</span><span class='id identifier rubyid_struct'>struct</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_offsets'>offsets</span> <span class='op'>=</span> <span class='id identifier rubyid_struct_offsets'>struct_offsets</span><span class='lparen'>(</span><span class='id identifier rubyid_struct'>struct</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_last_data_size'>last_data_size</span> <span class='op'>=</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_struct'>struct</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_size_no_padding'>size_no_padding</span> <span class='op'>=</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>+</span> <span class='id identifier rubyid_last_data_size'>last_data_size</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_size_no_padding'>size_no_padding</span> <span class='op'>+</span> <span class='id identifier rubyid_calc_padding'>calc_padding</span><span class='lparen'>(</span><span class='id identifier rubyid_size_no_padding'>size_no_padding</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sizeof_type-instance_method">
  
    #<strong>sizeof_type</strong>(type)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the size, in bytes, of the given type</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 581</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_is_pointer_type?'>is_pointer_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_pointer_size'>pointer_size</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>String</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_is_array_type?'>is_array_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_element_type'>element_type</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_split_array_type'>split_array_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>*</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_element_type'>element_type</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_is_struct_type?'>is_struct_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_sizeof_struct'>sizeof_struct</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="#TYPE_DEFINITIONS-constant" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util::TYPE_DEFINITIONS (constant)">TYPE_DEFINITIONS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_primitive'>primitive</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#TYPE_DEFINITIONS-constant" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util::TYPE_DEFINITIONS (constant)">TYPE_DEFINITIONS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_primitive'>primitive</span> <span class='op'>==</span> <span class='symbol'>:pointer</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_pointer_size'>pointer_size</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="#PRIMITIVE_TYPE_SIZES-constant" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util::PRIMITIVE_TYPE_SIZES (constant)">PRIMITIVE_TYPE_SIZES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_primitive'>primitive</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="#PRIMITIVE_TYPE_SIZES-constant" title="Rex::Post::Meterpreter::Extensions::Stdapi::Railgun::Util::PRIMITIVE_TYPE_SIZES (constant)">PRIMITIVE_TYPE_SIZES</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_primitive'>primitive</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> was mapped to non-existent primitive </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_primitive'>primitive</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to determine size for type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="split_array_type-instance_method">
  
    #<strong>split_array_type</strong>(type)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given an explicit array definition (e.g. <a href="23">BYTE</a>) return size (e.g. 23) and and <code>type</code> (e.g. BYTE). If a constant is given, attempt to resolve it that constant.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


675
676
677
678
679
680
681
682
683
684
685
686
687</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 675</span>

<span class='kw'>def</span> <span class='id identifier rubyid_split_array_type'>split_array_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\w+)\[(\w+)\]$</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_element_type'>element_type</span> <span class='op'>=</span> <span class='backref'>$1</span>
    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='backref'>$2</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\d+$</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_railgun'>railgun</span><span class='period'>.</span><span class='id identifier rubyid_const'>const</span><span class='lparen'>(</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_element_type'>element_type</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='id identifier rubyid_length'>length</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Can not split non-array type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="struct_offsets-instance_method">
  
    #<strong>struct_offsets</strong>(definition, offset)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a description of a data structure, returns an Array containing the offset from the beginning for each subsequent element, taking into consideration alignment and padding.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 632</span>

<span class='kw'>def</span> <span class='id identifier rubyid_struct_offsets'>struct_offsets</span><span class='lparen'>(</span><span class='id identifier rubyid_definition'>definition</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_padding'>padding</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_offsets'>offsets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_definition'>definition</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mapping'>mapping</span><span class='op'>|</span>
    <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_data_type'>data_type</span> <span class='op'>=</span> <span class='id identifier rubyid_mapping'>mapping</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_data_type'>data_type</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_padding'>padding</span>
      <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>+</span> <span class='id identifier rubyid_padding'>padding</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_offsets'>offsets</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_offset'>offset</span> <span class='op'>=</span> <span class='id identifier rubyid_offset'>offset</span> <span class='op'>+</span> <span class='id identifier rubyid_sizeof_type'>sizeof_type</span><span class='lparen'>(</span><span class='id identifier rubyid_data_type'>data_type</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_padding'>padding</span> <span class='op'>=</span> <span class='id identifier rubyid_calc_padding'>calc_padding</span><span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_offsets'>offsets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unpack_pointer-instance_method">
  
    #<strong>unpack_pointer</strong>(packed_pointer)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a packed pointer, unpacks it according to architecture</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


326
327
328
329
330
331
332
333</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/extensions/stdapi/railgun/util.rb', line 326</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unpack_pointer'>unpack_pointer</span><span class='lparen'>(</span><span class='id identifier rubyid_packed_pointer'>packed_pointer</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_is_64bit'>is_64bit</span>
    <span class='comment'># Assume little endian
</span>    <span class='id identifier rubyid_packed_pointer'>packed_pointer</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Q&lt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_packed_pointer'>packed_pointer</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Oct 31 12:10:50 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>