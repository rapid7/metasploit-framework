<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Post::Meterpreter::Ui::Console::CommandDispatcher::Sniffer
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Post::Meterpreter::Ui::Console::CommandDispatcher::Sniffer";
  relpath = '../../../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Ui.html" title="Rex::Post::Meterpreter::Ui (module)">Ui</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Console.html" title="Rex::Post::Meterpreter::Ui::Console (class)">Console</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../CommandDispatcher.html" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher (module)">CommandDispatcher</a></span></span>
     &raquo; 
    <span class="title">Sniffer</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Post::Meterpreter::Ui::Console::CommandDispatcher::Sniffer
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Post::Meterpreter::Ui::Console::CommandDispatcher::Sniffer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../../../Extensions/Sniffer.html" title="Rex::Post::Meterpreter::Extensions::Sniffer (module)">Extensions::Sniffer</a></span>, <span class='object_link'><a href="../CommandDispatcher.html" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher (module)">Rex::Post::Meterpreter::Ui::Console::CommandDispatcher</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Packet sniffer extension user interface.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="Klass-constant" class="">Klass =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../../Console.html" title="Rex::Post::Meterpreter::Ui::Console (class)">Console</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../CommandDispatcher.html" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher (module)">CommandDispatcher</a></span></span><span class='op'>::</span><span class='const'>Sniffer</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../../../Extensions/Sniffer.html" title="Rex::Post::Meterpreter::Extensions::Sniffer (module)">Extensions::Sniffer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_DUMP-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_DUMP (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_DUMP</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_DUMP_READ-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_DUMP_READ (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_DUMP_READ</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_RELEASE-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_RELEASE (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_RELEASE</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_START-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_START (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_START</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_STATS-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_STATS (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_STATS</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_CAPTURE_STOP-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_STOP (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_CAPTURE_STOP</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#COMMAND_ID_SNIFFER_INTERFACES-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::COMMAND_ID_SNIFFER_INTERFACES (constant)">Extensions::Sniffer::COMMAND_ID_SNIFFER_INTERFACES</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#EXTENSION_ID_SNIFFER-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::EXTENSION_ID_SNIFFER (constant)">Extensions::Sniffer::EXTENSION_ID_SNIFFER</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_EXTENSION_SNIFFER-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_EXTENSION_SNIFFER (constant)">Extensions::Sniffer::TLV_TYPE_EXTENSION_SNIFFER</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_ADDITIONAL_FILTER-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_ADDITIONAL_FILTER (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_ADDITIONAL_FILTER</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_BYTE_COUNT-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_BYTE_COUNT (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_BYTE_COUNT</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_EXCLUDE_PORTS-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_EXCLUDE_PORTS (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_EXCLUDE_PORTS</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_INCLUDE_PORTS-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_INCLUDE_PORTS (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_INCLUDE_PORTS</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_INTERFACES-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACES (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACES</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_INTERFACE_HANDLE-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACE_HANDLE (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACE_HANDLE</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_INTERFACE_ID-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACE_ID (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_INTERFACE_ID</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_PACKET-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKET (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKET</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_PACKETS-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKETS (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKETS</a></span>, <span class='object_link'><a href="../../../Extensions/Sniffer.html#TLV_TYPE_SNIFFER_PACKET_COUNT-constant" title="Rex::Post::Meterpreter::Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKET_COUNT (constant)">Extensions::Sniffer::TLV_TYPE_SNIFFER_PACKET_COUNT</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher (module)">Ui::Text::DispatcherShell::CommandDispatcher</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#shell-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#shell (method)">#shell</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#tab_complete_items-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#tab_complete_items (method)">#tab_complete_items</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_dump-instance_method" title="#cmd_sniffer_dump (instance method)">#<strong>cmd_sniffer_dump</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_interfaces-instance_method" title="#cmd_sniffer_interfaces (instance method)">#<strong>cmd_sniffer_interfaces</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_release-instance_method" title="#cmd_sniffer_release (instance method)">#<strong>cmd_sniffer_release</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_start-instance_method" title="#cmd_sniffer_start (instance method)">#<strong>cmd_sniffer_start</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_stats-instance_method" title="#cmd_sniffer_stats (instance method)">#<strong>cmd_sniffer_stats</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cmd_sniffer_stop-instance_method" title="#cmd_sniffer_stop (instance method)">#<strong>cmd_sniffer_stop</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commands-instance_method" title="#commands (instance method)">#<strong>commands</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of supported commands.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(shell)  &#x21d2; Sniffer </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes an instance of the sniffer command interaction.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Name for this dispatcher sni.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../CommandDispatcher.html" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher (module)">Rex::Post::Meterpreter::Ui::Console::CommandDispatcher</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../CommandDispatcher.html#check_hash-class_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher.check_hash (method)">check_hash</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#client-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#client (method)">#client</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#docs_dir-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#docs_dir (method)">#docs_dir</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#filter_commands-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#filter_commands (method)">#filter_commands</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#log_error-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#log_error (method)">#log_error</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#msf_loaded%3F-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#msf_loaded? (method)">#msf_loaded?</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#set_hash-class_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher.set_hash (method)">set_hash</a></span>, <span class='object_link'><a href="../CommandDispatcher.html#unknown_command-instance_method" title="Rex::Post::Meterpreter::Ui::Console::CommandDispatcher#unknown_command (method)">#unknown_command</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher (module)">Ui::Text::DispatcherShell::CommandDispatcher</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#cmd_help-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#cmd_help (method)">#cmd_help</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#cmd_help_help-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#cmd_help_help (method)">#cmd_help_help</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#cmd_help_tabs-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#cmd_help_tabs (method)">#cmd_help_tabs</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#deprecated_cmd-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#deprecated_cmd (method)">#deprecated_cmd</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#deprecated_commands-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#deprecated_commands (method)">#deprecated_commands</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#deprecated_help-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#deprecated_help (method)">#deprecated_help</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#docs_dir-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#docs_dir (method)">#docs_dir</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#help_to_s-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#help_to_s (method)">#help_to_s</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print (method)">#print</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print_error-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print_good-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print_line-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print_status-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#print_warning-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#print_warning (method)">#print_warning</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#tab_complete_directory-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#tab_complete_directory (method)">#tab_complete_directory</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#tab_complete_filenames-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#tab_complete_filenames (method)">#tab_complete_filenames</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#tab_complete_generic-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#tab_complete_generic (method)">#tab_complete_generic</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#tab_complete_source_address-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#tab_complete_source_address (method)">#tab_complete_source_address</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#unknown_command-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#unknown_command (method)">#unknown_command</a></span>, <span class='object_link'><a href="../../../../../Ui/Text/DispatcherShell/CommandDispatcher.html#update_prompt-instance_method" title="Rex::Ui::Text::DispatcherShell::CommandDispatcher#update_prompt (method)">#update_prompt</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(shell)  &#x21d2; <tt><span class='object_link'><a href="../../../Extensions/Sniffer/Sniffer.html" title="Rex::Post::Meterpreter::Extensions::Sniffer::Sniffer (class)">Sniffer</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes an instance of the sniffer command interaction.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_shell'>shell</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cmd_sniffer_dump-instance_method">
  
    #<strong>cmd_sniffer_dump</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_dump'>cmd_sniffer_dump</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_intf'>intf</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span> <span class='op'>==</span> <span class='int'>0</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usage: sniffer_dump [interface-id] [pcap-file]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path_cap'>path_cap</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_path_raw'>path_raw</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.raw</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_path_raw'>path_raw</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb+</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Flushing packet capture buffer for interface </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_dump'>capture_dump</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Flushed </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:packets</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> packets (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_bytes_all'>bytes_all</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_bytes_got'>bytes_got</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_bytes_pct'>bytes_pct</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_linktype'>linktype</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:linktype</span><span class='rbracket'>]</span>
  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_bytes_all'>bytes_all</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_dump_read'>capture_dump_read</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='comma'>,</span><span class='int'>1024</span><span class='op'>*</span><span class='int'>512</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_bytes_got'>bytes_got</span> <span class='op'>+=</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_pct'>pct</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_bytes_got'>bytes_got</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_bytes_all'>bytes_all</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_pct'>pct</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_bytes_pct'>bytes_pct</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Downloaded </span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.3d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_pct'>pct</span><span class='embexpr_end'>}</span><span class='tstring_content'>% (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bytes_got'>bytes_got</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bytes_all'>bytes_all</span><span class='embexpr_end'>}</span><span class='tstring_content'>)...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_bytes_pct'>bytes_pct</span> <span class='op'>=</span> <span class='id identifier rubyid_pct'>pct</span>
    <span class='kw'>end</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_fd'>fd</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_fd'>fd</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>

  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Download completed, converting to PCAP...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path_cap'>path_cap</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_path_cap'>path_cap</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ab+</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_fd'>fd</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_path_cap'>path_cap</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb+</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fd'>fd</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>0xa1b2c3d4</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>4</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>65536</span><span class='comma'>,</span> <span class='id identifier rubyid_linktype'>linktype</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NnnNNNN</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_pkts'>pkts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_od'>od</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_path_raw'>path_raw</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>


  <span class='comment'># TODO: reorder packets based on the ID (only an issue if the buffer wraps)
</span>  <span class='kw'>while</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_buf'>buf</span> <span class='op'>=</span> <span class='id identifier rubyid_od'>od</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='int'>20</span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id identifier rubyid_buf'>buf</span>

    <span class='id identifier rubyid_idh'>idh</span><span class='comma'>,</span><span class='id identifier rubyid_idl'>idl</span><span class='comma'>,</span><span class='id identifier rubyid_thi'>thi</span><span class='comma'>,</span><span class='id identifier rubyid_tlo'>tlo</span><span class='comma'>,</span><span class='id identifier rubyid_len'>len</span> <span class='op'>=</span> <span class='id identifier rubyid_buf'>buf</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N5</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id identifier rubyid_len'>len</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_len'>len</span> <span class='op'>&gt;</span> <span class='int'>10000</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Corrupted packet data (length:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_len'>len</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_pkt_id'>pkt_id</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_idh'>idh</span> <span class='op'>&lt;&lt;</span> <span class='int'>32</span><span class='rparen'>)</span> <span class='op'>+</span><span class='id identifier rubyid_idl'>idl</span>
    <span class='id identifier rubyid_pkt_ts'>pkt_ts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Proto/SMB/Utils.html" title="Rex::Proto::SMB::Utils (class)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_time_smb_to_unix'><span class='object_link'><a href="../../../../../Proto/SMB/Utils.html#time_smb_to_unix-class_method" title="Rex::Proto::SMB::Utils.time_smb_to_unix (method)">time_smb_to_unix</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_thi'>thi</span><span class='comma'>,</span><span class='id identifier rubyid_tlo'>tlo</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_pkt'>pkt</span>    <span class='op'>=</span> <span class='id identifier rubyid_od'>od</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_len'>len</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_fd'>fd</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_pkt_ts'>pkt_ts</span><span class='comma'>,</span><span class='int'>0</span><span class='comma'>,</span><span class='id identifier rubyid_len'>len</span><span class='comma'>,</span><span class='id identifier rubyid_len'>len</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NNNN</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='op'>+</span><span class='id identifier rubyid_pkt'>pkt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_od'>od</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid_fd'>fd</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>

  <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span><span class='lparen'>(</span><span class='id identifier rubyid_path_raw'>path_raw</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PCAP file written to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path_cap'>path_cap</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cmd_sniffer_interfaces-instance_method">
  
    #<strong>cmd_sniffer_interfaces</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_interfaces'>cmd_sniffer_interfaces</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ifaces'>ifaces</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_interfaces'>interfaces</span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_print_line'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_line-instance_method" title="#print_line (method)">print_line</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ifaces'>ifaces</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>8</span>
      <span class='comment'># Windows
</span>      <span class='id identifier rubyid_print_line'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_line-instance_method" title="#print_line (method)">print_line</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%d - &#39;%s&#39; ( type:%d mtu:%d usable:%s dhcp:%s wifi:%s )</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>idx</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>description</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mtu</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>usable</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dhcp</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wireless</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='comment'># Mettle
</span>      <span class='id identifier rubyid_print_line'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_line-instance_method" title="#print_line (method)">print_line</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%d - &#39;%s&#39; ( usable:%s )</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>idx</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>description</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>usable</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_print_line'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_line-instance_method" title="#print_line (method)">print_line</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cmd_sniffer_release-instance_method">
  
    #<strong>cmd_sniffer_release</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127
128
129
130
131
132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 125</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_release'>cmd_sniffer_release</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_intf'>intf</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usage: sniffer_release [interface-id]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_release'>capture_release</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Flushed </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:packets</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> packets (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes) from interface </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cmd_sniffer_start-instance_method">
  
    #<strong>cmd_sniffer_start</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 81</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_start'>cmd_sniffer_start</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_intf'>intf</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usage: sniffer_start [interface-id] [packet-buffer (1-200000)] [bpf filter (posix meterpreter only)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_maxp'>maxp</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span> <span class='op'>||</span> <span class='int'>50000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_bpf'>bpf</span>  <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_start'>capture_start</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='comma'>,</span> <span class='id identifier rubyid_maxp'>maxp</span><span class='comma'>,</span> <span class='id identifier rubyid_bpf'>bpf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Capture started on interface </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_maxp'>maxp</span><span class='embexpr_end'>}</span><span class='tstring_content'> packet buffer)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cmd_sniffer_stats-instance_method">
  
    #<strong>cmd_sniffer_stats</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 109</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_stats'>cmd_sniffer_stats</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_intf'>intf</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usage: sniffer_stats [interface-id]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_stats'>stats</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_stats'>capture_stats</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Capture statistics for interface </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_stats'>stats</span><span class='period'>.</span><span class='id identifier rubyid_each_key'>each_key</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_print_line'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_line-instance_method" title="#print_line (method)">print_line</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cmd_sniffer_stop-instance_method">
  
    #<strong>cmd_sniffer_stop</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cmd_sniffer_stop'>cmd_sniffer_stop</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_intf'>intf</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print_error'><span class='object_link'><a href="../../../../../../top-level-namespace.html#print_error-instance_method" title="#print_error (method)">print_error</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usage: sniffer_stop [interface-id]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_sniffer'>sniffer</span><span class='period'>.</span><span class='id identifier rubyid_capture_stop'>capture_stop</span><span class='lparen'>(</span><span class='id identifier rubyid_intf'>intf</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Capture stopped on interface </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_intf'>intf</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:packets</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> packets (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:bytes</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes) remaining</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Download or release them using &#39;sniffer_dump&#39; or &#39;sniffer_release&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="commands-instance_method">
  
    #<strong>commands</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List of supported commands.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_commands'>commands</span>
  <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_interfaces</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enumerate all sniffable network interfaces</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_start</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Start packet capture on a specific interface</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_stop</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stop packet capture on a specific interface</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_stats</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>View statistics of an active capture</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_dump</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Retrieve captured packet data to PCAP file</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sniffer_release</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Free captured packets on a specific interface instead of downloading them</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='rbrace'>}</span>

  <span class='comment'>#reqs = {
</span>  <span class='comment'>#  &#39;sniffer_interfaces&#39; =&gt; [COMMAND_ID_SNIFFER_INTERFACES],
</span>  <span class='comment'>#  &#39;sniffer_start&#39;      =&gt; [COMMAND_ID_SNIFFER_CAPTURE_START],
</span>  <span class='comment'>#  &#39;sniffer_stop&#39;       =&gt; [COMMAND_ID_SNIFFER_CAPTURE_STOP],
</span>  <span class='comment'>#  &#39;sniffer_stats&#39;      =&gt; [COMMAND_ID_SNIFFER_CAPTURE_STATS],
</span>  <span class='comment'>#  &#39;sniffer_dump&#39;       =&gt; [COMMAND_ID_SNIFFER_CAPTURE_DUMP],
</span>  <span class='comment'>#  &#39;sniffer_release&#39;    =&gt; [COMMAND_ID_SNIFFER_CAPTURE_RELEASE],
</span>  <span class='comment'>#}
</span>
  <span class='comment'>#filter_commands(all, reqs)
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Name for this dispatcher sni</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/ui/console/command_dispatcher/sniffer.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sniffer</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Mar 31 00:34:06 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>