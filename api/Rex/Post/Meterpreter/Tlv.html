<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rex::Post::Meterpreter::Tlv
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Rex::Post::Meterpreter::Tlv";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Post.html" title="Rex::Post (module)">Post</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Meterpreter.html" title="Rex::Post::Meterpreter (module)">Meterpreter</a></span></span>
     &raquo; 
    <span class="title">Tlv</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rex::Post::Meterpreter::Tlv
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Rex::Post::Meterpreter::Tlv</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rex/post/meterpreter/packet.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Base TLV (Type-Length-Value) class</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="GroupTlv.html" title="Rex::Post::Meterpreter::GroupTlv (class)">GroupTlv</a></span></p>
</div>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="HEADER_SIZE-constant" class="">HEADER_SIZE =
          
        </dt>
        <dd><pre class="code"><span class='int'>8</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#compress-instance_method" title="#compress (instance method)">#<strong>compress</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute compress.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">#<strong>type</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute type.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#value-instance_method" title="#value (instance method)">#<strong>value</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute value.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_r-instance_method" title="#from_r (instance method)">#<strong>from_r</strong>(raw)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Translates the raw format of the TLV into a sanitize version.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#htonq-instance_method" title="#htonq (instance method)">#<strong>htonq</strong>(value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(type, value = nil, compress = false)  &#x21d2; Tlv </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an instance of a TLV.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#meta_type%3F-instance_method" title="#meta_type? (instance method)">#<strong>meta_type?</strong>(meta)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if a TLVs meta type is equivalent to the meta type passed.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#ntohq-instance_method" title="#ntohq (instance method)">#<strong>ntohq</strong>(value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_r-instance_method" title="#to_r (instance method)">#<strong>to_r</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts the TLV to raw.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type%3F-instance_method" title="#type? (instance method)">#<strong>type?</strong>(type)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the TLVs type is equivalent to the type passed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#value%3F-instance_method" title="#value? (instance method)">#<strong>value?</strong>(value)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the TLVs value is equivalent to the value passed.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(type, value = nil, compress = false)  &#x21d2; <tt><span class='object_link'><a href="" title="Rex::Post::Meterpreter::Tlv (class)">Tlv</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an instance of a TLV.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 650</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_compress'>compress</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='ivar'>@type</span>     <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span>
  <span class='ivar'>@compress</span> <span class='op'>=</span> <span class='id identifier rubyid_compress'>compress</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>!=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Integer</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='ivar'>@value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>else</span>
        <span class='ivar'>@value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='ivar'>@value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="compress=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="compress-instance_method">
  
    #<strong>compress</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute compress.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


637
638
639</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 637</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compress'>compress</span>
  <span class='ivar'>@compress</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="type=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    #<strong>type</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute type.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


637
638
639</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 637</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='ivar'>@type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="value=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="value-instance_method">
  
    #<strong>value</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute value.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


637
638
639</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 637</span>

<span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span>
  <span class='ivar'>@value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="from_r-instance_method">
  
    #<strong>from_r</strong>(raw)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Translates the raw format of the TLV into a sanitize version.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 838</span>

<span class='kw'>def</span> <span class='id identifier rubyid_from_r'>from_r</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>  <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='semicolon'>;</span>

  <span class='comment'># check if the tlv value has been compressed...
</span>  <span class='kw'>if</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPRESSED-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPRESSED (constant)">TLV_META_TYPE_COMPRESSED</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPRESSED-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPRESSED (constant)">TLV_META_TYPE_COMPRESSED</a></span></span> <span class='rparen'>)</span>
    <span class='comment'># set this TLV as using compression
</span>    <span class='ivar'>@compress</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='comment'># remove the TLV_META_TYPE_COMPRESSED flag from the tlv type to restore the
</span>    <span class='comment'># tlv type to its origional, allowing for transparent data compression.
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>^</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPRESSED-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPRESSED (constant)">TLV_META_TYPE_COMPRESSED</a></span></span>
    <span class='comment'># decompress the compressed data (skipping the length and type DWORD&#39;s)
</span>    <span class='id identifier rubyid_raw_decompressed'>raw_decompressed</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_zlib_inflate'>zlib_inflate</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#HEADER_SIZE-constant" title="Rex::Post::Meterpreter::Tlv::HEADER_SIZE (constant)">HEADER_SIZE</a></span></span><span class='op'>..</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='comment'># update the length to reflect the decompressed data length (+HEADER_SIZE for the length and type DWORD&#39;s)
</span>    <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='id identifier rubyid_raw_decompressed'>raw_decompressed</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="#HEADER_SIZE-constant" title="Rex::Post::Meterpreter::Tlv::HEADER_SIZE (constant)">HEADER_SIZE</a></span></span>
    <span class='comment'># update the raw buffer with the new length, decompressed data and updated type.
</span>    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_raw_decompressed'>raw_decompressed</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#HEADER_SIZE-constant" title="Rex::Post::Meterpreter::Tlv::HEADER_SIZE (constant)">HEADER_SIZE</a></span></span><span class='op'>..</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_UINT (constant)">TLV_META_TYPE_UINT</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_UINT (constant)">TLV_META_TYPE_UINT</a></span></span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NNN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_QWORD-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_QWORD (constant)">TLV_META_TYPE_QWORD</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_QWORD-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_QWORD (constant)">TLV_META_TYPE_QWORD</a></span></span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NNQ&lt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ntohq'>ntohq</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_BOOL (constant)">TLV_META_TYPE_BOOL</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_BOOL (constant)">TLV_META_TYPE_BOOL</a></span></span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NNc</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#HEADER_SIZE-constant" title="Rex::Post::Meterpreter::Tlv::HEADER_SIZE (constant)">HEADER_SIZE</a></span></span><span class='op'>..</span><span class='id identifier rubyid_length'>length</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="htonq-instance_method">
  
    #<strong>htonq</strong>(value)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


886
887
888
889
890
891
892</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 886</span>

<span class='kw'>def</span> <span class='id identifier rubyid_htonq'>htonq</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Q&lt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Q&lt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 667</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_utype'>utype</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>^</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPRESSED-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPRESSED (constant)">TLV_META_TYPE_COMPRESSED</a></span></span>
  <span class='id identifier rubyid_group'>group</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_meta'>meta</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='lparen'>(</span><span class='id identifier rubyid_utype'>utype</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_MASK-constant" title="Rex::Post::Meterpreter::TLV_META_MASK (constant)">TLV_META_MASK</a></span></span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>STRING</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_UINT (constant)">TLV_META_TYPE_UINT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_RAW-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_RAW (constant)">TLV_META_TYPE_RAW</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RAW</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_BOOL (constant)">TLV_META_TYPE_BOOL</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BOOL</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_QWORD-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_QWORD (constant)">TLV_META_TYPE_QWORD</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>QWORD</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_GROUP-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_GROUP (constant)">TLV_META_TYPE_GROUP</a></span></span><span class='semicolon'>;</span> <span class='id identifier rubyid_group'>group</span><span class='op'>=</span><span class='kw'>true</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GROUP</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPLEX-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPLEX (constant)">TLV_META_TYPE_COMPLEX</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>COMPLEX</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown-meta-type</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='id identifier rubyid_stype'>stype</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_REQUEST-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_REQUEST (constant)">PACKET_TYPE_REQUEST</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Request</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#PACKET_TYPE_RESPONSE-constant" title="Rex::Post::Meterpreter::PACKET_TYPE_RESPONSE (constant)">PACKET_TYPE_RESPONSE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Response</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_REQUEST_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_REQUEST_ID (constant)">TLV_TYPE_REQUEST_ID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REQUEST-ID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_COMMAND_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_COMMAND_ID (constant)">TLV_TYPE_COMMAND_ID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>COMMAND-ID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_RESULT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_RESULT (constant)">TLV_TYPE_RESULT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RESULT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_EXCEPTION-constant" title="Rex::Post::Meterpreter::TLV_TYPE_EXCEPTION (constant)">TLV_TYPE_EXCEPTION</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EXCEPTION</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_TYPE_STRING (constant)">TLV_TYPE_STRING</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>STRING</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_UINT (constant)">TLV_TYPE_UINT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UINT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_TYPE_BOOL (constant)">TLV_TYPE_BOOL</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BOOL</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_LENGTH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_LENGTH (constant)">TLV_TYPE_LENGTH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LENGTH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_DATA-constant" title="Rex::Post::Meterpreter::TLV_TYPE_DATA (constant)">TLV_TYPE_DATA</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DATA</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_FLAGS-constant" title="Rex::Post::Meterpreter::TLV_TYPE_FLAGS (constant)">TLV_TYPE_FLAGS</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FLAGS</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_ID (constant)">TLV_TYPE_CHANNEL_ID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-ID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_TYPE-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_TYPE (constant)">TLV_TYPE_CHANNEL_TYPE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-TYPE</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_DATA-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_DATA (constant)">TLV_TYPE_CHANNEL_DATA</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-DATA</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_DATA_GROUP-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_DATA_GROUP (constant)">TLV_TYPE_CHANNEL_DATA_GROUP</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-DATA-GROUP</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_CLASS-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_CLASS (constant)">TLV_TYPE_CHANNEL_CLASS</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-CLASS</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_CHANNEL_PARENTID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_CHANNEL_PARENTID (constant)">TLV_TYPE_CHANNEL_PARENTID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CHANNEL-PARENTID</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SEEK_WHENCE-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SEEK_WHENCE (constant)">TLV_TYPE_SEEK_WHENCE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SEEK-WHENCE</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SEEK_OFFSET-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SEEK_OFFSET (constant)">TLV_TYPE_SEEK_OFFSET</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SEEK-OFFSET</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SEEK_POS-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SEEK_POS (constant)">TLV_TYPE_SEEK_POS</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SEEK-POS</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_EXCEPTION_CODE-constant" title="Rex::Post::Meterpreter::TLV_TYPE_EXCEPTION_CODE (constant)">TLV_TYPE_EXCEPTION_CODE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EXCEPTION-CODE</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_EXCEPTION_STRING-constant" title="Rex::Post::Meterpreter::TLV_TYPE_EXCEPTION_STRING (constant)">TLV_TYPE_EXCEPTION_STRING</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EXCEPTION-STRING</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_LIBRARY_PATH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_LIBRARY_PATH (constant)">TLV_TYPE_LIBRARY_PATH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LIBRARY-PATH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TARGET_PATH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TARGET_PATH (constant)">TLV_TYPE_TARGET_PATH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TARGET-PATH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_PID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_PID (constant)">TLV_TYPE_MIGRATE_PID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-PID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_PAYLOAD-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_PAYLOAD (constant)">TLV_TYPE_MIGRATE_PAYLOAD</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-PAYLOAD</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_ARCH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_ARCH (constant)">TLV_TYPE_MIGRATE_ARCH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-ARCH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_BASE_ADDR-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_BASE_ADDR (constant)">TLV_TYPE_MIGRATE_BASE_ADDR</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-BASE-ADDR</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_ENTRY_POINT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_ENTRY_POINT (constant)">TLV_TYPE_MIGRATE_ENTRY_POINT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-ENTRY-POINT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_STUB-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_STUB (constant)">TLV_TYPE_MIGRATE_STUB</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-STUB</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MIGRATE_SOCKET_PATH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MIGRATE_SOCKET_PATH (constant)">TLV_TYPE_MIGRATE_SOCKET_PATH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MIGRATE-SOCKET-PATH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_LIB_LOADER_NAME-constant" title="Rex::Post::Meterpreter::TLV_TYPE_LIB_LOADER_NAME (constant)">TLV_TYPE_LIB_LOADER_NAME</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LIB-LOADER-NAME</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_LIB_LOADER_ORDINAL-constant" title="Rex::Post::Meterpreter::TLV_TYPE_LIB_LOADER_ORDINAL (constant)">TLV_TYPE_LIB_LOADER_ORDINAL</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LIB-LOADER-ORDINAL</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_TYPE-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_TYPE (constant)">TLV_TYPE_TRANS_TYPE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-TYPE</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_URL-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_URL (constant)">TLV_TYPE_TRANS_URL</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-URL</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_COMM_TIMEOUT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_COMM_TIMEOUT (constant)">TLV_TYPE_TRANS_COMM_TIMEOUT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-COMM-TIMEOUT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_SESSION_EXP-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_SESSION_EXP (constant)">TLV_TYPE_TRANS_SESSION_EXP</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-SESSION-EXP</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_CERT_HASH-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_CERT_HASH (constant)">TLV_TYPE_TRANS_CERT_HASH</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-CERT-HASH</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_PROXY_HOST-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_PROXY_HOST (constant)">TLV_TYPE_TRANS_PROXY_HOST</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-PROXY-HOST</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_PROXY_USER-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_PROXY_USER (constant)">TLV_TYPE_TRANS_PROXY_USER</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-PROXY-USER</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_PROXY_PASS-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_PROXY_PASS (constant)">TLV_TYPE_TRANS_PROXY_PASS</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-PROXY-PASS</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_RETRY_TOTAL-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_RETRY_TOTAL (constant)">TLV_TYPE_TRANS_RETRY_TOTAL</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-RETRY-TOTAL</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_TRANS_RETRY_WAIT-constant" title="Rex::Post::Meterpreter::TLV_TYPE_TRANS_RETRY_WAIT (constant)">TLV_TYPE_TRANS_RETRY_WAIT</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TRANS-RETRY-WAIT</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_MACHINE_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_MACHINE_ID (constant)">TLV_TYPE_MACHINE_ID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MACHINE-ID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_UUID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_UUID (constant)">TLV_TYPE_UUID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UUID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SESSION_GUID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SESSION_GUID (constant)">TLV_TYPE_SESSION_GUID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SESSION-GUID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_RSA_PUB_KEY-constant" title="Rex::Post::Meterpreter::TLV_TYPE_RSA_PUB_KEY (constant)">TLV_TYPE_RSA_PUB_KEY</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>RSA-PUB-KEY</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SYM_KEY_TYPE-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SYM_KEY_TYPE (constant)">TLV_TYPE_SYM_KEY_TYPE</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SYM-KEY-TYPE</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_SYM_KEY-constant" title="Rex::Post::Meterpreter::TLV_TYPE_SYM_KEY (constant)">TLV_TYPE_SYM_KEY</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SYM-KEY</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_ENC_SYM_KEY-constant" title="Rex::Post::Meterpreter::TLV_TYPE_ENC_SYM_KEY (constant)">TLV_TYPE_ENC_SYM_KEY</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ENC-SYM-KEY</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_PIVOT_ID-constant" title="Rex::Post::Meterpreter::TLV_TYPE_PIVOT_ID (constant)">TLV_TYPE_PIVOT_ID</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PIVOT-ID</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_PIVOT_STAGE_DATA-constant" title="Rex::Post::Meterpreter::TLV_TYPE_PIVOT_STAGE_DATA (constant)">TLV_TYPE_PIVOT_STAGE_DATA</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PIVOT-STAGE-DATA</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_TYPE_PIVOT_NAMED_PIPE_NAME-constant" title="Rex::Post::Meterpreter::TLV_TYPE_PIVOT_NAMED_PIPE_NAME (constant)">TLV_TYPE_PIVOT_NAMED_PIPE_NAME</a></span></span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PIVOT-NAMED-PIPE-NAME</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>else</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>50</span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>50</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ...&quot;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_group'>group</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Packet</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_group'>group</span>
    <span class='id identifier rubyid_tlvs_inspect'>tlvs_inspect</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tlvs=[\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@tlvs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
      <span class='id identifier rubyid_tlvs_inspect'>tlvs_inspect</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_tlvs_inspect'>tlvs_inspect</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tlvs_inspect'>tlvs_inspect</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>meta=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_meta'>meta</span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> value=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val'>val</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> type=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stype'>stype</span><span class='period'>.</span><span class='id identifier rubyid_ljust'>ljust</span><span class='lparen'>(</span><span class='int'>15</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tlvs_inspect'>tlvs_inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="meta_type?-instance_method">
  
    #<strong>meta_type?</strong>(meta)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if a TLVs meta type is equivalent to the meta type passed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


770
771
772</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 770</span>

<span class='kw'>def</span> <span class='id identifier rubyid_meta_type?'>meta_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_meta'>meta</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_meta'>meta</span> <span class='op'>==</span> <span class='id identifier rubyid_meta'>meta</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ntohq-instance_method">
  
    #<strong>ntohq</strong>(value)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


894
895
896</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 894</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ntohq'>ntohq</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_htonq'>htonq</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_r-instance_method">
  
    #<strong>to_r</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts the TLV to raw.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 797</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_r'>to_r</span>
  <span class='comment'># Forcibly convert to ASCII-8BIT encoding
</span>  <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_STRING-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_STRING (constant)">TLV_META_TYPE_STRING</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x00</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_UINT (constant)">TLV_META_TYPE_UINT</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_UINT-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_UINT (constant)">TLV_META_TYPE_UINT</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_QWORD-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_QWORD (constant)">TLV_META_TYPE_QWORD</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_QWORD-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_QWORD (constant)">TLV_META_TYPE_QWORD</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_htonq'>htonq</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rparen'>)</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Q&lt;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_BOOL (constant)">TLV_META_TYPE_BOOL</a></span></span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_BOOL-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_BOOL (constant)">TLV_META_TYPE_BOOL</a></span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># check if the tlv is to be compressed...
</span>  <span class='kw'>if</span> <span class='ivar'>@compress</span>
    <span class='id identifier rubyid_raw_uncompressed'>raw_uncompressed</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span>
    <span class='comment'># compress the raw data
</span>    <span class='id identifier rubyid_raw_compressed'>raw_compressed</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_zlib_deflate'>zlib_deflate</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw_uncompressed'>raw_uncompressed</span> <span class='rparen'>)</span>
    <span class='comment'># check we have actually made the raw data smaller...
</span>    <span class='comment'># (small blobs often compress slightly larger then the origional)
</span>    <span class='comment'># if the compressed data is not smaller, we dont use the compressed data
</span>    <span class='kw'>if</span><span class='lparen'>(</span> <span class='id identifier rubyid_raw_compressed'>raw_compressed</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_raw_uncompressed'>raw_uncompressed</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='rparen'>)</span>
      <span class='comment'># if so, set the TLV&#39;s type to indicate compression is used
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>|</span> <span class='const'><span class='object_link'><a href="../Meterpreter.html#TLV_META_TYPE_COMPRESSED-constant" title="Rex::Post::Meterpreter::TLV_META_TYPE_COMPRESSED (constant)">TLV_META_TYPE_COMPRESSED</a></span></span>
      <span class='comment'># update the raw data with the uncompressed data length + compressed data
</span>      <span class='comment'># (we include the uncompressed data length as the C side will need to know this for decompression)
</span>      <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_raw_uncompressed'>raw_uncompressed</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>N</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_raw_compressed'>raw_compressed</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_raw'>raw</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="#HEADER_SIZE-constant" title="Rex::Post::Meterpreter::Tlv::HEADER_SIZE (constant)">HEADER_SIZE</a></span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_raw'>raw</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type?-instance_method">
  
    #<strong>type?</strong>(type)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the TLVs type is equivalent to the type passed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


777
778
779</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 777</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type?'>type?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="value?-instance_method">
  
    #<strong>value?</strong>(value)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the TLVs value is equivalent to the value passed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


784
785
786</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rex/post/meterpreter/packet.rb', line 784</span>

<span class='kw'>def</span> <span class='id identifier rubyid_value?'>value?</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Mar 31 00:33:51 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>