<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Msf::Payload
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Msf/Payload.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Msf.html" title="Msf (module)">Msf</a></span></span>
     &raquo; 
    <span class="title">Payload</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Msf::Payload
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></li>
          
            <li class="next">Msf::Payload</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/core/payload.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class represents the base class for a logical payload.  The framework
automatically generates payload combinations at runtime which are all
extended for this Payload as a base class.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Payload/Aix.html" title="Msf::Payload::Aix (module)">Aix</a></span>, <span class='object_link'><a href="Payload/Bsd.html" title="Msf::Payload::Bsd (module)">Bsd</a></span>, <span class='object_link'><a href="Payload/Dalvik.html" title="Msf::Payload::Dalvik (module)">Dalvik</a></span>, <span class='object_link'><a href="Payload/Firefox.html" title="Msf::Payload::Firefox (module)">Firefox</a></span>, <span class='object_link'><a href="Payload/Generic.html" title="Msf::Payload::Generic (module)">Generic</a></span>, <span class='object_link'><a href="Payload/JSP.html" title="Msf::Payload::JSP (module)">JSP</a></span>, <span class='object_link'><a href="Payload/Java.html" title="Msf::Payload::Java (module)">Java</a></span>, <span class='object_link'><a href="Payload/Linux.html" title="Msf::Payload::Linux (module)">Linux</a></span>, <span class='object_link'><a href="Payload/Netware.html" title="Msf::Payload::Netware (module)">Netware</a></span>, <span class='object_link'><a href="Payload/NodeJS.html" title="Msf::Payload::NodeJS (module)">NodeJS</a></span>, <span class='object_link'><a href="Payload/Osx.html" title="Msf::Payload::Osx (module)">Osx</a></span>, <span class='object_link'><a href="Payload/Php.html" title="Msf::Payload::Php (module)">Php</a></span>, <span class='object_link'><a href="Payload/Ruby.html" title="Msf::Payload::Ruby (module)">Ruby</a></span>, <span class='object_link'><a href="Payload/Single.html" title="Msf::Payload::Single (module)">Single</a></span>, <span class='object_link'><a href="Payload/Solaris.html" title="Msf::Payload::Solaris (module)">Solaris</a></span>, <span class='object_link'><a href="Payload/Stager.html" title="Msf::Payload::Stager (module)">Stager</a></span>, <span class='object_link'><a href="Payload/Type.html" title="Msf::Payload::Type (module)">Type</a></span>, <span class='object_link'><a href="Payload/Windows.html" title="Msf::Payload::Windows (module)">Windows</a></span>
    
  
    
  
</p>

  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants inherited
     from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#UpdateableOptions-constant" title="Msf::Module::UpdateableOptions (constant)">Module::UpdateableOptions</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#append-instance_method" title="#append (instance method)">- (Object) <strong>append</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This attribute holds the string that should be appended to the buffer when
it&#39;s generated.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#assoc_exploit-instance_method" title="#assoc_exploit (instance method)">- (Object) <strong>assoc_exploit</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If this payload is associated with an exploit, the assoc_exploit attribute
will point to that exploit instance.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend-instance_method" title="#prepend (instance method)">- (Object) <strong>prepend</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This attribute holds the string that should be prepended to the buffer when
it&#39;s generated.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_encoder-instance_method" title="#prepend_encoder (instance method)">- (Object) <strong>prepend_encoder</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This attribute holds the string that should be prepended to the encoded
version of the payload (in front of the encoder as well).</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#arch-instance_method" title="Msf::Module#arch (method)">#arch</a></span>, <span class='object_link'><a href="Module.html#author-instance_method" title="Msf::Module#author (method)">#author</a></span>, <span class='object_link'><a href="Module.html#datastore-instance_method" title="Msf::Module#datastore (method)">#datastore</a></span>, <span class='object_link'><a href="Module.html#error-instance_method" title="Msf::Module#error (method)">#error</a></span>, <span class='object_link'><a href="Module.html#job_id-instance_method" title="Msf::Module#job_id (method)">#job_id</a></span>, <span class='object_link'><a href="Module.html#license-instance_method" title="Msf::Module#license (method)">#license</a></span>, <span class='object_link'><a href="Module.html#module_info-instance_method" title="Msf::Module#module_info (method)">#module_info</a></span>, <span class='object_link'><a href="Module.html#module_store-instance_method" title="Msf::Module#module_store (method)">#module_store</a></span>, <span class='object_link'><a href="Module.html#options-instance_method" title="Msf::Module#options (method)">#options</a></span>, <span class='object_link'><a href="Module.html#platform-instance_method" title="Msf::Module#platform (method)">#platform</a></span>, <span class='object_link'><a href="Module.html#privileged-instance_method" title="Msf::Module#privileged (method)">#privileged</a></span>, <span class='object_link'><a href="Module.html#references-instance_method" title="Msf::Module#references (method)">#references</a></span>, <span class='object_link'><a href="Module.html#uuid-instance_method" title="Msf::Module#uuid (method)">#uuid</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="Framework/Offspring.html" title="Msf::Framework::Offspring (module)">Framework::Offspring</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Framework/Offspring.html#framework-instance_method" title="Msf::Framework::Offspring#framework (method)">#framework</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html#user_input-instance_method" title="Rex::Ui::Subscriber::Input#user_input (method)">#user_input</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#user_output-instance_method" title="Rex::Ui::Subscriber::Output#user_output (method)">#user_output</a></span></p>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-class_method" title="type (class method)">+ (Object) <strong>type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns MODULE_PAYLOAD to indicate that this is a payload module.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assembly-instance_method" title="#assembly (instance method)">- (Object) <strong>assembly</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the assembly string that describes the payload if one exists.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assembly%3D-instance_method" title="#assembly= (instance method)">- (Object) <strong>assembly=</strong>(asm) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the assembly string that describes the payload If this method is used
to define the payload, a payload with no offsets will be created.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#badchars-instance_method" title="#badchars (instance method)">- (Object) <strong>badchars</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the string of bad characters for this payload, if any.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">- (String) <strong>build</strong>(asm, off = {}) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If the payload has assembly that needs to be compiled, do so now.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compatible_convention%3F-instance_method" title="#compatible_convention? (instance method)">- (Boolean) <strong>compatible_convention?</strong>(conv) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks to see if the supplied convention is compatible with this
payload&#39;s convention.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compatible_encoders-instance_method" title="#compatible_encoders (instance method)">- (Object) <strong>compatible_encoders</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the array of compatible encoders for this payload instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compatible_nops-instance_method" title="#compatible_nops (instance method)">- (Object) <strong>compatible_nops</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the array of compatible nops for this payload instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection_type-instance_method" title="#connection_type (instance method)">- (Object) <strong>connection_type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the module&#39;s connection type, such as reverse, bind, noconn, or
whatever else the case may be.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convention-instance_method" title="#convention (instance method)">- (Object) <strong>convention</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the staging convention that the payload uses, if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate-instance_method" title="#generate (instance method)">- (Object) <strong>generate</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates the payload and returns the raw buffer to the caller.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handler_klass-instance_method" title="#handler_klass (instance method)">- (Object) <strong>handler_klass</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the connection associated with this payload, or none if there
isn&#39;t one.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Payload) <strong>initialize</strong>(info = {}) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates an instance of a payload module using the supplied information.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#internal_generate-instance_method" title="#internal_generate (instance method)">- (Object) <strong>internal_generate</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate the payload using our local payload blob and offsets.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#merge_name-instance_method" title="#merge_name (instance method)">- (Object) <strong>merge_name</strong>(info, val) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Merge the name to prefix the existing one and separate them with a comma.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#offsets-instance_method" title="#offsets (instance method)">- (Object) <strong>offsets</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the offsets to variables that must be substitute, if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_session-instance_method" title="#on_session (instance method)">- (Object) <strong>on_session</strong>(session) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Once an exploit completes and a session has been created on behalf of the
payload, the framework will call the payload&#39;s on_session notification
routine to allow it to manipulate the session prior to handing off control
to the user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload-instance_method" title="#payload (instance method)">- (Object) <strong>payload</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the raw payload that has not had variable substitution occur.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_type-instance_method" title="#payload_type (instance method)">- (Object) <strong>payload_type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type of payload, either single or staged.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload_type_s-instance_method" title="#payload_type_s (instance method)">- (Object) <strong>payload_type_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the string version of the payload type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace_var-instance_method" title="#replace_var (instance method)">- (Object) <strong>replace_var</strong>(raw, name, offset, pack) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Replaces an individual variable in the supplied buffer at an offset using
the given pack type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_registers-instance_method" title="#save_registers (instance method)">- (Object) <strong>save_registers</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The list of registers that should be saved by any NOP generators or
encoders, if possible.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#session-instance_method" title="#session (instance method)">- (Object) <strong>session</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the session class that is associated with this payload and will be
used to create a session as necessary.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">- (Object) <strong>size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the payload&#39;s size.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#staged%3F-instance_method" title="#staged? (instance method)">- (Boolean) <strong>staged?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method returns whether or not this payload uses staging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#substitute_vars-instance_method" title="#substitute_vars (instance method)">- (Object) <strong>substitute_vars</strong>(raw, offsets) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Substitutes variables with values from the module&#39;s datastore in the
supplied raw buffer for a given set of named offsets.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#symbol_lookup-instance_method" title="#symbol_lookup (instance method)">- (Object) <strong>symbol_lookup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the method used by the payload to resolve symbols for the purpose
of calling functions, such as ws2ord.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">- (Object) <strong>type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns MODULE_PAYLOAD to indicate that this is a payload module.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Module.html" title="Msf::Module (class)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#%5B%5D-instance_method" title="Msf::Module#[] (method)">#[]</a></span>, <span class='object_link'><a href="Module.html#%5B%5D%3D-instance_method" title="Msf::Module#[]= (method)">#[]=</a></span>, <span class='object_link'><a href="Module.html#alias-instance_method" title="Msf::Module#alias (method)">#alias</a></span>, <span class='object_link'><a href="Module.html#arch%3F-instance_method" title="Msf::Module#arch? (method)">#arch?</a></span>, <span class='object_link'><a href="Module.html#arch_to_s-instance_method" title="Msf::Module#arch_to_s (method)">#arch_to_s</a></span>, <span class='object_link'><a href="Module.html#author_to_s-instance_method" title="Msf::Module#author_to_s (method)">#author_to_s</a></span>, <span class='object_link'><a href="Module.html#auxiliary%3F-instance_method" title="Msf::Module#auxiliary? (method)">#auxiliary?</a></span>, <span class='object_link'><a href="Module.html#cached%3F-class_method" title="Msf::Module.cached? (method)">cached?</a></span>, <span class='object_link'><a href="Module.html#check-instance_method" title="Msf::Module#check (method)">#check</a></span>, <span class='object_link'><a href="Module.html#comm-instance_method" title="Msf::Module#comm (method)">#comm</a></span>, <span class='object_link'><a href="Module.html#compat-instance_method" title="Msf::Module#compat (method)">#compat</a></span>, <span class='object_link'><a href="Module.html#compatible%3F-instance_method" title="Msf::Module#compatible? (method)">#compatible?</a></span>, <span class='object_link'><a href="Module.html#debugging%3F-instance_method" title="Msf::Module#debugging? (method)">#debugging?</a></span>, <span class='object_link'><a href="Module.html#deregister_options-instance_method" title="Msf::Module#deregister_options (method)">#deregister_options</a></span>, <span class='object_link'><a href="Module.html#derived_implementor%3F-instance_method" title="Msf::Module#derived_implementor? (method)">#derived_implementor?</a></span>, <span class='object_link'><a href="Module.html#description-instance_method" title="Msf::Module#description (method)">#description</a></span>, <span class='object_link'><a href="Module.html#disclosure_date-instance_method" title="Msf::Module#disclosure_date (method)">#disclosure_date</a></span>, <span class='object_link'><a href="Module.html#each_arch-instance_method" title="Msf::Module#each_arch (method)">#each_arch</a></span>, <span class='object_link'><a href="Module.html#each_author-instance_method" title="Msf::Module#each_author (method)">#each_author</a></span>, <span class='object_link'><a href="Module.html#encoder%3F-instance_method" title="Msf::Module#encoder? (method)">#encoder?</a></span>, <span class='object_link'><a href="Module.html#exploit%3F-instance_method" title="Msf::Module#exploit? (method)">#exploit?</a></span>, <span class='object_link'><a href="Module.html#fail_with-instance_method" title="Msf::Module#fail_with (method)">#fail_with</a></span>, <span class='object_link'><a href="Module.html#file_path-instance_method" title="Msf::Module#file_path (method)">#file_path</a></span>, <span class='object_link'><a href="Module.html#framework-instance_method" title="Msf::Module#framework (method)">#framework</a></span>, <span class='object_link'><a href="Module.html#fullname-class_method" title="Msf::Module.fullname (method)">fullname</a></span>, <span class='object_link'><a href="Module.html#fullname-instance_method" title="Msf::Module#fullname (method)">#fullname</a></span>, <span class='object_link'><a href="Module.html#generate_uuid-instance_method" title="Msf::Module#generate_uuid (method)">#generate_uuid</a></span>, <span class='object_link'><a href="Module.html#import_defaults-instance_method" title="Msf::Module#import_defaults (method)">#import_defaults</a></span>, <span class='object_link'><a href="Module.html#info_fixups-instance_method" title="Msf::Module#info_fixups (method)">#info_fixups</a></span>, <span class='object_link'><a href="Module.html#init_compat-instance_method" title="Msf::Module#init_compat (method)">#init_compat</a></span>, <span class='object_link'><a href="Module.html#is_usable-class_method" title="Msf::Module.is_usable (method)">is_usable</a></span>, <span class='object_link'><a href="Module.html#merge_check_key-instance_method" title="Msf::Module#merge_check_key (method)">#merge_check_key</a></span>, <span class='object_link'><a href="Module.html#merge_info-instance_method" title="Msf::Module#merge_info (method)">#merge_info</a></span>, <span class='object_link'><a href="Module.html#merge_info_advanced_options-instance_method" title="Msf::Module#merge_info_advanced_options (method)">#merge_info_advanced_options</a></span>, <span class='object_link'><a href="Module.html#merge_info_alias-instance_method" title="Msf::Module#merge_info_alias (method)">#merge_info_alias</a></span>, <span class='object_link'><a href="Module.html#merge_info_description-instance_method" title="Msf::Module#merge_info_description (method)">#merge_info_description</a></span>, <span class='object_link'><a href="Module.html#merge_info_evasion_options-instance_method" title="Msf::Module#merge_info_evasion_options (method)">#merge_info_evasion_options</a></span>, <span class='object_link'><a href="Module.html#merge_info_name-instance_method" title="Msf::Module#merge_info_name (method)">#merge_info_name</a></span>, <span class='object_link'><a href="Module.html#merge_info_options-instance_method" title="Msf::Module#merge_info_options (method)">#merge_info_options</a></span>, <span class='object_link'><a href="Module.html#merge_info_string-instance_method" title="Msf::Module#merge_info_string (method)">#merge_info_string</a></span>, <span class='object_link'><a href="Module.html#merge_info_version-instance_method" title="Msf::Module#merge_info_version (method)">#merge_info_version</a></span>, <span class='object_link'><a href="Module.html#name-instance_method" title="Msf::Module#name (method)">#name</a></span>, <span class='object_link'><a href="Module.html#nop%3F-instance_method" title="Msf::Module#nop? (method)">#nop?</a></span>, <span class='object_link'><a href="Module.html#orig_cls-instance_method" title="Msf::Module#orig_cls (method)">#orig_cls</a></span>, <span class='object_link'><a href="Module.html#owner-instance_method" title="Msf::Module#owner (method)">#owner</a></span>, <span class='object_link'><a href="Module.html#payload%3F-instance_method" title="Msf::Module#payload? (method)">#payload?</a></span>, <span class='object_link'><a href="Module.html#platform%3F-instance_method" title="Msf::Module#platform? (method)">#platform?</a></span>, <span class='object_link'><a href="Module.html#platform_to_s-instance_method" title="Msf::Module#platform_to_s (method)">#platform_to_s</a></span>, <span class='object_link'><a href="Module.html#post%3F-instance_method" title="Msf::Module#post? (method)">#post?</a></span>, <span class='object_link'><a href="Module.html#print_error-instance_method" title="Msf::Module#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="Module.html#print_good-instance_method" title="Msf::Module#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="Module.html#print_line-instance_method" title="Msf::Module#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="Module.html#print_line_prefix-instance_method" title="Msf::Module#print_line_prefix (method)">#print_line_prefix</a></span>, <span class='object_link'><a href="Module.html#print_prefix-instance_method" title="Msf::Module#print_prefix (method)">#print_prefix</a></span>, <span class='object_link'><a href="Module.html#print_status-instance_method" title="Msf::Module#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="Module.html#print_warning-instance_method" title="Msf::Module#print_warning (method)">#print_warning</a></span>, <span class='object_link'><a href="Module.html#privileged%3F-instance_method" title="Msf::Module#privileged? (method)">#privileged?</a></span>, <span class='object_link'><a href="Module.html#rank-instance_method" title="Msf::Module#rank (method)">#rank</a></span>, <span class='object_link'><a href="Module.html#rank-class_method" title="Msf::Module.rank (method)">rank</a></span>, <span class='object_link'><a href="Module.html#rank_to_h-class_method" title="Msf::Module.rank_to_h (method)">rank_to_h</a></span>, <span class='object_link'><a href="Module.html#rank_to_h-instance_method" title="Msf::Module#rank_to_h (method)">#rank_to_h</a></span>, <span class='object_link'><a href="Module.html#rank_to_s-class_method" title="Msf::Module.rank_to_s (method)">rank_to_s</a></span>, <span class='object_link'><a href="Module.html#rank_to_s-instance_method" title="Msf::Module#rank_to_s (method)">#rank_to_s</a></span>, <span class='object_link'><a href="Module.html#refname-instance_method" title="Msf::Module#refname (method)">#refname</a></span>, <span class='object_link'><a href="Module.html#register_advanced_options-instance_method" title="Msf::Module#register_advanced_options (method)">#register_advanced_options</a></span>, <span class='object_link'><a href="Module.html#register_evasion_options-instance_method" title="Msf::Module#register_evasion_options (method)">#register_evasion_options</a></span>, <span class='object_link'><a href="Module.html#register_options-instance_method" title="Msf::Module#register_options (method)">#register_options</a></span>, <span class='object_link'><a href="Module.html#register_parent-instance_method" title="Msf::Module#register_parent (method)">#register_parent</a></span>, <span class='object_link'><a href="Module.html#replicant-instance_method" title="Msf::Module#replicant (method)">#replicant</a></span>, <span class='object_link'><a href="Module.html#search_filter-instance_method" title="Msf::Module#search_filter (method)">#search_filter</a></span>, <span class='object_link'><a href="Module.html#set_defaults-instance_method" title="Msf::Module#set_defaults (method)">#set_defaults</a></span>, <span class='object_link'><a href="Module.html#share_datastore-instance_method" title="Msf::Module#share_datastore (method)">#share_datastore</a></span>, <span class='object_link'><a href="Module.html#shortname-instance_method" title="Msf::Module#shortname (method)">#shortname</a></span>, <span class='object_link'><a href="Module.html#shortname-class_method" title="Msf::Module.shortname (method)">shortname</a></span>, <span class='object_link'><a href="Module.html#support_ipv6%3F-instance_method" title="Msf::Module#support_ipv6? (method)">#support_ipv6?</a></span>, <span class='object_link'><a href="Module.html#target_host-instance_method" title="Msf::Module#target_host (method)">#target_host</a></span>, <span class='object_link'><a href="Module.html#target_port-instance_method" title="Msf::Module#target_port (method)">#target_port</a></span>, <span class='object_link'><a href="Module.html#update_info-instance_method" title="Msf::Module#update_info (method)">#update_info</a></span>, <span class='object_link'><a href="Module.html#validate-instance_method" title="Msf::Module#validate (method)">#validate</a></span>, <span class='object_link'><a href="Module.html#vprint_debug-instance_method" title="Msf::Module#vprint_debug (method)">#vprint_debug</a></span>, <span class='object_link'><a href="Module.html#vprint_error-instance_method" title="Msf::Module#vprint_error (method)">#vprint_error</a></span>, <span class='object_link'><a href="Module.html#vprint_good-instance_method" title="Msf::Module#vprint_good (method)">#vprint_good</a></span>, <span class='object_link'><a href="Module.html#vprint_line-instance_method" title="Msf::Module#vprint_line (method)">#vprint_line</a></span>, <span class='object_link'><a href="Module.html#vprint_status-instance_method" title="Msf::Module#vprint_status (method)">#vprint_status</a></span>, <span class='object_link'><a href="Module.html#vprint_warning-instance_method" title="Msf::Module#vprint_warning (method)">#vprint_warning</a></span>, <span class='object_link'><a href="Module.html#workspace-instance_method" title="Msf::Module#workspace (method)">#workspace</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber.html" title="Rex::Ui::Subscriber (module)">Rex::Ui::Subscriber</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber.html#copy_ui-instance_method" title="Rex::Ui::Subscriber#copy_ui (method)">#copy_ui</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber.html#init_ui-instance_method" title="Rex::Ui::Subscriber#init_ui (method)">#init_ui</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber.html#reset_ui-instance_method" title="Rex::Ui::Subscriber#reset_ui (method)">#reset_ui</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Input.html#gets-instance_method" title="Rex::Ui::Subscriber::Input#gets (method)">#gets</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#flush-instance_method" title="Rex::Ui::Subscriber::Output#flush (method)">#flush</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print-instance_method" title="Rex::Ui::Subscriber::Output#print (method)">#print</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_blank_line-instance_method" title="Rex::Ui::Subscriber::Output#print_blank_line (method)">#print_blank_line</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_debug-instance_method" title="Rex::Ui::Subscriber::Output#print_debug (method)">#print_debug</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_error-instance_method" title="Rex::Ui::Subscriber::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_good-instance_method" title="Rex::Ui::Subscriber::Output#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_line-instance_method" title="Rex::Ui::Subscriber::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_status-instance_method" title="Rex::Ui::Subscriber::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="../Rex/Ui/Subscriber/Output.html#print_warning-instance_method" title="Rex::Ui::Subscriber::Output#print_warning (method)">#print_warning</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Msf::Payload (class)">Payload</a></span></tt>) <strong>initialize</strong>(info = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates an instance of a payload module using the supplied information.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='comment'># If this is a staged payload but there is no stage information,
</span>  <span class='comment'># then this is actually a stager + single combination.  Set up the
</span>  <span class='comment'># information hash accordingly.
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Payload</span><span class='op'>::</span><span class='const'>Single</span><span class='rparen'>)</span> <span class='kw'>and</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'>Msf</span><span class='op'>::</span><span class='const'>Payload</span><span class='op'>::</span><span class='const'>Stager</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Assembly</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Assembly</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Offsets</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Offsets</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Assembly</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stage</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Offsets</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='ivar'>@staged</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='ivar'>@staged</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the module info hash with the connection type
</span>  <span class='comment'># that is derived from the handler for this payload.  This is
</span>  <span class='comment'># used for compatibility filtering purposes.
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ConnectionType</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_connection_type'>connection_type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="append=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="append-instance_method">
  
    - (<tt>Object</tt>) <strong>append</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This attribute holds the string that should be appended to the buffer when
it&#39;s generated.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


491
492
493</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 491</span>

<span class='kw'>def</span> <span class='id identifier rubyid_append'>append</span>
  <span class='ivar'>@append</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="assoc_exploit=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="assoc_exploit-instance_method">
  
    - (<tt>Object</tt>) <strong>assoc_exploit</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If this payload is associated with an exploit, the assoc_exploit attribute
will point to that exploit instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


502
503
504</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 502</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span>
  <span class='ivar'>@assoc_exploit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="prepend=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="prepend-instance_method">
  
    - (<tt>Object</tt>) <strong>prepend</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This attribute holds the string that should be prepended to the buffer when
it&#39;s generated.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


486
487
488</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 486</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend'>prepend</span>
  <span class='ivar'>@prepend</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="prepend_encoder=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="prepend_encoder-instance_method">
  
    - (<tt>Object</tt>) <strong>prepend_encoder</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This attribute holds the string that should be prepended to the encoded
version of the payload (in front of the encoder as well).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


496
497
498</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 496</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_encoder'>prepend_encoder</span>
  <span class='ivar'>@prepend_encoder</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="type-class_method">
  
    + (<tt>Object</tt>) <strong>type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns MODULE_PAYLOAD to indicate that this is a payload module.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 104</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='kw'>return</span> <span class='const'>MODULE_PAYLOAD</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="assembly-instance_method">
  
    - (<tt>Object</tt>) <strong>assembly</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the assembly string that describes the payload if one exists.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assembly'>assembly</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Assembly</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assembly=-instance_method">
  
    - (<tt>Object</tt>) <strong>assembly=</strong>(asm) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the assembly string that describes the payload If this method is used
to define the payload, a payload with no offsets will be created</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 194</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assembly='>assembly=</span><span class='lparen'>(</span><span class='id identifier rubyid_asm'>asm</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Offsets</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Assembly</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_asm'>asm</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="badchars-instance_method">
  
    - (<tt>Object</tt>) <strong>badchars</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the string of bad characters for this payload, if any.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_badchars'>badchars</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build-instance_method">
  
    - (<tt>String</tt>) <strong>build</strong>(asm, off = {})  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If the payload has assembly that needs to be compiled, do so now.</p>

<p>Blobs will be cached in the framework&#39;s PayloadSet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>asm</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Assembly code to be assembled into a raw payload</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The final, assembled payload</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>ArgumentError if <code>asm</code> is blank</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="PayloadSet.html#check_blob_cache-instance_method" title="Msf::PayloadSet#check_blob_cache (method)">Msf::PayloadSet#check_blob_cache</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 515</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_asm'>asm</span><span class='comma'>,</span> <span class='id identifier rubyid_off'>off</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_asm'>asm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_asm'>asm</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Assembly must not be empty</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># Use the refname so blobs can be flushed when the module gets
</span>  <span class='comment'># reloaded and use the hash value to ensure that we&#39;re actually
</span>  <span class='comment'># getting the right blob for the given assembly.
</span>  <span class='id identifier rubyid_cache_key'>cache_key</span>   <span class='op'>=</span> <span class='id identifier rubyid_refname'>refname</span> <span class='op'>+</span> <span class='id identifier rubyid_asm'>asm</span><span class='period'>.</span><span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_cache_entry'>cache_entry</span> <span class='op'>=</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_check_blob_cache'>check_blob_cache</span><span class='lparen'>(</span><span class='id identifier rubyid_cache_key'>cache_key</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_off'>off</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_option'>option</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RAW</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_asm'>asm</span> <span class='op'>=</span> <span class='id identifier rubyid_asm'>asm</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_option'>option</span><span class='embexpr_end'>}</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_option'>option</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_off'>off</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_option'>option</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='comment'># If there is a valid cache entry, then we don&#39;t need to worry about
</span>  <span class='comment'># rebuilding the assembly
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_cache_entry'>cache_entry</span>
    <span class='comment'># Update the local offsets from the cache
</span>    <span class='id identifier rubyid_off'>off</span><span class='period'>.</span><span class='id identifier rubyid_each_key'>each_key</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_option'>option</span><span class='op'>|</span>
      <span class='id identifier rubyid_off'>off</span><span class='lbracket'>[</span><span class='id identifier rubyid_option'>option</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cache_entry'>cache_entry</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_option'>option</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>

    <span class='comment'># Return the cached payload blob
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_cache_entry'>cache_entry</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>end</span>

  <span class='comment'># Assemble the payload from the assembly
</span>  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>Array</span>
    <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cpu'>cpu</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_a'>a</span>
    <span class='kw'>when</span> <span class='const'>ARCH_X86</span>    <span class='kw'>then</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>Ia32</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>when</span> <span class='const'>ARCH_X86_64</span> <span class='kw'>then</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>X86_64</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>when</span> <span class='const'>ARCH_X64</span>    <span class='kw'>then</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>X86_64</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>when</span> <span class='const'>ARCH_PPC</span>    <span class='kw'>then</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>PowerPC</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>when</span> <span class='const'>ARCH_ARMLE</span>  <span class='kw'>then</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>ARM</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Broken payload </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> has arch unsupported with assembly: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Arch</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_caller'>caller</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='id identifier rubyid_sc'>sc</span> <span class='op'>=</span> <span class='const'>Metasm</span><span class='op'>::</span><span class='const'>Shellcode</span><span class='period'>.</span><span class='id identifier rubyid_assemble'>assemble</span><span class='lparen'>(</span><span class='id identifier rubyid_cpu'>cpu</span><span class='comma'>,</span> <span class='id identifier rubyid_asm'>asm</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_encoded'>encoded</span>

  <span class='comment'># Calculate the actual offsets now that it&#39;s been built
</span>  <span class='id identifier rubyid_off'>off</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_option'>option</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
    <span class='id identifier rubyid_off'>off</span><span class='lbracket'>[</span><span class='id identifier rubyid_option'>option</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_sc'>sc</span><span class='period'>.</span><span class='id identifier rubyid_offset_of_reloc'>offset_of_reloc</span><span class='lparen'>(</span><span class='id identifier rubyid_option'>option</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='comment'># Cache the payload blob
</span>  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_payloads'>payloads</span><span class='period'>.</span><span class='id identifier rubyid_add_blob_cache'>add_blob_cache</span><span class='lparen'>(</span><span class='id identifier rubyid_cache_key'>cache_key</span><span class='comma'>,</span> <span class='id identifier rubyid_sc'>sc</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_off'>off</span><span class='rparen'>)</span>

  <span class='comment'># Return a duplicated copy of the assembled payload
</span>  <span class='id identifier rubyid_sc'>sc</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compatible_convention?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>compatible_convention?</strong>(conv) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks to see if the supplied convention is compatible with this
payload&#39;s convention.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compatible_convention?'>compatible_convention?</span><span class='lparen'>(</span><span class='id identifier rubyid_conv'>conv</span><span class='rparen'>)</span>
  <span class='comment'># If we ourself don&#39;t have a convention or our convention is equal to
</span>  <span class='comment'># the one supplied, then we know we are compatible.
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_convention'>convention</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='kw'>or</span>
      <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_convention'>convention</span> <span class='op'>==</span> <span class='id identifier rubyid_conv'>conv</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='comment'># On the flip side, if we are a stager and the supplied convention is
</span>  <span class='comment'># nil, then we know it&#39;s compatible.
</span>  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_payload_type'>payload_type</span> <span class='op'>==</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stager</span><span class='rparen'>)</span> <span class='kw'>and</span>
         <span class='lparen'>(</span><span class='id identifier rubyid_conv'>conv</span> <span class='op'>==</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='comment'># Otherwise, the conventions don&#39;t match in some way or another, and as
</span>  <span class='comment'># such we deem ourself as not being compatible with the supplied
</span>  <span class='comment'># convention.
</span>  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compatible_encoders-instance_method">
  
    - (<tt>Object</tt>) <strong>compatible_encoders</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the array of compatible encoders for this payload instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


413
414
415
416
417
418
419
420
421
422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 413</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compatible_encoders'>compatible_encoders</span>
  <span class='id identifier rubyid_encoders'>encoders</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_encoders'>encoders</span><span class='period'>.</span><span class='id identifier rubyid_each_module_ranked'>each_module_ranked</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Arch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Platform</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>
    <span class='id identifier rubyid_encoders'>encoders</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span> <span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_encoders'>encoders</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compatible_nops-instance_method">
  
    - (<tt>Object</tt>) <strong>compatible_nops</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the array of compatible nops for this payload instance.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


427
428
429
430
431
432
433
434
435
436</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 427</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compatible_nops'>compatible_nops</span>
  <span class='id identifier rubyid_nops'>nops</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_nops'>nops</span><span class='period'>.</span><span class='id identifier rubyid_each_module_ranked'>each_module_ranked</span><span class='lparen'>(</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Arch</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>
    <span class='id identifier rubyid_nops'>nops</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_mod'>mod</span> <span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_nops'>nops</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connection_type-instance_method">
  
    - (<tt>Object</tt>) <strong>connection_type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the module&#39;s connection type, such as reverse, bind, noconn, or
whatever else the case may be.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 220</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_type'>connection_type</span>
  <span class='id identifier rubyid_handler_klass'>handler_klass</span><span class='period'>.</span><span class='id identifier rubyid_general_handler_type'>general_handler_type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="convention-instance_method">
  
    - (<tt>Object</tt>) <strong>convention</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the staging convention that the payload uses, if any.  This is used
to make sure that only compatible stagers and stages are built (where
assumptions are made about register/environment initialization state and
hand-off).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_convention'>convention</span>
  <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Convention</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate-instance_method">
  
    - (<tt>Object</tt>) <strong>generate</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generates the payload and returns the raw buffer to the caller.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


280
281
282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 280</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate'>generate</span>
  <span class='id identifier rubyid_internal_generate'>internal_generate</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handler_klass-instance_method">
  
    - (<tt>Object</tt>) <strong>handler_klass</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the connection associated with this payload, or none if there
isn&#39;t one.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handler_klass'>handler_klass</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Handler</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Handler</span><span class='op'>::</span><span class='const'>None</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="internal_generate-instance_method">
  
    - (<tt>Object</tt>) <strong>internal_generate</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate the payload using our local payload blob and offsets</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 578</span>

<span class='kw'>def</span> <span class='id identifier rubyid_internal_generate'>internal_generate</span>
  <span class='comment'># Build the payload, either by using the raw payload blob defined in the
</span>  <span class='comment'># module or by actually assembling it
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_assembly'>assembly</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_assembly'>assembly</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_assembly'>assembly</span><span class='comma'>,</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>end</span>

  <span class='comment'># If the payload is generated and there are offsets to substitute,
</span>  <span class='comment'># do that now.
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span> <span class='kw'>and</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_substitute_vars'>substitute_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='comma'>,</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_raw'>raw</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="merge_name-instance_method">
  
    - (<tt>Object</tt>) <strong>merge_name</strong>(info, val)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Merge the name to prefix the existing one and separate them with a comma</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


606
607
608
609
610
611
612</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 606</span>

<span class='kw'>def</span> <span class='id identifier rubyid_merge_name'>merge_name</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="offsets-instance_method">
  
    - (<tt>Object</tt>) <strong>offsets</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the offsets to variables that must be substitute, if any.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 202</span>

<span class='kw'>def</span> <span class='id identifier rubyid_offsets'>offsets</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Offsets</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_session-instance_method">
  
    - (<tt>Object</tt>) <strong>on_session</strong>(session) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Once an exploit completes and a session has been created on behalf of the
payload, the framework will call the payload&#39;s on_session notification
routine to allow it to manipulate the session prior to handing off control
to the user.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 450</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_session'>on_session</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>


  <span class='comment'># If this payload is associated with an exploit, inform the exploit
</span>  <span class='comment'># that a session has been created and potentially shut down any
</span>  <span class='comment'># open sockets. This allows active exploits to continue hammering
</span>  <span class='comment'># on a service until a session is created.
</span>  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='rparen'>)</span>

    <span class='comment'># Signal that a new session is created by calling the exploit&#39;s
</span>    <span class='comment'># on_new_session handler. The default behavior is to set an
</span>    <span class='comment'># instance variable, which the exploit will have to check.
</span>    <span class='kw'>begin</span>
      <span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='period'>.</span><span class='id identifier rubyid_on_new_session'>on_new_session</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>: on_new_session handler triggered exception: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_1</span><span class='rparen'>)</span>	<span class='kw'>rescue</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='comment'># Set the abort sockets flag only if the exploit is not passive
</span>    <span class='comment'># and the connection type is not &#39;find&#39;
</span>    <span class='kw'>if</span> <span class='lparen'>(</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='period'>.</span><span class='id identifier rubyid_exploit_type'>exploit_type</span> <span class='op'>==</span> <span class='const'>Exploit</span><span class='op'>::</span><span class='const'>Type</span><span class='op'>::</span><span class='const'>Remote</span><span class='rparen'>)</span> <span class='kw'>and</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='period'>.</span><span class='id identifier rubyid_passive?'>passive?</span> <span class='op'>==</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>and</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_connection_type'>connection_type</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>find</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
       <span class='rparen'>)</span>
       <span class='id identifier rubyid_assoc_exploit'>assoc_exploit</span><span class='period'>.</span><span class='id identifier rubyid_abort_sockets'>abort_sockets</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload-instance_method">
  
    - (<tt>Object</tt>) <strong>payload</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the raw payload that has not had variable substitution occur.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload'>payload</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_type-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type of payload, either single or staged.  Stage is the default
because singles and stagers are encouraged to include the Single and Stager
mixin which override the payload_type.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_type'>payload_type</span>
  <span class='kw'>return</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stage</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="payload_type_s-instance_method">
  
    - (<tt>Object</tt>) <strong>payload_type_s</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the string version of the payload type</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146
147
148
149
150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload_type_s'>payload_type_s</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_payload_type'>payload_type</span>
    <span class='kw'>when</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stage</span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stage</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stager</span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stager</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Single</span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>single</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="replace_var-instance_method">
  
    - (<tt>Object</tt>) <strong>replace_var</strong>(raw, name, offset, pack) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Replaces an individual variable in the supplied buffer at an offset using
the given pack type.  This is here to allow derived payloads the
opportunity to replace advanced variables.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


399
400
401</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 399</span>

<span class='kw'>def</span> <span class='id identifier rubyid_replace_var'>replace_var</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save_registers-instance_method">
  
    - (<tt>Object</tt>) <strong>save_registers</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The list of registers that should be saved by any NOP generators or
encoders, if possible.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_registers'>save_registers</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SaveRegisters</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="session-instance_method">
  
    - (<tt>Object</tt>) <strong>session</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the session class that is associated with this payload and will be
used to create a session as necessary.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


267
268
269</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 267</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session'>session</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Session</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="size-instance_method">
  
    - (<tt>Object</tt>) <strong>size</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the payload&#39;s size.  If the payload is staged, the size of the
first stage is returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


166
167
168
169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 166</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_pl'>pl</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_pl'>pl</span> <span class='op'>=</span> <span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>NoCompatiblePayloadError</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_pl'>pl</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_pl'>pl</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="staged?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>staged?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method returns whether or not this payload uses staging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_staged?'>staged?</span>
  <span class='lparen'>(</span><span class='ivar'>@staged</span> <span class='kw'>or</span> <span class='id identifier rubyid_payload_type'>payload_type</span> <span class='op'>==</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stager</span> <span class='kw'>or</span> <span class='id identifier rubyid_payload_type'>payload_type</span> <span class='op'>==</span> <span class='const'>Type</span><span class='op'>::</span><span class='const'>Stage</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="substitute_vars-instance_method">
  
    - (<tt>Object</tt>) <strong>substitute_vars</strong>(raw, offsets) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Substitutes variables with values from the module&#39;s datastore in the
supplied raw buffer for a given set of named offsets.  For instance, RHOST
is substituted with the RHOST value from the datastore which will have been
populated by the framework.</p>

<p>Supprted packing types:</p>
<ul><li>
<p>ADDR  (foo.com, 1.2.3.4)</p>
</li><li>
<p>ADDR6 (foo.com, fe80::1234:5678:8910:1234)</p>
</li><li>
<p>ADDR16MSB, ADD16LSB, ADDR22MSB, ADD22LSB (foo.com, 1.2.3.4) Advanced
packing types for 16/16 and 22/10 bits substitution. The 16 bits types uses
two offsets indicating where the 16 bits pair will be substituted, while
the 22 bits types uses two offsets indicating the instructions where the
22/10 bits pair will be substituted. Normally these are offsets to sethi
and or instructions on SPARC architecture.</p>
</li><li>
<p>HEX   (0x12345678, x41x42x43x44)</p>
</li><li>
<p>RAW   (raw bytes)</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 303</span>

<span class='kw'>def</span> <span class='id identifier rubyid_substitute_vars'>substitute_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='comma'>,</span> <span class='id identifier rubyid_offsets'>offsets</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_offsets'>offsets</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_info'>info</span><span class='op'>|</span>
    <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_pack'>pack</span> <span class='op'>=</span> <span class='id identifier rubyid_info'>info</span>

    <span class='comment'># Give the derived class a chance to substitute this variable
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_replace_var'>replace_var</span><span class='lparen'>(</span><span class='id identifier rubyid_raw'>raw</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='kw'>true</span><span class='rparen'>)</span>

    <span class='comment'># Now it&#39;s our turn...
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>

        <span class='comment'># Someone gave us a funky address (ipv6?)
</span>        <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>16</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IPv6 address specified for IPv4 payload.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR6</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>

        <span class='comment'># Convert v4 to the v6ish address
</span>        <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>4</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_nip'>nip</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fe80::5efe:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_nip'>nip</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR16MSB</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR16LSB</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR22MSB</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR22LSB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_resolv_nbo'>resolv_nbo</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>

        <span class='comment'># Someone gave us a funky address (ipv6?)
</span>        <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>16</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IPv6 address specified for IPv4 payload.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RAW</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='comment'># Just use the raw value...
</span>      <span class='kw'>else</span>
        <span class='comment'># Check to see if the value is a hex string.  If so, convert
</span>        <span class='comment'># it.
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\\x</span><span class='regexp_end'>/n</span></span>
            <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\x</span><span class='regexp_end'>/n</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>H*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
          <span class='kw'>elsif</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^0x</span><span class='regexp_end'>/n</span></span>
            <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_hex'>hex</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='comment'># NOTE:
</span>        <span class='comment'># Packing assumes integer format at this point, should fix...
</span>        <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='comment'># Substitute it
</span>      <span class='kw'>if</span> <span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR16MSB</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR16LSB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>2</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing value for payload offset, there must be two offsets.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR16LSB</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='lbracket'>[</span><span class='int'>2</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span>

      <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR22MSB</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR22LSB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_offset'>offset</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>2</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing value for payload offset, there must be two offsets.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_pack'>pack</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ADDR22LSB</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>N</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>V</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_hi'>hi</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>0xfffffc00</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span> <span class='op'>&gt;&gt;</span> <span class='int'>10</span>
        <span class='id identifier rubyid_lo'>lo</span> <span class='op'>=</span> <span class='int'>0x3ff</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_val'>val</span>

        <span class='id identifier rubyid_ins'>ins</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ins'>ins</span> <span class='op'>|</span> <span class='id identifier rubyid_hi'>hi</span>

        <span class='id identifier rubyid_ins'>ins</span> <span class='op'>=</span> <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ins'>ins</span> <span class='op'>|</span> <span class='id identifier rubyid_lo'>lo</span>

      <span class='kw'>else</span>
        <span class='id identifier rubyid_raw'>raw</span><span class='lbracket'>[</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>

      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_wlog'>wlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing value for payload offset </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>, skipping.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_3</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="symbol_lookup-instance_method">
  
    - (<tt>Object</tt>) <strong>symbol_lookup</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the method used by the payload to resolve symbols for the purpose
of calling functions, such as ws2ord.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 228</span>

<span class='kw'>def</span> <span class='id identifier rubyid_symbol_lookup'>symbol_lookup</span>
  <span class='id identifier rubyid_module_info'>module_info</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SymbolLookup</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    - (<tt>Object</tt>) <strong>type</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns MODULE_PAYLOAD to indicate that this is a payload module.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='kw'>return</span> <span class='const'>MODULE_PAYLOAD</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Nov  7 14:50:53 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.4).
</div>

  </body>
</html>