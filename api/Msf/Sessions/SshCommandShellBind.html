<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Msf::Sessions::SshCommandShellBind
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Msf::Sessions::SshCommandShellBind";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Sessions.html" title="Msf::Sessions (module)">Sessions</a></span></span>
     &raquo; 
    <span class="title">SshCommandShellBind</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Msf::Sessions::SshCommandShellBind
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="CommandShell.html" title="Msf::Sessions::CommandShell (class)">CommandShell</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="CommandShell.html" title="Msf::Sessions::CommandShell (class)">CommandShell</a></span></li>
          
            <li class="next">Msf::Sessions::SshCommandShellBind</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../Session/Comm.html" title="Msf::Session::Comm (module)">Msf::Session::Comm</a></span>, <span class='object_link'><a href="../../Rex/Post/Channel/Container.html" title="Rex::Post::Channel::Container (module)">Rex::Post::Channel::Container</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/msf/base/sessions/ssh_command_shell_bind.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class provides a session for SSH client connections, where Metasploit has authenticated to a remote SSH server. It is compatible with the Net::SSH library.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason (module)">ChannelFailureReason</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="SshCommandShellBind/TcpClientChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpClientChannel (class)">TcpClientChannel</a></span>, <span class='object_link'><a href="SshCommandShellBind/TcpServerChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpServerChannel (class)">TcpServerChannel</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sock-instance_method" title="#sock (instance method)">#<strong>sock</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute sock.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssh_connection-instance_method" title="#ssh_connection (instance method)">#<strong>ssh_connection</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute ssh_connection.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../Rex/Post/Channel/Container.html" title="Rex::Post::Channel::Container (module)">Rex::Post::Channel::Container</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Post/Channel/Container.html#channels-instance_method" title="Rex::Post::Channel::Container#channels (method)">#channels</a></span></p>

  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="CommandShell.html" title="Msf::Sessions::CommandShell (class)">CommandShell</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="CommandShell.html#arch-instance_method" title="Msf::Sessions::CommandShell#arch (method)">#arch</a></span>, <span class='object_link'><a href="CommandShell.html#banner-instance_method" title="Msf::Sessions::CommandShell#banner (method)">#banner</a></span>, <span class='object_link'><a href="CommandShell.html#max_threads-instance_method" title="Msf::Sessions::CommandShell#max_threads (method)">#max_threads</a></span>, <span class='object_link'><a href="CommandShell.html#platform-instance_method" title="Msf::Sessions::CommandShell#platform (method)">#platform</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Session/Interactive.html" title="Msf::Session::Interactive (module)">Msf::Session::Interactive</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session/Interactive.html#rstream-instance_method" title="Msf::Session::Interactive#rstream (method)">#rstream</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../Rex/Ui/Interactive.html" title="Rex::Ui::Interactive (module)">Rex::Ui::Interactive</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Interactive.html#completed-instance_method" title="Rex::Ui::Interactive#completed (method)">#completed</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#interacting-instance_method" title="Rex::Ui::Interactive#interacting (method)">#interacting</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#next_session-instance_method" title="Rex::Ui::Interactive#next_session (method)">#next_session</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#on_command_proc-instance_method" title="Rex::Ui::Interactive#on_command_proc (method)">#on_command_proc</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#on_print_proc-instance_method" title="Rex::Ui::Interactive#on_print_proc (method)">#on_print_proc</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#on_run_command_error_proc-instance_method" title="Rex::Ui::Interactive#on_run_command_error_proc (method)">#on_run_command_error_proc</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#orig_suspend-instance_method" title="Rex::Ui::Interactive#orig_suspend (method)">#orig_suspend</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#orig_usr1-instance_method" title="Rex::Ui::Interactive#orig_usr1 (method)">#orig_usr1</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#orig_winch-instance_method" title="Rex::Ui::Interactive#orig_winch (method)">#orig_winch</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Subscriber/Input.html#user_input-instance_method" title="Rex::Ui::Subscriber::Input#user_input (method)">#user_input</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#user_output-instance_method" title="Rex::Ui::Subscriber::Output#user_output (method)">#user_output</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Session.html" title="Msf::Session (module)">Msf::Session</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session.html#alive-instance_method" title="Msf::Session#alive (method)">#alive</a></span>, <span class='object_link'><a href="../Session.html#db_record-instance_method" title="Msf::Session#db_record (method)">#db_record</a></span>, <span class='object_link'><a href="../Session.html#exploit-instance_method" title="Msf::Session#exploit (method)">#exploit</a></span>, <span class='object_link'><a href="../Session.html#exploit_datastore-instance_method" title="Msf::Session#exploit_datastore (method)">#exploit_datastore</a></span>, <span class='object_link'><a href="../Session.html#exploit_task-instance_method" title="Msf::Session#exploit_task (method)">#exploit_task</a></span>, <span class='object_link'><a href="../Session.html#exploit_uuid-instance_method" title="Msf::Session#exploit_uuid (method)">#exploit_uuid</a></span>, <span class='object_link'><a href="../Session.html#framework-instance_method" title="Msf::Session#framework (method)">#framework</a></span>, <span class='object_link'><a href="../Session.html#info-instance_method" title="Msf::Session#info (method)">#info</a></span>, <span class='object_link'><a href="../Session.html#machine_id-instance_method" title="Msf::Session#machine_id (method)">#machine_id</a></span>, <span class='object_link'><a href="../Session.html#payload_uuid-instance_method" title="Msf::Session#payload_uuid (method)">#payload_uuid</a></span>, <span class='object_link'><a href="../Session.html#routes-instance_method" title="Msf::Session#routes (method)">#routes</a></span>, <span class='object_link'><a href="../Session.html#sid-instance_method" title="Msf::Session#sid (method)">#sid</a></span>, <span class='object_link'><a href="../Session.html#sname-instance_method" title="Msf::Session#sname (method)">#sname</a></span>, <span class='object_link'><a href="../Session.html#target_host-instance_method" title="Msf::Session#target_host (method)">#target_host</a></span>, <span class='object_link'><a href="../Session.html#target_port-instance_method" title="Msf::Session#target_port (method)">#target_port</a></span>, <span class='object_link'><a href="../Session.html#username-instance_method" title="Msf::Session#username (method)">#username</a></span>, <span class='object_link'><a href="../Session.html#uuid-instance_method" title="Msf::Session#uuid (method)">#uuid</a></span>, <span class='object_link'><a href="../Session.html#via-instance_method" title="Msf::Session#via (method)">#via</a></span>, <span class='object_link'><a href="../Session.html#workspace-instance_method" title="Msf::Session#workspace (method)">#workspace</a></span></p>

  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Framework/Offspring.html" title="Msf::Framework::Offspring (module)">Framework::Offspring</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Framework/Offspring.html#framework-instance_method" title="Msf::Framework::Offspring#framework (method)">#framework</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bootstrap-instance_method" title="#bootstrap (instance method)">#<strong>bootstrap</strong>(datastore = {}, handler = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">#<strong>cleanup</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">#<strong>create</strong>(params)  &#x21d2; TcpClientChannel </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a network socket using this session.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_client_channel-instance_method" title="#create_client_channel (instance method)">#<strong>create_client_channel</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_server_channel-instance_method" title="#create_server_channel (instance method)">#<strong>create_server_channel</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#desc-instance_method" title="#desc (instance method)">#<strong>desc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(ssh_connection, opts = {})  &#x21d2; SshCommandShellBind </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a sessions instance from an SshConnection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_got_remote_connection-instance_method" title="#on_got_remote_connection (instance method)">#<strong>on_got_remote_connection</strong>(_session, channel, packet)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The SSH server has told us that thereâ€™s a port forwarding request.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop_server_channel-instance_method" title="#stop_server_channel (instance method)">#<strong>stop_server_channel</strong>(host, port)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#supports_udp%3F-instance_method" title="#supports_udp? (instance method)">#<strong>supports_udp?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Post/Channel/Container.html" title="Rex::Post::Channel::Container (module)">Rex::Post::Channel::Container</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Post/Channel/Container.html#add_channel-instance_method" title="Rex::Post::Channel::Container#add_channel (method)">#add_channel</a></span>, <span class='object_link'><a href="../../Rex/Post/Channel/Container.html#find_channel-instance_method" title="Rex::Post::Channel::Container#find_channel (method)">#find_channel</a></span>, <span class='object_link'><a href="../../Rex/Post/Channel/Container.html#initialize_channels-instance_method" title="Rex::Post::Channel::Container#initialize_channels (method)">#initialize_channels</a></span>, <span class='object_link'><a href="../../Rex/Post/Channel/Container.html#remove_channel-instance_method" title="Rex::Post::Channel::Container#remove_channel (method)">#remove_channel</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="CommandShell.html" title="Msf::Sessions::CommandShell (class)">CommandShell</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="CommandShell.html#_file_transfer-instance_method" title="Msf::Sessions::CommandShell#_file_transfer (method)">#_file_transfer</a></span>, <span class='object_link'><a href="CommandShell.html#_glue_cmdline_escape-class_method" title="Msf::Sessions::CommandShell._glue_cmdline_escape (method)">_glue_cmdline_escape</a></span>, <span class='object_link'><a href="CommandShell.html#_interact-instance_method" title="Msf::Sessions::CommandShell#_interact (method)">#_interact</a></span>, <span class='object_link'><a href="CommandShell.html#_interact_stream-instance_method" title="Msf::Sessions::CommandShell#_interact_stream (method)">#_interact_stream</a></span>, <span class='object_link'><a href="CommandShell.html#abort_foreground_supported-instance_method" title="Msf::Sessions::CommandShell#abort_foreground_supported (method)">#abort_foreground_supported</a></span>, <span class='object_link'><a href="CommandShell.html#binary_exists-class_method" title="Msf::Sessions::CommandShell.binary_exists (method)">binary_exists</a></span>, <span class='object_link'><a href="CommandShell.html#binary_exists-instance_method" title="Msf::Sessions::CommandShell#binary_exists (method)">#binary_exists</a></span>, <span class='object_link'><a href="CommandShell.html#can_cleanup_files-class_method" title="Msf::Sessions::CommandShell.can_cleanup_files (method)">can_cleanup_files</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_background-instance_method" title="Msf::Sessions::CommandShell#cmd_background (method)">#cmd_background</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_background_help-instance_method" title="Msf::Sessions::CommandShell#cmd_background_help (method)">#cmd_background_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_download-instance_method" title="Msf::Sessions::CommandShell#cmd_download (method)">#cmd_download</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_download_help-instance_method" title="Msf::Sessions::CommandShell#cmd_download_help (method)">#cmd_download_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_help-instance_method" title="Msf::Sessions::CommandShell#cmd_help (method)">#cmd_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_help_help-instance_method" title="Msf::Sessions::CommandShell#cmd_help_help (method)">#cmd_help_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_irb-instance_method" title="Msf::Sessions::CommandShell#cmd_irb (method)">#cmd_irb</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_irb_help-instance_method" title="Msf::Sessions::CommandShell#cmd_irb_help (method)">#cmd_irb_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_pry-instance_method" title="Msf::Sessions::CommandShell#cmd_pry (method)">#cmd_pry</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_pry_help-instance_method" title="Msf::Sessions::CommandShell#cmd_pry_help (method)">#cmd_pry_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_resource-instance_method" title="Msf::Sessions::CommandShell#cmd_resource (method)">#cmd_resource</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_resource_help-instance_method" title="Msf::Sessions::CommandShell#cmd_resource_help (method)">#cmd_resource_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_sessions-instance_method" title="Msf::Sessions::CommandShell#cmd_sessions (method)">#cmd_sessions</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_sessions_help-instance_method" title="Msf::Sessions::CommandShell#cmd_sessions_help (method)">#cmd_sessions_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_shell-instance_method" title="Msf::Sessions::CommandShell#cmd_shell (method)">#cmd_shell</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_shell_help-instance_method" title="Msf::Sessions::CommandShell#cmd_shell_help (method)">#cmd_shell_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_source-instance_method" title="Msf::Sessions::CommandShell#cmd_source (method)">#cmd_source</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_source_help-instance_method" title="Msf::Sessions::CommandShell#cmd_source_help (method)">#cmd_source_help</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_upload-instance_method" title="Msf::Sessions::CommandShell#cmd_upload (method)">#cmd_upload</a></span>, <span class='object_link'><a href="CommandShell.html#cmd_upload_help-instance_method" title="Msf::Sessions::CommandShell#cmd_upload_help (method)">#cmd_upload_help</a></span>, <span class='object_link'><a href="CommandShell.html#commands-instance_method" title="Msf::Sessions::CommandShell#commands (method)">#commands</a></span>, <span class='object_link'><a href="CommandShell.html#docs_dir-instance_method" title="Msf::Sessions::CommandShell#docs_dir (method)">#docs_dir</a></span>, <span class='object_link'><a href="CommandShell.html#escape_arg-instance_method" title="Msf::Sessions::CommandShell#escape_arg (method)">#escape_arg</a></span>, <span class='object_link'><a href="CommandShell.html#execute_file-instance_method" title="Msf::Sessions::CommandShell#execute_file (method)">#execute_file</a></span>, <span class='object_link'><a href="CommandShell.html#process_autoruns-instance_method" title="Msf::Sessions::CommandShell#process_autoruns (method)">#process_autoruns</a></span>, <span class='object_link'><a href="CommandShell.html#run_builtin_cmd-instance_method" title="Msf::Sessions::CommandShell#run_builtin_cmd (method)">#run_builtin_cmd</a></span>, <span class='object_link'><a href="CommandShell.html#run_single-instance_method" title="Msf::Sessions::CommandShell#run_single (method)">#run_single</a></span>, <span class='object_link'><a href="CommandShell.html#shell_close-instance_method" title="Msf::Sessions::CommandShell#shell_close (method)">#shell_close</a></span>, <span class='object_link'><a href="CommandShell.html#shell_command-instance_method" title="Msf::Sessions::CommandShell#shell_command (method)">#shell_command</a></span>, <span class='object_link'><a href="CommandShell.html#shell_init-instance_method" title="Msf::Sessions::CommandShell#shell_init (method)">#shell_init</a></span>, <span class='object_link'><a href="CommandShell.html#shell_read-instance_method" title="Msf::Sessions::CommandShell#shell_read (method)">#shell_read</a></span>, <span class='object_link'><a href="CommandShell.html#shell_write-instance_method" title="Msf::Sessions::CommandShell#shell_write (method)">#shell_write</a></span>, <span class='object_link'><a href="CommandShell.html#type-class_method" title="Msf::Sessions::CommandShell.type (method)">type</a></span>, <span class='object_link'><a href="CommandShell.html#type-instance_method" title="Msf::Sessions::CommandShell#type (method)">#type</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Ui/Text/Resource.html" title="Rex::Ui::Text::Resource (module)">Rex::Ui::Text::Resource</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Text/Resource.html#load_resource-instance_method" title="Rex::Ui::Text::Resource#load_resource (method)">#load_resource</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Scriptable.html" title="Msf::Sessions::Scriptable (module)">Scriptable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Scriptable.html#execute_file-instance_method" title="Msf::Sessions::Scriptable#execute_file (method)">#execute_file</a></span>, <span class='object_link'><a href="Scriptable.html#execute_script-instance_method" title="Msf::Sessions::Scriptable#execute_script (method)">#execute_script</a></span>, <span class='object_link'><a href="Scriptable.html#included-class_method" title="Msf::Sessions::Scriptable.included (method)">included</a></span>, <span class='object_link'><a href="Scriptable.html#legacy_script_to_post_module-instance_method" title="Msf::Sessions::Scriptable#legacy_script_to_post_module (method)">#legacy_script_to_post_module</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html" title="Msf::Session::Provider::SingleCommandShell (module)">Msf::Session::Provider::SingleCommandShell</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#command_termination-instance_method" title="Msf::Session::Provider::SingleCommandShell#command_termination (method)">#command_termination</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#set_is_echo_shell-instance_method" title="Msf::Session::Provider::SingleCommandShell#set_is_echo_shell (method)">#set_is_echo_shell</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_close-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_close (method)">#shell_close</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_command_token-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_command_token (method)">#shell_command_token</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_command_token_base-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_command_token_base (method)">#shell_command_token_base</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_command_token_unix-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_command_token_unix (method)">#shell_command_token_unix</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_command_token_win32-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_command_token_win32 (method)">#shell_command_token_win32</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_init-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_init (method)">#shell_init</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_read-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_read (method)">#shell_read</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_read_until_token-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_read_until_token (method)">#shell_read_until_token</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#shell_write-instance_method" title="Msf::Session::Provider::SingleCommandShell#shell_write (method)">#shell_write</a></span>, <span class='object_link'><a href="../Session/Provider/SingleCommandShell.html#to_cmd-instance_method" title="Msf::Session::Provider::SingleCommandShell#to_cmd (method)">#to_cmd</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Session/Basic.html" title="Msf::Session::Basic (module)">Msf::Session::Basic</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session/Basic.html#_interact-instance_method" title="Msf::Session::Basic#_interact (method)">#_interact</a></span>, <span class='object_link'><a href="../Session/Basic.html#type-instance_method" title="Msf::Session::Basic#type (method)">#type</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Session/Interactive.html" title="Msf::Session::Interactive (module)">Msf::Session::Interactive</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session/Interactive.html#_interact-instance_method" title="Msf::Session::Interactive#_interact (method)">#_interact</a></span>, <span class='object_link'><a href="../Session/Interactive.html#_interact_complete-instance_method" title="Msf::Session::Interactive#_interact_complete (method)">#_interact_complete</a></span>, <span class='object_link'><a href="../Session/Interactive.html#_interrupt-instance_method" title="Msf::Session::Interactive#_interrupt (method)">#_interrupt</a></span>, <span class='object_link'><a href="../Session/Interactive.html#_suspend-instance_method" title="Msf::Session::Interactive#_suspend (method)">#_suspend</a></span>, <span class='object_link'><a href="../Session/Interactive.html#_usr1-instance_method" title="Msf::Session::Interactive#_usr1 (method)">#_usr1</a></span>, <span class='object_link'><a href="../Session/Interactive.html#abort_foreground-instance_method" title="Msf::Session::Interactive#abort_foreground (method)">#abort_foreground</a></span>, <span class='object_link'><a href="../Session/Interactive.html#abort_foreground_supported-instance_method" title="Msf::Session::Interactive#abort_foreground_supported (method)">#abort_foreground_supported</a></span>, <span class='object_link'><a href="../Session/Interactive.html#comm_channel-instance_method" title="Msf::Session::Interactive#comm_channel (method)">#comm_channel</a></span>, <span class='object_link'><a href="../Session/Interactive.html#interactive%3F-instance_method" title="Msf::Session::Interactive#interactive? (method)">#interactive?</a></span>, <span class='object_link'><a href="../Session/Interactive.html#kill-instance_method" title="Msf::Session::Interactive#kill (method)">#kill</a></span>, <span class='object_link'><a href="../Session/Interactive.html#run_cmd-instance_method" title="Msf::Session::Interactive#run_cmd (method)">#run_cmd</a></span>, <span class='object_link'><a href="../Session/Interactive.html#tunnel_local-instance_method" title="Msf::Session::Interactive#tunnel_local (method)">#tunnel_local</a></span>, <span class='object_link'><a href="../Session/Interactive.html#tunnel_peer-instance_method" title="Msf::Session::Interactive#tunnel_peer (method)">#tunnel_peer</a></span>, <span class='object_link'><a href="../Session/Interactive.html#user_want_abort%3F-instance_method" title="Msf::Session::Interactive#user_want_abort? (method)">#user_want_abort?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Ui/Interactive.html" title="Rex::Ui::Interactive (module)">Rex::Ui::Interactive</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Interactive.html#_interact-instance_method" title="Rex::Ui::Interactive#_interact (method)">#_interact</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_interact_complete-instance_method" title="Rex::Ui::Interactive#_interact_complete (method)">#_interact_complete</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_interrupt-instance_method" title="Rex::Ui::Interactive#_interrupt (method)">#_interrupt</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_local_fd-instance_method" title="Rex::Ui::Interactive#_local_fd (method)">#_local_fd</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_remote_fd-instance_method" title="Rex::Ui::Interactive#_remote_fd (method)">#_remote_fd</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_stream_read_local_write_remote-instance_method" title="Rex::Ui::Interactive#_stream_read_local_write_remote (method)">#_stream_read_local_write_remote</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_stream_read_remote_write_local-instance_method" title="Rex::Ui::Interactive#_stream_read_remote_write_local (method)">#_stream_read_remote_write_local</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_suspend-instance_method" title="Rex::Ui::Interactive#_suspend (method)">#_suspend</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#_winch-instance_method" title="Rex::Ui::Interactive#_winch (method)">#_winch</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#detach-instance_method" title="Rex::Ui::Interactive#detach (method)">#detach</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#handle_suspend-instance_method" title="Rex::Ui::Interactive#handle_suspend (method)">#handle_suspend</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#handle_usr1-instance_method" title="Rex::Ui::Interactive#handle_usr1 (method)">#handle_usr1</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#handle_winch-instance_method" title="Rex::Ui::Interactive#handle_winch (method)">#handle_winch</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#interact-instance_method" title="Rex::Ui::Interactive#interact (method)">#interact</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#interact_stream-instance_method" title="Rex::Ui::Interactive#interact_stream (method)">#interact_stream</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#prompt-instance_method" title="Rex::Ui::Interactive#prompt (method)">#prompt</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#prompt_yesno-instance_method" title="Rex::Ui::Interactive#prompt_yesno (method)">#prompt_yesno</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#restore_suspend-instance_method" title="Rex::Ui::Interactive#restore_suspend (method)">#restore_suspend</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#restore_usr1-instance_method" title="Rex::Ui::Interactive#restore_usr1 (method)">#restore_usr1</a></span>, <span class='object_link'><a href="../../Rex/Ui/Interactive.html#restore_winch-instance_method" title="Rex::Ui::Interactive#restore_winch (method)">#restore_winch</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Ui/Subscriber.html" title="Rex::Ui::Subscriber (module)">Rex::Ui::Subscriber</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Subscriber.html#copy_ui-instance_method" title="Rex::Ui::Subscriber#copy_ui (method)">#copy_ui</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber.html#init_ui-instance_method" title="Rex::Ui::Subscriber#init_ui (method)">#init_ui</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber.html#reset_ui-instance_method" title="Rex::Ui::Subscriber#reset_ui (method)">#reset_ui</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Ui/Subscriber/Input.html" title="Rex::Ui::Subscriber::Input (module)">Rex::Ui::Subscriber::Input</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Subscriber/Input.html#gets-instance_method" title="Rex::Ui::Subscriber::Input#gets (method)">#gets</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html" title="Rex::Ui::Subscriber::Output (module)">Rex::Ui::Subscriber::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#flush-instance_method" title="Rex::Ui::Subscriber::Output#flush (method)">#flush</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print-instance_method" title="Rex::Ui::Subscriber::Output#print (method)">#print</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_blank_line-instance_method" title="Rex::Ui::Subscriber::Output#print_blank_line (method)">#print_blank_line</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_error-instance_method" title="Rex::Ui::Subscriber::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_good-instance_method" title="Rex::Ui::Subscriber::Output#print_good (method)">#print_good</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_line-instance_method" title="Rex::Ui::Subscriber::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_status-instance_method" title="Rex::Ui::Subscriber::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="../../Rex/Ui/Subscriber/Output.html#print_warning-instance_method" title="Rex::Ui::Subscriber::Output#print_warning (method)">#print_warning</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Session.html" title="Msf::Session (module)">Msf::Session</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Session.html#alive%3F-instance_method" title="Msf::Session#alive? (method)">#alive?</a></span>, <span class='object_link'><a href="../Session.html#comm_channel-instance_method" title="Msf::Session#comm_channel (method)">#comm_channel</a></span>, <span class='object_link'><a href="../Session.html#dead%3F-instance_method" title="Msf::Session#dead? (method)">#dead?</a></span>, <span class='object_link'><a href="../Session.html#inspect-instance_method" title="Msf::Session#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="../Session.html#interactive%3F-instance_method" title="Msf::Session#interactive? (method)">#interactive?</a></span>, <span class='object_link'><a href="../Session.html#kill-instance_method" title="Msf::Session#kill (method)">#kill</a></span>, <span class='object_link'><a href="../Session.html#log_file_name-instance_method" title="Msf::Session#log_file_name (method)">#log_file_name</a></span>, <span class='object_link'><a href="../Session.html#log_source-instance_method" title="Msf::Session#log_source (method)">#log_source</a></span>, <span class='object_link'><a href="../Session.html#name-instance_method" title="Msf::Session#name (method)">#name</a></span>, <span class='object_link'><a href="../Session.html#name=-instance_method" title="Msf::Session#name= (method)">#name=</a></span>, <span class='object_link'><a href="../Session.html#register%3F-instance_method" title="Msf::Session#register? (method)">#register?</a></span>, <span class='object_link'><a href="../Session.html#session_host-instance_method" title="Msf::Session#session_host (method)">#session_host</a></span>, <span class='object_link'><a href="../Session.html#session_host=-instance_method" title="Msf::Session#session_host= (method)">#session_host=</a></span>, <span class='object_link'><a href="../Session.html#session_port-instance_method" title="Msf::Session#session_port (method)">#session_port</a></span>, <span class='object_link'><a href="../Session.html#session_port=-instance_method" title="Msf::Session#session_port= (method)">#session_port=</a></span>, <span class='object_link'><a href="../Session.html#session_type-instance_method" title="Msf::Session#session_type (method)">#session_type</a></span>, <span class='object_link'><a href="../Session.html#set_from_exploit-instance_method" title="Msf::Session#set_from_exploit (method)">#set_from_exploit</a></span>, <span class='object_link'><a href="../Session.html#set_via-instance_method" title="Msf::Session#set_via (method)">#set_via</a></span>, <span class='object_link'><a href="../Session.html#tunnel_local-instance_method" title="Msf::Session#tunnel_local (method)">#tunnel_local</a></span>, <span class='object_link'><a href="../Session.html#tunnel_peer-instance_method" title="Msf::Session#tunnel_peer (method)">#tunnel_peer</a></span>, <span class='object_link'><a href="../Session.html#tunnel_to_s-instance_method" title="Msf::Session#tunnel_to_s (method)">#tunnel_to_s</a></span>, <span class='object_link'><a href="../Session.html#type-class_method" title="Msf::Session.type (method)">type</a></span>, <span class='object_link'><a href="../Session.html#type-instance_method" title="Msf::Session#type (method)">#type</a></span>, <span class='object_link'><a href="../Session.html#via_exploit-instance_method" title="Msf::Session#via_exploit (method)">#via_exploit</a></span>, <span class='object_link'><a href="../Session.html#via_payload-instance_method" title="Msf::Session#via_payload (method)">#via_payload</a></span></p>

  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(ssh_connection, opts = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Msf::Sessions::SshCommandShellBind (class)">SshCommandShellBind</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a sessions instance from an SshConnection. This will handle creating a new command stream.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ssh_connection</span>
      
      
        <span class='type'>(<tt>Net::SSH::Connection</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SSH connection to create a session instance for.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Optional parameters to pass to the session object.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


225
226
227
228
229
230
231
232
233
234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 225</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_ssh_connection'>ssh_connection</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@ssh_connection</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_connection'>ssh_connection</span>
  <span class='ivar'>@sock</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_connection'>ssh_connection</span><span class='period'>.</span><span class='id identifier rubyid_transport'>transport</span><span class='period'>.</span><span class='id identifier rubyid_socket'>socket</span>
  <span class='ivar'>@server_channels</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_initialize_channels'>initialize_channels</span>
  <span class='ivar'>@channel_ticker</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='comment'># Be alerted to reverse port forward connections (once we start listening on a port)
</span>  <span class='id identifier rubyid_ssh_connection'>ssh_connection</span><span class='period'>.</span><span class='id identifier rubyid_on_open_channel'>on_open_channel</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>forwarded-tcpip</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span><span class='lparen'>(</span><span class='symbol'>:on_got_remote_connection</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="sock-instance_method">
  
    #<strong>sock</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute sock.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


434
435
436</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 434</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sock'>sock</span>
  <span class='ivar'>@sock</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="ssh_connection-instance_method">
  
    #<strong>ssh_connection</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute ssh_connection.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


434
435
436</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 434</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssh_connection'>ssh_connection</span>
  <span class='ivar'>@ssh_connection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="bootstrap-instance_method">
  
    #<strong>bootstrap</strong>(datastore = {}, handler = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 238</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bootstrap'>bootstrap</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># this won&#39;t work after the rstream is initialized, so do it first
</span>  <span class='ivar'>@platform</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework.html" title="Metasploit::Framework (module)">Framework</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/Ssh.html" title="Metasploit::Framework::Ssh (module)">Ssh</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/Ssh/Platform.html" title="Metasploit::Framework::Ssh::Platform (module)">Platform</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_platform'><span class='object_link'><a href="../../Metasploit/Framework/Ssh/Platform.html#get_platform-class_method" title="Metasploit::Framework::Ssh::Platform.get_platform (method)">get_platform</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_ssh_connection'>ssh_connection</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@platform</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>windows</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Sessions.html" title="Msf::Sessions (module)">Sessions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WindowsEscaping.html" title="Msf::Sessions::WindowsEscaping (module)">WindowsEscaping</a></span></span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='const'><span class='object_link'><a href="../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework.html" title="Metasploit::Framework (module)">Framework</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/Ssh.html" title="Metasploit::Framework::Ssh (module)">Ssh</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/Ssh/Platform.html" title="Metasploit::Framework::Ssh::Platform (module)">Platform</a></span></span><span class='period'>.</span><span class='id identifier rubyid_is_posix'><span class='object_link'><a href="../../Metasploit/Framework/Ssh/Platform.html#is_posix-class_method" title="Metasploit::Framework::Ssh::Platform.is_posix (method)">is_posix</a></span></span><span class='lparen'>(</span><span class='ivar'>@platform</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Sessions.html" title="Msf::Sessions (module)">Sessions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="UnixEscaping.html" title="Msf::Sessions::UnixEscaping (module)">UnixEscaping</a></span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>SSH</span><span class='op'>::</span><span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown platform: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_platform'>platform</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># if the platform is known, it was recovered by communicating with the device, so skip verification, also not all
</span>  <span class='comment'># shells accessed through SSH may respond to the echo command issued for verification as expected
</span>  <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AutoVerifySession</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>&amp;=</span> <span class='ivar'>@platform</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='ivar'>@rstream</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>SSH</span><span class='op'>::</span><span class='const'>CommandStream</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_ssh_connection'>ssh_connection</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>logger:</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_lsock'>lsock</span>
  <span class='kw'>super</span>

  <span class='ivar'>@info</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SSH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_username'>username</span><span class='embexpr_end'>}</span><span class='tstring_content'> @ </span><span class='embexpr_beg'>#{</span><span class='ivar'>@peer_info</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cleanup-instance_method">
  
    #<strong>cleanup</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


427
428
429
430
431
432</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 427</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span>
  <span class='id identifier rubyid_channels'>channels</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:close</span><span class='rparen'>)</span>
  <span class='ivar'>@server_channels</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:close</span><span class='rparen'>)</span>

  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create-instance_method">
  
    #<strong>create</strong>(params)  &#x21d2; <tt><span class='object_link'><a href="SshCommandShellBind/TcpClientChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpClientChannel (class)">TcpClientChannel</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a network socket using this session. At this time, only TCP client connections can be made (like SSH port forwarding) while TCP server sockets can not be opened (SSH reverse port forwarding). The SSH specification does not define a UDP channel, so that is not supported either.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Rex::Socket::Parameters</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The parameters that should be used to open the socket.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="SshCommandShellBind/TcpClientChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpClientChannel (class)">TcpClientChannel</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The connected TCP client channel.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>Rex::ConnectionError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If the connection fails, timesout or is not supported, a ConnectionError will be raised.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='comment'># Notify handlers before we create the socket
</span>  <span class='id identifier rubyid_notify_before_socket_create'>notify_before_socket_create</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_proto'>proto</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_server'>server</span>
      <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='id identifier rubyid_create_server_channel'>create_server_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='id identifier rubyid_create_client_channel'>create_client_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_proto'>proto</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>udp</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>ConnectionError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span> <span class='label'>reason:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UDP sockets are not supported by SSH sessions.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>ConnectionError</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sock'>sock</span>

  <span class='comment'># Notify now that we&#39;ve created the socket
</span>  <span class='id identifier rubyid_notify_socket_created'>notify_socket_created</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_sock'>sock</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sock'>sock</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_client_channel-instance_method">
  
    #<strong>create_client_channel</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_client_channel'>create_client_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_msf_channel'>msf_channel</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_mutex'>mutex</span> <span class='op'>=</span> <span class='const'>Mutex</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_condition'>condition</span> <span class='op'>=</span> <span class='const'>ConditionVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_opened'>opened</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_ssh_channel'>ssh_channel</span> <span class='op'>=</span> <span class='ivar'>@ssh_connection</span><span class='period'>.</span><span class='id identifier rubyid_open_channel'>open_channel</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>direct-tcpip</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span> <span class='symbol'>:long</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span> <span class='symbol'>:long</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='op'>|</span>
    <span class='id identifier rubyid_dlog'><span class='object_link'><a href="../../top-level-namespace.html#dlog-instance_method" title="#dlog (method)">dlog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new direct-tcpip channel opened to </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_is_ipv6?'>is_ipv6?</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>[</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>]</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_opened'>opened</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_condition'>condition</span><span class='period'>.</span><span class='id identifier rubyid_signal'>signal</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_failure_reason_code'>failure_reason_code</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_ssh_channel'>ssh_channel</span><span class='period'>.</span><span class='id identifier rubyid_on_open_failed'>on_open_failed</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__ch'>_ch</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='op'>|</span>
    <span class='id identifier rubyid_failure_reason_code'>failure_reason_code</span> <span class='op'>=</span> <span class='id identifier rubyid_code'>code</span>
    <span class='id identifier rubyid_wlog'><span class='object_link'><a href="../../top-level-namespace.html#wlog-instance_method" title="#wlog (method)">wlog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failed to open SSH channel (code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_code'>code</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>, description: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_desc'>desc</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_condition'>condition</span><span class='period'>.</span><span class='id identifier rubyid_signal'>signal</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_timeout'>timeout</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&lt;=</span> <span class='int'>0</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_timeout'>timeout</span>
    <span class='id identifier rubyid_condition'>condition</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='id identifier rubyid_mutex'>mutex</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_opened'>opened</span>
    <span class='id identifier rubyid_ssh_channel'>ssh_channel</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>ConnectionTimeout</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_failure_reason_code'>failure_reason_code</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_failure_reason_code'>failure_reason_code</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason (module)">ChannelFailureReason</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html#SSH_OPEN_ADMINISTRATIVELY_PROHIBITED-constant" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason::SSH_OPEN_ADMINISTRATIVELY_PROHIBITED (constant)">SSH_OPEN_ADMINISTRATIVELY_PROHIBITED</a></span></span>
      <span class='id identifier rubyid_reason'>reason</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The SSH channel request was administratively prohibited.</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason (module)">ChannelFailureReason</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html#SSH_OPEN_UNKNOWN_CHANNEL_TYPE-constant" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason::SSH_OPEN_UNKNOWN_CHANNEL_TYPE (constant)">SSH_OPEN_UNKNOWN_CHANNEL_TYPE</a></span></span>
      <span class='id identifier rubyid_reason'>reason</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The SSH channel type is not supported.</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason (module)">ChannelFailureReason</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="SshCommandShellBind/ChannelFailureReason.html#SSH_OPEN_RESOURCE_SHORTAGE-constant" title="Msf::Sessions::SshCommandShellBind::ChannelFailureReason::SSH_OPEN_RESOURCE_SHORTAGE (constant)">SSH_OPEN_RESOURCE_SHORTAGE</a></span></span>
      <span class='id identifier rubyid_reason'>reason</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The SSH channel request was denied because of a resource shortage.</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>ConnectionError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span> <span class='label'>reason:</span> <span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_msf_channel'>msf_channel</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="SshCommandShellBind/TcpClientChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpClientChannel (class)">TcpClientChannel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="SshCommandShellBind/TcpClientChannel.html#initialize-instance_method" title="Msf::Sessions::SshCommandShellBind::TcpClientChannel#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@channel_ticker</span> <span class='op'>+=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_channel'>ssh_channel</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='id identifier rubyid_msf_channel'>msf_channel</span><span class='period'>.</span><span class='id identifier rubyid_lsock'>lsock</span>

  <span class='comment'># Notify now that we&#39;ve created the socket
</span>  <span class='id identifier rubyid_notify_socket_created'>notify_socket_created</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_sock'>sock</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sock'>sock</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_server_channel-instance_method">
  
    #<strong>create_server_channel</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 301</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_server_channel'>create_server_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_msf_channel'>msf_channel</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_mutex'>mutex</span> <span class='op'>=</span> <span class='const'>Mutex</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_condition'>condition</span> <span class='op'>=</span> <span class='const'>ConditionVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_timed_out'>timed_out</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@ssh_connection</span><span class='period'>.</span><span class='id identifier rubyid_send_global_request'>send_global_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcpip-forward</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span> <span class='symbol'>:long</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_success'>success</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
    <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_remote_port'>remote_port</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span>
      <span class='id identifier rubyid_remote_port'>remote_port</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_read_long'>read_long</span> <span class='kw'>if</span> <span class='id identifier rubyid_remote_port'>remote_port</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_success'>success</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_timed_out'>timed_out</span>
          <span class='comment'># We&#39;re not using the port; clean it up
</span>          <span class='id identifier rubyid_elog'><span class='object_link'><a href="../../top-level-namespace.html#elog-instance_method" title="#elog (method)">elog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Remote forwarding on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span><span class='embexpr_end'>}</span><span class='tstring_content'> succeeded after timeout. Stopping channel to clean up dangling port</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_stop_server_channel'>stop_server_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span> <span class='id identifier rubyid_remote_port'>remote_port</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_dlog'><span class='object_link'><a href="../../top-level-namespace.html#dlog-instance_method" title="#dlog (method)">dlog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Remote forwarding from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='embexpr_end'>}</span><span class='tstring_content'> established on port </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_remote_port'>remote_port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span> <span class='id identifier rubyid_remote_port'>remote_port</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_msf_channel'>msf_channel</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="SshCommandShellBind/TcpServerChannel.html" title="Msf::Sessions::SshCommandShellBind::TcpServerChannel (class)">TcpServerChannel</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="SshCommandShellBind/TcpServerChannel.html#initialize-instance_method" title="Msf::Sessions::SshCommandShellBind::TcpServerChannel#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='comma'>,</span> <span class='id identifier rubyid_remote_port'>remote_port</span><span class='rparen'>)</span>
          <span class='ivar'>@server_channels</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_msf_channel'>msf_channel</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
          <span class='id identifier rubyid_elog'><span class='object_link'><a href="../../top-level-namespace.html#elog-instance_method" title="#elog (method)">elog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Remote forwarding failed on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localhost'>localhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_localport'>localport</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_condition'>condition</span><span class='period'>.</span><span class='id identifier rubyid_signal'>signal</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_mutex'>mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_condition'>condition</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='id identifier rubyid_mutex'>mutex</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_msf_channel'>msf_channel</span>
      <span class='id identifier rubyid_timed_out'>timed_out</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='comment'># Return the server channel itself
</span>  <span class='id identifier rubyid_msf_channel'>msf_channel</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="desc-instance_method">
  
    #<strong>desc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_desc'>desc</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SSH</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_got_remote_connection-instance_method">
  
    #<strong>on_got_remote_connection</strong>(_session, channel, packet)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The SSH server has told us that thereâ€™s a port forwarding request. Find the relevant server channel and inform it.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419
420
421
422
423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_got_remote_connection'>on_got_remote_connection</span><span class='lparen'>(</span><span class='id identifier rubyid__session'>_session</span><span class='comma'>,</span> <span class='id identifier rubyid_channel'>channel</span><span class='comma'>,</span> <span class='id identifier rubyid_packet'>packet</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_connected_address'>connected_address</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_read_string'>read_string</span>
  <span class='id identifier rubyid_connected_port'>connected_port</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_read_long'>read_long</span>
  <span class='id identifier rubyid_originator_address'>originator_address</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_read_string'>read_string</span>
  <span class='id identifier rubyid_originator_port'>originator_port</span> <span class='op'>=</span> <span class='id identifier rubyid_packet'>packet</span><span class='period'>.</span><span class='id identifier rubyid_read_long'>read_long</span>
  <span class='id identifier rubyid_ilog'><span class='object_link'><a href="../../top-level-namespace.html#ilog-instance_method" title="#ilog (method)">ilog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Received connection: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connected_address'>connected_address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connected_port'>connected_port</span><span class='embexpr_end'>}</span><span class='tstring_content'> &lt;--&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_originator_address'>originator_address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_originator_port'>originator_port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='comment'># Find the correct TcpServerChannel
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_connected_address'>connected_address</span><span class='comma'>,</span> <span class='id identifier rubyid_connected_port'>connected_port</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_server_channel'>server_channel</span> <span class='op'>=</span> <span class='ivar'>@server_channels</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_server_channel'>server_channel</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='ivar'>@channel_ticker</span> <span class='op'>+=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_channel'>channel</span><span class='comma'>,</span> <span class='id identifier rubyid_originator_address'>originator_address</span><span class='comma'>,</span> <span class='id identifier rubyid_originator_port'>originator_port</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop_server_channel-instance_method">
  
    #<strong>stop_server_channel</strong>(host, port)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 339</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop_server_channel'>stop_server_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_completed_event'>completed_event</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Sync</span><span class='op'>::</span><span class='const'>Event</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_dlog'><span class='object_link'><a href="../../top-level-namespace.html#dlog-instance_method" title="#dlog (method)">dlog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cancelling tcpip-forward to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@ssh_connection</span><span class='period'>.</span><span class='id identifier rubyid_send_global_request'>send_global_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cancel-tcpip-forward</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='symbol'>:long</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_success'>success</span><span class='comma'>,</span> <span class='id identifier rubyid__response'>_response</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_success'>success</span>
      <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span>
      <span class='ivar'>@server_channels</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_ilog'><span class='object_link'><a href="../../top-level-namespace.html#ilog-instance_method" title="#ilog (method)">ilog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reverse SSH listener on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'> stopped</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_elog'><span class='object_link'><a href="../../top-level-namespace.html#elog-instance_method" title="#elog (method)">elog</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not stop reverse listener on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_completed_event'>completed_event</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='int'>5</span> <span class='comment'># seconds
</span>  <span class='kw'>begin</span>
    <span class='id identifier rubyid_completed_event'>completed_event</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="supports_udp?-instance_method">
  
    #<strong>supports_udp?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


297
298
299</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/sessions/ssh_command_shell_bind.rb', line 297</span>

<span class='kw'>def</span> <span class='id identifier rubyid_supports_udp?'>supports_udp?</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan 29 04:42:23 2026 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.5).
</div>

    </div>
  </body>
</html>