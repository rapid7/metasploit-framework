<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Msf::Payload::Aix
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Msf::Payload::Aix";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Payload.html" title="Msf::Payload (class)">Payload</a></span></span>
     &raquo; 
    <span class="title">Aix</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Msf::Payload::Aix
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/msf/core/payload/aix.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class is here to implement advanced features for AIX-based payloads. AIX payloads are expected to include this module if they want to support these features.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#aix-instance_method" title="#aix (instance method)">#<strong>aix</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute aix.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_accept-instance_method" title="#cal_accept (instance method)">#<strong>cal_accept</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_accept.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_bind-instance_method" title="#cal_bind (instance method)">#<strong>cal_bind</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_bind.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_close-instance_method" title="#cal_close (instance method)">#<strong>cal_close</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_close.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_connect-instance_method" title="#cal_connect (instance method)">#<strong>cal_connect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_connect.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_execve-instance_method" title="#cal_execve (instance method)">#<strong>cal_execve</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_execve.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_getpeername-instance_method" title="#cal_getpeername (instance method)">#<strong>cal_getpeername</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_getpeername.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_kfcntl-instance_method" title="#cal_kfcntl (instance method)">#<strong>cal_kfcntl</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_kfcntl.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#cal_socket-instance_method" title="#cal_socket (instance method)">#<strong>cal_socket</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute cal_socket.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate-instance_method" title="#generate (instance method)">#<strong>generate</strong>(*args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Overload the generate() call to prefix our stubs and detect AIX version.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(info = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This mixin is chained within payloads that target the AIX platform.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="aix=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="aix-instance_method">
  
    #<strong>aix</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute aix.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 185</span>

<span class='kw'>def</span> <span class='id identifier rubyid_aix'>aix</span>
  <span class='ivar'>@aix</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_accept=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_accept-instance_method">
  
    #<strong>cal_accept</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_accept.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 188</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_accept'>cal_accept</span>
  <span class='ivar'>@cal_accept</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_bind=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_bind-instance_method">
  
    #<strong>cal_bind</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_bind.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_bind'>cal_bind</span>
  <span class='ivar'>@cal_bind</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_close=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_close-instance_method">
  
    #<strong>cal_close</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_close.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_close'>cal_close</span>
  <span class='ivar'>@cal_close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_connect=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_connect-instance_method">
  
    #<strong>cal_connect</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_connect.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 191</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_connect'>cal_connect</span>
  <span class='ivar'>@cal_connect</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_execve=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_execve-instance_method">
  
    #<strong>cal_execve</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_execve.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_execve'>cal_execve</span>
  <span class='ivar'>@cal_execve</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_getpeername=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_getpeername-instance_method">
  
    #<strong>cal_getpeername</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_getpeername.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_getpeername'>cal_getpeername</span>
  <span class='ivar'>@cal_getpeername</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_kfcntl=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_kfcntl-instance_method">
  
    #<strong>cal_kfcntl</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_kfcntl.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_kfcntl'>cal_kfcntl</span>
  <span class='ivar'>@cal_kfcntl</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cal_socket=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cal_socket-instance_method">
  
    #<strong>cal_socket</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute cal_socket.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cal_socket'>cal_socket</span>
  <span class='ivar'>@cal_socket</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate-instance_method">
  
    #<strong>generate</strong>(*args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Overload the generate() call to prefix our stubs and detect AIX version</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='ivar'>@aix</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AIX</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'>#if not assoc_exploit.nil?
</span>  <span class='comment'>#	note = find_note(assoc_exploit.rhost, &#39;AIX&#39;)
</span>
  <span class='comment'>#	if not note.nil?
</span>  <span class='comment'>#		@aix = note[&#39;data&#39;]
</span>  <span class='comment'>#	end
</span>  <span class='comment'>#end
</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='ivar'>@aix</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AIX version is not set!</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='comment'>#
</span>  <span class='comment'># NOTE:
</span>  <span class='comment'>#
</span>  <span class='comment'># To add a syscall set, add a aix_XXXX_syscalls hash as seen below,
</span>  <span class='comment'># and add a line to the versions hash using that version.
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_aix_614_syscalls'>aix_614_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>7</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>211</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>237</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>240</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>242</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>243</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>244</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>278</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>658</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_613_syscalls'>aix_613_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>7</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>205</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>232</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>235</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>237</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>238</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>239</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>272</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>644</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_612_syscalls'>aix_612_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>7</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>205</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>232</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>235</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>237</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>238</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>239</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>272</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>635</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_611_syscalls'>aix_611_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>7</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>202</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>229</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>232</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>234</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>235</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>236</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>269</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>614</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_610_syscalls'>aix_610_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>6</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>203</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>229</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>232</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>234</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>235</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>236</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>269</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>617</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_53x_syscalls'>aix_53x_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>6</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>198</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>214</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>215</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>216</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>217</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>218</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>245</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>493</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_aix_51_syscalls'>aix_51_syscalls</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:__NR_execve</span>      <span class='op'>=&gt;</span> <span class='int'>5</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_getpeername</span> <span class='op'>=&gt;</span> <span class='int'>122</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_accept</span>      <span class='op'>=&gt;</span> <span class='int'>138</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_listen</span>      <span class='op'>=&gt;</span> <span class='int'>139</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_bind</span>        <span class='op'>=&gt;</span> <span class='int'>140</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_socket</span>      <span class='op'>=&gt;</span> <span class='int'>141</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_connect</span>     <span class='op'>=&gt;</span> <span class='int'>142</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_close</span>       <span class='op'>=&gt;</span> <span class='int'>160</span><span class='comma'>,</span>
    <span class='symbol'>:__NR_kfcntl</span>      <span class='op'>=&gt;</span> <span class='int'>322</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_versions'>versions</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.4</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_614_syscalls'>aix_614_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.3</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_613_syscalls'>aix_613_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.2</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_612_syscalls'>aix_612_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.1</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_611_syscalls'>aix_611_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.0</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_610_syscalls'>aix_610_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5.3.10</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_53x_syscalls'>aix_53x_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5.3.9</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_53x_syscalls'>aix_53x_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5.3.8</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_53x_syscalls'>aix_53x_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5.3.7</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_53x_syscalls'>aix_53x_syscalls</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>5.1</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_aix_51_syscalls'>aix_51_syscalls</span>
  <span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_versions'>versions</span><span class='lbracket'>[</span><span class='ivar'>@aix</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='comment'># Dynamically build the support version array :)
</span>    <span class='id identifier rubyid_supported'>supported</span> <span class='op'>=</span> <span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'><span class='object_link'><a href="../../top-level-namespace.html#join-instance_method" title="#join (method)">join</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid AIX version: \&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@aix</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot;.  Supported versions: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_supported'>supported</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_syscalls'>syscalls</span> <span class='op'>=</span> <span class='id identifier rubyid_versions'>versions</span><span class='lbracket'>[</span><span class='ivar'>@aix</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>=</span> <span class='int'>2047</span>
  <span class='id identifier rubyid___NC_execve'>__NC_execve</span>      <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_execve</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_getpeername'>__NC_getpeername</span> <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_getpeername</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_accept'>__NC_accept</span>      <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_accept</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_listen'>__NC_listen</span>      <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_listen</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_bind'>__NC_bind</span>        <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_bind</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_socket'>__NC_socket</span>      <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_socket</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_connect'>__NC_connect</span>     <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_connect</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_close'>__NC_close</span>       <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_close</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___NC_kfcntl'>__NC_kfcntl</span>      <span class='op'>=</span> <span class='op'>-</span><span class='lparen'>(</span><span class='id identifier rubyid___CAL'>__CAL</span> <span class='op'>-</span> <span class='id identifier rubyid_syscalls'>syscalls</span><span class='lbracket'>[</span><span class='symbol'>:__NR_kfcntl</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_cal'>cal</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x38\x5d</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@cal_execve</span>      <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_execve'>__NC_execve</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_getpeername</span> <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_getpeername'>__NC_getpeername</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_accept</span>      <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_accept'>__NC_accept</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_listen</span>      <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_listen'>__NC_listen</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_bind</span>        <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_bind'>__NC_bind</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_socket</span>      <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_socket'>__NC_socket</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_connect</span>     <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_connect'>__NC_connect</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_close</span>       <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_close'>__NC_close</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@cal_kfcntl</span>      <span class='op'>=</span> <span class='id identifier rubyid_cal'>cal</span> <span class='op'>+</span> <span class='lbracket'>[</span><span class='id identifier rubyid___NC_kfcntl'>__NC_kfcntl</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize-instance_method">
  
    #<strong>initialize</strong>(info = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This mixin is chained within payloads that target the AIX platform. It provides special prepends, to support things like chroot and setuid and detect AIX version.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21
22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/payload/aix.rb', line 17</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ret'>ret</span> <span class='op'>=</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_register_options'>register_options</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span>
      <span class='const'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../OptString.html" title="Msf::OptString (class)">OptString</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../OptString.html#initialize-instance_method" title="Msf::OptString#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AIX</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IBM AIX Version</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>6.1.4</span><span class='tstring_end'>&#39;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Payload.html" title="Msf::Payload (class)">Payload</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Msf::Payload::Aix (module)">Aix</a></span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_ret'>ret</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Mar 31 00:30:14 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>