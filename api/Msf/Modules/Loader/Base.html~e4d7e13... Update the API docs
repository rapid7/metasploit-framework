<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Msf::Modules::Loader::Base
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Msf/Modules/Loader/Base.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Modules.html" title="Msf::Modules (module)">Modules</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Loader.html" title="Msf::Modules::Loader (module)">Loader</a></span></span>
     &raquo; 
    <span class="title">Base</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Msf::Modules::Loader::Base
  <span class="abstract note title">Abstract</span>
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Msf::Modules::Loader::Base</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/core/modules/loader/base.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <div class="note abstract">
  <strong>This class is abstract.</strong>
  <div class='inline'>
<p>Subclass and override <span class='object_link'><a href="#each_module_reference_name-instance_method" title="Msf::Modules::Loader::Base#each_module_reference_name (method)">#each_module_reference_name</a></span>, <span class='object_link'><a href="#loadable%3F-instance_method" title="Msf::Modules::Loader::Base#loadable? (method)">#loadable?</a></span>,
<span class='object_link'><a href="#module_path-instance_method" title="Msf::Modules::Loader::Base#module_path (method)">#module_path</a></span>, and <span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">#read_module_content</a></span>.</p>
</div>
</div>

<p>Responsible for loading modules for <span class='object_link'><a href="../../ModuleManager.html" title="Msf::ModuleManager (class)">Msf::ModuleManager</a></span>.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Directory.html" title="Msf::Modules::Loader::Directory (class)">Directory</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="DIRECTORY_BY_TYPE-constant" class="">DIRECTORY_BY_TYPE =
          <div class="docstring">
  <div class="discussion">
    
<p>Not all types are pluralized when a directory name, so here&#39;s the
mapping that currently exists</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_AUX</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>auxiliary</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_ENCODER</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>encoders</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_EXPLOIT</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exploits</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_NOP</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nops</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_PAYLOAD</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>payloads</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>MODULE_POST</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>post</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="NAMESPACE_MODULE_LINE-constant" class="">NAMESPACE_MODULE_LINE =
          <div class="docstring">
  <div class="discussion">
    
<p>This must calculate the first line of the NAMESPACE_MODULE_CONTENT string
so that errors are reported correctly</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='kw'>__LINE__</span> <span class='op'>+</span> <span class='int'>4</span></pre></dd>
      
        <dt id="NAMESPACE_MODULE_CONTENT-constant" class="">NAMESPACE_MODULE_CONTENT =
          <div class="docstring">
  <div class="discussion">
    
<p>By calling module_eval from inside the module definition, the lexical scope
is captured and available to the code in module_content.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='heredoc_beg'>&lt;&lt;-EOS</span>
<span class='tstring_content'>  # ensure the namespace module can respond to checks during loading
  extend Msf::Modules::Namespace

  class &lt;&lt; self
    # The loader that originally loaded this module
    #
    # @return [Msf::Modules::Loader::Base] the loader that loaded this namespace module and can reload it.
    attr_accessor :loader

    # @return [String] The path under which the module of the given type was found.
    attr_accessor :parent_path
  end

  # Calls module_eval on the module_content, but the lexical scope of the namespace_module is passed through
  # module_eval, so that module_content can act like it was written inline in the namespace_module.
  #
  # @param [String] module_content The content of the {Msf::Module}.
  # @param [String] module_path The path to the module, so that error messages in evaluating the module_content can
  #   be reported correctly.
  def self.module_eval_with_lexical_scope(module_content, module_path)
    # By calling module_eval from inside the module definition, the lexical scope is captured and available to the
    # code in module_content.
    module_eval(module_content, module_path)
  end
</span><span class='heredoc_end'>EOS</span></pre></dd>
      
        <dt id="MODULE_EXTENSION-constant" class="">MODULE_EXTENSION =
          <div class="docstring">
  <div class="discussion">
    
<p>The extension for metasploit modules.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.rb</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="MODULE_SEPARATOR-constant" class="">MODULE_SEPARATOR =
          <div class="docstring">
  <div class="discussion">
    
<p>String used to separate module names in a qualified module name.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
        <dt id="NAMESPACE_MODULE_NAMES-constant" class="">NAMESPACE_MODULE_NAMES =
          <div class="docstring">
  <div class="discussion">
    
<p>The base namespace name under which <span class='object_link'><a href="#create_namespace_module-instance_method" title="Msf::Modules::Loader::Base#create_namespace_module (method)">namespace modules are created</a></span>.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Msf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Modules</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span></pre></dd>
      
        <dt id="UNIT_TEST_REGEX-constant" class="">UNIT_TEST_REGEX =
          <div class="docstring">
  <div class="discussion">
    
<p>Regex that can distinguish regular ruby source from unit test source.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>rb\.(ut|ts)\.rb$</span><span class='regexp_end'>/</span></span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#module_manager-instance_method" title="#module_manager (instance method)">- (Msf::ModuleManager) <strong>module_manager</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The module manager for which this loader is loading modules.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#typed_path-class_method" title="typed_path (class method)">+ (String) <strong>typed_path</strong>(type, module_reference_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The path to the module qualified by the type directory.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#create_namespace_module-instance_method" title="#create_namespace_module (instance method)">- (Module) <strong>create_namespace_module</strong>(namespace_module_names) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a nested module to wrap the Metasploit(1|2|3) class so that it
doesn&#39;t overwrite other (metasploit) module&#39;s classes.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#current_module-instance_method" title="#current_module (instance method)">- (Module<sup>?</sup>) <strong>current_module</strong>(module_names) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the module with `module_names` if it exists.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#each_module_reference_name-instance_method" title="#each_module_reference_name (instance method)">- (void) <strong>each_module_reference_name</strong>(path) {|parent_path, type, module_reference_name| ... }</a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  <span class="abstract note title">abstract</span>
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Yields module reference names under path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Base) <strong>initialize</strong>(module_manager) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Base.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#load_error-instance_method" title="#load_error (instance method)">- (void) <strong>load_error</strong>(module_path, error) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Records the load error to
<span class='object_link'><a href="../../ModuleManager/Loading.html#module_load_error_by_path-instance_method" title="Msf::ModuleManager::Loading#module_load_error_by_path (method)">Msf::ModuleManager::Loading#module_load_error_by_path</a></span> and the log.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_module-instance_method" title="#load_module (instance method)">- (false, true) <strong>load_module</strong>(parent_path, type, module_reference_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads a module from the supplied path and module_reference_name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_modules-instance_method" title="#load_modules (instance method)">- (Hash{String =&gt; Integer}) <strong>load_modules</strong>(path, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads all of the modules from the supplied path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#loadable%3F-instance_method" title="#loadable? (instance method)">- (Boolean) <strong>loadable?</strong>(path) </a>
    

    
  </span>
  
  
  
  
  <span class="abstract note title">abstract</span>
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the path can be loaded this module loader.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#module_path-instance_method" title="#module_path (instance method)">- (String) <strong>module_path</strong>(parent_path, type, module_reference_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  <span class="abstract note title">abstract</span>
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns path to module that can be used for reporting errors in evaluating
the <span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">module_content</a></span>.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#module_path%3F-instance_method" title="#module_path? (instance method)">- (true, false) <strong>module_path?</strong>(path) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the path could refer to a module.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#module_reference_name_from_path-instance_method" title="#module_reference_name_from_path (instance method)">- (String) <strong>module_reference_name_from_path</strong>(path) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Changes a file name path to a canonical module reference name.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#namespace_module_name-instance_method" title="#namespace_module_name (instance method)">- (String) <strong>namespace_module_name</strong>(module_full_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the fully-qualified name to the <span class='object_link'><a href="#create_namespace_module-instance_method" title="Msf::Modules::Loader::Base#create_namespace_module (method)">#create_namespace_module</a></span> that
wraps the module with the given module reference name.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#namespace_module_names-instance_method" title="#namespace_module_names (instance method)">- (Array&lt;String&gt;) <strong>namespace_module_names</strong>(module_full_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an Array of names to make a fully qualified module name to wrap the
Metasploit(1|2|3) class so that it doesn&#39;t overwrite other (metasploit)
module&#39;s classes.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#namespace_module_transaction-instance_method" title="#namespace_module_transaction (instance method)">- (Object) <strong>namespace_module_transaction</strong>(module_full_name, options = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#read_module_content-instance_method" title="#read_module_content (instance method)">- (String) <strong>read_module_content</strong>(parent_path, type, module_reference_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  <span class="abstract note title">abstract</span>
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read the content of the module from under path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reload_module-instance_method" title="#reload_module (instance method)">- (Class, Msf::Module) <strong>reload_module</strong>(original_metasploit_class_or_instance) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reloads the specified module.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#restore_namespace_module-instance_method" title="#restore_namespace_module (instance method)">- (void) <strong>restore_namespace_module</strong>(parent_module, relative_name, namespace_module) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Restores the namespace module to it&#39;s original name under it&#39;s
original parent Module if there was a previous namespace module.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#typed_path-instance_method" title="#typed_path (instance method)">- (String) <strong>typed_path</strong>(type, module_reference_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The path to the module qualified by the type directory.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#usable%3F-instance_method" title="#usable? (instance method)">- (false, true) <strong>usable?</strong>(metasploit_class) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the metasploit_class is usable on the current system.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Msf::Modules::Loader::Base (class)">Base</a></span></tt>) <strong>initialize</strong>(module_manager) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Base</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>module_manager</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../ModuleManager.html" title="Msf::ModuleManager (class)">Msf::ModuleManager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The module manager that caches the loaded modules.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_module_manager'>module_manager</span><span class='rparen'>)</span>
  <span class='ivar'>@module_manager</span> <span class='op'>=</span> <span class='id identifier rubyid_module_manager'>module_manager</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="module_manager-instance_method">
  
    - (<tt><span class='object_link'><a href="../../ModuleManager.html" title="Msf::ModuleManager (class)">Msf::ModuleManager</a></span></tt>) <strong>module_manager</strong>  <span class="extras">(readonly, protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The module manager for which this loader is loading modules.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../ModuleManager.html" title="Msf::ModuleManager (class)">Msf::ModuleManager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The module manager for which this loader is loading modules.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


451
452
453</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 451</span>

<span class='kw'>def</span> <span class='id identifier rubyid_module_manager'>module_manager</span>
  <span class='ivar'>@module_manager</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="typed_path-class_method">
  
    + (<tt>String</tt>) <strong>typed_path</strong>(type, module_reference_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The path to the module qualified by the type directory.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of the module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for the module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>path to the module starting with the type directory.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#DIRECTORY_BY_TYPE-constant" title="Msf::Modules::Loader::Base::DIRECTORY_BY_TYPE (constant)">DIRECTORY_BY_TYPE</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


619
620
621
622
623
624
625</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 619</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_typed_path'>typed_path</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_name'>file_name</span> <span class='op'>=</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span> <span class='op'>+</span> <span class='const'>MODULE_EXTENSION</span>
  <span class='id identifier rubyid_type_directory'>type_directory</span> <span class='op'>=</span> <span class='const'>DIRECTORY_BY_TYPE</span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_typed_path'>typed_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_type_directory'>type_directory</span><span class='comma'>,</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_typed_path'>typed_path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_namespace_module-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt>) <strong>create_namespace_module</strong>(namespace_module_names)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a nested module to wrap the Metasploit(1|2|3) class so that it
doesn&#39;t overwrite other (metasploit) module&#39;s classes.  The wrapper
module must be named so that active_support&#39;s autoloading code
doesn&#39;t break when searching constants from inside the
Metasploit(1|2|3) class.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>namespace_module_names</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p><span class='object_link'><a href="#NAMESPACE_MODULE_NAMES-constant" title="Msf::Modules::Loader::Base::NAMESPACE_MODULE_NAMES (constant)">NAMESPACE_MODULE_NAMES</a></span> + &lt;derived-constant-safe names&gt;</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>module that can wrap the module content from <span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">#read_module_content</a></span> using
module_eval_with_lexical_scope.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#NAMESPACE_MODULE_CONTENT-constant" title="Msf::Modules::Loader::Base::NAMESPACE_MODULE_CONTENT (constant)">NAMESPACE_MODULE_CONTENT</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 360</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_namespace_module'>create_namespace_module</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='rparen'>)</span>
  <span class='comment'># In order to have constants defined in Msf resolve without the Msf qualifier in the module_content, the
</span>  <span class='comment'># Module.nesting must resolve for the entire nesting.  Module.nesting is strictly lexical, and can&#39;t be faked with
</span>  <span class='comment'># module_eval(&amp;block). (There&#39;s actually code in ruby&#39;s implementation to stop module_eval from being added to
</span>  <span class='comment'># Module.nesting when using the block syntax.) All this means is the modules have to be declared as a string that
</span>  <span class='comment'># gets module_eval&#39;d.
</span>
  <span class='id identifier rubyid_nested_module_names'>nested_module_names</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>

  <span class='id identifier rubyid_namespace_module_content'>namespace_module_content</span> <span class='op'>=</span> <span class='id identifier rubyid_nested_module_names'>nested_module_names</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='const'>NAMESPACE_MODULE_CONTENT</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_wrapped_content'>wrapped_content</span><span class='comma'>,</span> <span class='id identifier rubyid_module_name'>module_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>module </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_name'>module_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_wrapped_content'>wrapped_content</span>
    <span class='id identifier rubyid_lines'>lines</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>end</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_lines'>lines</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>

  <span class='comment'># - because the added wrap lines have to act like they were written before NAMESPACE_MODULE_CONTENT
</span>  <span class='id identifier rubyid_line_with_wrapping'>line_with_wrapping</span> <span class='op'>=</span> <span class='const'>NAMESPACE_MODULE_LINE</span> <span class='op'>-</span> <span class='id identifier rubyid_nested_module_names'>nested_module_names</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_module_eval'>module_eval</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module_content'>namespace_module_content</span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='comma'>,</span> <span class='id identifier rubyid_line_with_wrapping'>line_with_wrapping</span><span class='rparen'>)</span>

  <span class='comment'># The namespace_module exists now, so no need to use constantize to do const_missing
</span>  <span class='id identifier rubyid_namespace_module'>namespace_module</span> <span class='op'>=</span> <span class='id identifier rubyid_current_module'>current_module</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='rparen'>)</span>
  <span class='comment'># record the loader, so that the namespace module and its metasploit_class can be reloaded
</span>  <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_loader'>loader</span> <span class='op'>=</span> <span class='kw'>self</span>

  <span class='id identifier rubyid_namespace_module'>namespace_module</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_module-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt><sup>?</sup>) <strong>current_module</strong>(module_names)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the module with `module_names` if it exists.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>module_names</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a list of module names to resolve from Object downward.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>module that wraps the previously loaded content from
<span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">#read_module_content</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if any module name along the chain does not exist.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 395</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_module'>current_module</span><span class='lparen'>(</span><span class='id identifier rubyid_module_names'>module_names</span><span class='rparen'>)</span>
  <span class='comment'># Don&#39;t want to trigger ActiveSupport&#39;s const_missing, so can&#39;t use constantize.
</span>  <span class='id identifier rubyid_named_module'>named_module</span> <span class='op'>=</span> <span class='id identifier rubyid_module_names'>module_names</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='const'>Object</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_parent'>parent</span><span class='comma'>,</span> <span class='id identifier rubyid_module_name'>module_name</span><span class='op'>|</span>
    <span class='comment'># Since we&#39;re searching parent namespaces first anyway, this is
</span>    <span class='comment'># semantically equivalent to providing false for the 1.9-only
</span>    <span class='comment'># &quot;inherit&quot; parameter to const_defined?. If we ever drop 1.8
</span>    <span class='comment'># support, we can save a few cycles here by adding it back.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_module_name'>module_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_module_name'>module_name</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_named_module'>named_module</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_module_reference_name-instance_method">
  
    - (<tt>void</tt>) <strong>each_module_reference_name</strong>(path) {|parent_path, type, module_reference_name| ... } <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note abstract">
  <strong>This method is abstract.</strong>
  <div class='inline'>
<p>Override and search the path for modules.</p>
</div>
</div>
<p class="note returns_void">This method returns an undefined value.</p>
<p>Yields module reference names under path.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path under which there are modules</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>parent_path</tt>, <tt>type</tt>, <tt>module_reference_name</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Gives the path and the module_reference_name of the module found under the
path.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>parent_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the path under which the module of the given type was found.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the type of the module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for referencing the module.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>::NotImplementedError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 423</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_module_reference_name'>each_module_reference_name</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>NotImplementedError</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_error-instance_method">
  
    - (<tt>void</tt>) <strong>load_error</strong>(module_path, error)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Records the load error to
<span class='object_link'><a href="../../ModuleManager/Loading.html#module_load_error_by_path-instance_method" title="Msf::ModuleManager::Loading#module_load_error_by_path (method)">Msf::ModuleManager::Loading#module_load_error_by_path</a></span> and the log.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>module_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path to the module as returned by <span class='object_link'><a href="#module_path-instance_method" title="Msf::Modules::Loader::Base#module_path (method)">#module_path</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>error</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Exception.html" title="Msf::Exception (module)">Exception</a></span></tt>, <tt>#class</tt>, <tt>#to_s</tt>, <tt>#backtrace</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the error that cause the module not to load.</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#module_path-instance_method" title="Msf::Modules::Loader::Base#module_path (method)">#module_path</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


434
435
436
437
438
439
440
441
442
443
444
445
446
447
448</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 434</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_error'>load_error</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
  <span class='comment'># module_load_error_by_path does not get the backtrace because the value is echoed to the msfconsole where
</span>  <span class='comment'># backtraces should not appear.
</span>  <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_module_load_error_by_path'>module_load_error_by_path</span><span class='lbracket'>[</span><span class='id identifier rubyid_module_path'>module_path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> failed to load due to the following error:</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call stack:</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_log_lines'>log_lines</span> <span class='op'>+=</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span>

  <span class='id identifier rubyid_log_message'>log_message</span> <span class='op'>=</span> <span class='id identifier rubyid_log_lines'>log_lines</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='id identifier rubyid_log_message'>log_message</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_module-instance_method">
  
    - (<tt>false</tt>, <tt>true</tt>) <strong>load_module</strong>(parent_path, type, module_reference_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Loads a module from the supplied path and module_reference_name.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>parent_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path under which the module exists. This is not necessarily the same
path as passed to <span class='object_link'><a href="#load_modules-instance_method" title="Msf::Modules::Loader::Base#load_modules (method)">#load_modules</a></span>: it may just be derived from that path.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for referring to the module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Options used to force loading and track statistics</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:count_by_type</span>
          <span class="type">(<tt>Hash{String =&gt; Integer}</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Maps the module type to the number of module loaded</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:force</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>whether to force loading of the module even if the module has not changed.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:recalculate_by_type</span>
          <span class="type">(<tt>Hash{String =&gt; Boolean}</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Maps type to whether its <span class='object_link'><a href="../../ModuleManager/ModuleSets.html#module_set-instance_method" title="Msf::ModuleManager::ModuleSets#module_set (method)">Msf::ModuleManager::ModuleSets#module_set</a></span> needs
to be recalculated.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:reload</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>whether this is a reload.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if :force is false and parent_path has not changed.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if exception encountered while parsing module content</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the module is incompatible with the Core or API version.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the module does not implement a Metasploit(d+) class.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the module&#39;s is_usable method returns false.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if all those condition pass and the module is successfully loaded.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">#read_module_content</a></span></li>
    
      <li><span class='object_link'><a href="../../ModuleManager/Loading.html#file_changed%3F-instance_method" title="Msf::ModuleManager::Loading#file_changed? (method)">Msf::ModuleManager::Loading#file_changed?</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_module'>load_module</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_assert_valid_keys'>assert_valid_keys</span><span class='lparen'>(</span><span class='symbol'>:count_by_type</span><span class='comma'>,</span> <span class='symbol'>:force</span><span class='comma'>,</span> <span class='symbol'>:recalculate_by_type</span><span class='comma'>,</span> <span class='symbol'>:reload</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_force'>force</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:force</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_reload'>reload</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:reload</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>

  <span class='id identifier rubyid_module_path'>module_path</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_module_path'>module_path</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_changed'>file_changed</span> <span class='op'>=</span> <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_file_changed?'>file_changed?</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_force'>force</span> <span class='kw'>or</span> <span class='id identifier rubyid_file_changed'>file_changed</span>
    <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cached module from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> has not changed.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_2</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_reload'>reload</span> <span class='op'>||=</span> <span class='id identifier rubyid_force'>force</span> <span class='op'>||</span> <span class='id identifier rubyid_file_changed'>file_changed</span>

  <span class='id identifier rubyid_metasploit_class'>metasploit_class</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_module_content'>module_content</span> <span class='op'>=</span> <span class='id identifier rubyid_read_module_content'>read_module_content</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_module_content'>module_content</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># read_module_content is responsible for calling {#load_error}, so just return here.
</span>    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_try_eval_module'>try_eval_module</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='op'>|</span>
    <span class='comment'># set the parent_path so that the module can be reloaded with #load_module
</span>    <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_parent_path'>parent_path</span> <span class='op'>=</span> <span class='id identifier rubyid_parent_path'>parent_path</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_module_eval_with_lexical_scope'>module_eval_with_lexical_scope</span><span class='lparen'>(</span><span class='id identifier rubyid_module_content'>module_content</span><span class='comma'>,</span> <span class='id identifier rubyid_module_path'>module_path</span><span class='rparen'>)</span>
    <span class='comment'># handle interrupts as pass-throughs unlike other Exceptions so users can bail with Ctrl+C
</span>    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Interrupt</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='comment'># Hide eval errors when the module version is not compatible
</span>      <span class='kw'>begin</span>
        <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_version_compatible!'>version_compatible!</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Modules</span><span class='op'>::</span><span class='const'>VersionCompatibilityError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_version_compatibility_error'>version_compatibility_error</span>
        <span class='id identifier rubyid_load_error'>load_error</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_version_compatibility_error'>version_compatibility_error</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_load_error'>load_error</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_version_compatible!'>version_compatible!</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Modules</span><span class='op'>::</span><span class='const'>VersionCompatibilityError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_version_compatibility_error'>version_compatibility_error</span>
      <span class='id identifier rubyid_load_error'>load_error</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_version_compatibility_error'>version_compatibility_error</span><span class='rparen'>)</span>

      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_metasploit_class'>metasploit_class</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_metasploit_class!'>metasploit_class!</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Modules</span><span class='op'>::</span><span class='const'>MetasploitClassCompatibilityError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_load_error'>load_error</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span>

      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_usable?'>usable?</span><span class='lparen'>(</span><span class='id identifier rubyid_metasploit_class'>metasploit_class</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_ilog'>ilog</span><span class='lparen'>(</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Skipping module (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_path'>module_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>) because is_usable returned false.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='const'>LEV_1</span>
      <span class='rparen'>)</span>

      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_reload'>reload</span>
      <span class='id identifier rubyid_ilog'>ilog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reloading </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> module </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Ambiguous module warnings are safe to ignore</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_2</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_ilog'>ilog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Loaded </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> module </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> under </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>LEV_2</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_module_load_error_by_path'>module_load_error_by_path</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_module_path'>module_path</span><span class='rparen'>)</span>

    <span class='kw'>true</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_loaded'>loaded</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module_transaction'>namespace_module_transaction</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='comma'>,</span> <span class='symbol'>:reload</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_reload'>reload</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_try_eval_module'>try_eval_module</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_loaded'>loaded</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='comment'># Do some processing on the loaded module to get it into the right associations
</span>  <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_on_module_load'>on_module_load</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_metasploit_class'>metasploit_class</span><span class='comma'>,</span>
      <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='comma'>,</span>
      <span class='lbrace'>{</span>
          <span class='comment'># files[0] is stored in the {Msf::Module#file_path} and is used to reload the module, so it needs to be a
</span>          <span class='comment'># full path
</span>          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>files</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span>
              <span class='id identifier rubyid_module_path'>module_path</span>
          <span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>paths</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span>
              <span class='id identifier rubyid_module_reference_name'>module_reference_name</span>
          <span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_type'>type</span>
      <span class='rbrace'>}</span>
  <span class='rparen'>)</span>

  <span class='comment'># Set this module type as needing recalculation
</span>  <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:recalculate_by_type</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span>
    <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='comment'># The number of loaded modules this round
</span>  <span class='id identifier rubyid_count_by_type'>count_by_type</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:count_by_type</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_count_by_type'>count_by_type</span>
    <span class='id identifier rubyid_count_by_type'>count_by_type</span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_count_by_type'>count_by_type</span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_modules-instance_method">
  
    - (<tt>Hash{String =&gt; Integer}</tt>) <strong>load_modules</strong>(path, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Only paths where <span class='object_link'><a href="#loadable%3F-instance_method" title="Msf::Modules::Loader::Base#loadable? (method)">#loadable?</a></span> returns true should be passed to this method.</p>
</div>
  </div>


<p>Loads all of the modules from the supplied path.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path under which there are modules</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">force</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Whether to force loading of the module even if the module has not changed.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">whitelist</span>
          <span class="type">(<tt>Array</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>An array of regex patterns to search for specific modules</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{String =&gt; Integer}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Maps module type to number of modules loaded</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 255</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_modules'>load_modules</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_assert_valid_keys'>assert_valid_keys</span><span class='lparen'>(</span><span class='symbol'>:force</span><span class='comma'>,</span> <span class='symbol'>:whitelist</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_force'>force</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:force</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_count_by_type'>count_by_type</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='comment'># This is used to avoid loading the same thing twice
</span>  <span class='id identifier rubyid_loaded_items'>loaded_items</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_each_module_reference_name'>each_module_reference_name</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='op'>|</span>
    <span class='comment'># In msfcli mode, if a module is already loaded, avoid loading it again
</span>    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_loaded_items'>loaded_items</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:whitelist</span><span class='rbracket'>]</span>

    <span class='comment'># Keep track of loaded modules in msfcli mode
</span>    <span class='id identifier rubyid_loaded_items'>loaded_items</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:whitelist</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_load_module'>load_module</span><span class='lparen'>(</span>
        <span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span>
        <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
        <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='comma'>,</span>
        <span class='symbol'>:recalculate_by_type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span><span class='comma'>,</span>
        <span class='symbol'>:count_by_type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_count_by_type'>count_by_type</span><span class='comma'>,</span>
        <span class='symbol'>:force</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_force'>force</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_recalculate_by_type'>recalculate_by_type</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_recalculate'>recalculate</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_recalculate'>recalculate</span>
      <span class='id identifier rubyid_module_set'>module_set</span> <span class='op'>=</span> <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_module_set'>module_set</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_module_set'>module_set</span><span class='period'>.</span><span class='id identifier rubyid_recalculate'>recalculate</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_count_by_type'>count_by_type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="loadable?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>loadable?</strong>(path) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note abstract">
  <strong>This method is abstract.</strong>
  <div class='inline'>
<p>Override and determine from properties of the path or the file to which the
path points whether it is loadable using <span class='object_link'><a href="#load_modules-instance_method" title="Msf::Modules::Loader::Base#load_modules (method)">#load_modules</a></span> for the subclass.</p>
</div>
</div>

<p>Returns whether the path can be loaded this module loader.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path under which there are modules</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>::NotImplementedError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_loadable?'>loadable?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>NotImplementedError</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="module_path-instance_method">
  
    - (<tt>String</tt>) <strong>module_path</strong>(parent_path, type, module_reference_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note abstract">
  <strong>This method is abstract.</strong>
  <div class='inline'>
<p>Override to return the path to the module on the file system so that errors
can be reported correctly.</p>
</div>
</div>

<p>Returns path to module that can be used for reporting errors in evaluating
the <span class='object_link'><a href="#read_module_content-instance_method" title="Msf::Modules::Loader::Base#read_module_content (method)">module_content</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for referring to the module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path to module.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>::NotImplementedError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


462
463
464</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 462</span>

<span class='kw'>def</span> <span class='id identifier rubyid_module_path'>module_path</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>NotImplementedError</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="module_path?-instance_method">
  
    - (<tt>true</tt>, <tt>false</tt>) <strong>module_path?</strong>(path)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the path could refer to a module.  The path would still
need to be loaded in order to check if it actually is a valid module.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>to module without the type directory.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the extname is <span class='object_link'><a href="#MODULE_EXTENSION-constant" title="Msf::Modules::Loader::Base::MODULE_EXTENSION (constant)">MODULE_EXTENSION</a></span> AND the path does not match
<span class='object_link'><a href="#UNIT_TEST_REGEX-constant" title="Msf::Modules::Loader::Base::UNIT_TEST_REGEX (constant)">UNIT_TEST_REGEX</a></span> AND the path is not hidden (starts with &#39;.&#39;)</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>otherwise</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


474
475
476
477
478
479
480
481
482
483
484
485
486</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 474</span>

<span class='kw'>def</span> <span class='id identifier rubyid_module_path?'>module_path?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_module_path'>module_path</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='id identifier rubyid_extension'>extension</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_extname'>extname</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>or</span>
          <span class='id identifier rubyid_extension'>extension</span> <span class='op'>!=</span> <span class='const'>MODULE_EXTENSION</span> <span class='kw'>or</span>
          <span class='id identifier rubyid_path'>path</span> <span class='op'>=~</span> <span class='const'>UNIT_TEST_REGEX</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_module_path'>module_path</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_module_path'>module_path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="module_reference_name_from_path-instance_method">
  
    - (<tt>String</tt>) <strong>module_reference_name_from_path</strong>(path)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Changes a file name path to a canonical module reference name.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Relative path to module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p><span class='object_link'><a href="#MODULE_EXTENSION-constant" title="Msf::Modules::Loader::Base::MODULE_EXTENSION (constant)">MODULE_EXTENSION</a></span> removed from path.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


492
493
494</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 492</span>

<span class='kw'>def</span> <span class='id identifier rubyid_module_reference_name_from_path'>module_reference_name_from_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='embexpr_beg'>#{</span><span class='const'>MODULE_EXTENSION</span><span class='embexpr_end'>}</span><span class='tstring_content'>$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="namespace_module_name-instance_method">
  
    - (<tt>String</tt>) <strong>namespace_module_name</strong>(module_full_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the fully-qualified name to the <span class='object_link'><a href="#create_namespace_module-instance_method" title="Msf::Modules::Loader::Base#create_namespace_module (method)">#create_namespace_module</a></span> that
wraps the module with the given module reference name.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>module_full_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for referring to the module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>name of module.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#MODULE_SEPARATOR-constant" title="Msf::Modules::Loader::Base::MODULE_SEPARATOR (constant)">MODULE_SEPARATOR</a></span></li>
    
      <li><span class='object_link'><a href="#namespace_module_names-instance_method" title="Msf::Modules::Loader::Base#namespace_module_names (method)">#namespace_module_names</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


505
506
507
508
509
510</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 505</span>

<span class='kw'>def</span> <span class='id identifier rubyid_namespace_module_name'>namespace_module_name</span><span class='lparen'>(</span><span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='lparen'>(</span><span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_namespace_module_name'>namespace_module_name</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>MODULE_SEPARATOR</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_namespace_module_name'>namespace_module_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="namespace_module_names-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>namespace_module_names</strong>(module_full_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an Array of names to make a fully qualified module name to wrap the
Metasploit(1|2|3) class so that it doesn&#39;t overwrite other (metasploit)
module&#39;s classes.  Invalid module name characters are escaped by using
&#39;H*&#39; unpacking and prefixing each code with X so the code remains a
valid module name when it starts with a digit.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>module_full_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The unique canonical name for the module including type.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p><span class='object_link'><a href="#NAMESPACE_MODULE_NAMES-constant" title="Msf::Modules::Loader::Base::NAMESPACE_MODULE_NAMES (constant)">NAMESPACE_MODULE_NAMES</a></span> + &lt;derived-constant-safe names&gt;</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>namespace_module</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


523
524
525</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 523</span>

<span class='kw'>def</span> <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='lparen'>(</span><span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='rparen'>)</span>
  <span class='const'>NAMESPACE_MODULE_NAMES</span> <span class='op'>+</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Mod</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>H*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="namespace_module_transaction-instance_method">
  
    - (<tt>Object</tt>) <strong>namespace_module_transaction</strong>(module_full_name, options = {}, &amp;block)  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 527</span>

<span class='kw'>def</span> <span class='id identifier rubyid_namespace_module_transaction'>namespace_module_transaction</span><span class='lparen'>(</span><span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_assert_valid_keys'>assert_valid_keys</span><span class='lparen'>(</span><span class='symbol'>:reload</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_reload'>reload</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:reload</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='lparen'>(</span><span class='id identifier rubyid_module_full_name'>module_full_name</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span> <span class='op'>=</span> <span class='id identifier rubyid_current_module'>current_module</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_reload'>reload</span>
    <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reloading namespace_module </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span><span class='embexpr_end'>}</span><span class='tstring_content'> when :reload =&gt; false</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_relative_name'>relative_name</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span>
    <span class='id identifier rubyid_parent_module'>parent_module</span> <span class='op'>=</span> <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
    <span class='comment'># remove_const is private, so use send to bypass
</span>    <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_name'>relative_name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_namespace_module'>namespace_module</span> <span class='op'>=</span> <span class='id identifier rubyid_create_namespace_module'>create_namespace_module</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module_names'>namespace_module_names</span><span class='rparen'>)</span>
  <span class='comment'># Get the parent module from the created module so that
</span>  <span class='comment'># restore_namespace_module can remove namespace_module&#39;s constant if
</span>  <span class='comment'># needed.
</span>  <span class='id identifier rubyid_parent_module'>parent_module</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_loaded'>loaded</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_restore_namespace_module'>restore_namespace_module</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_module'>parent_module</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_name'>relative_name</span><span class='comma'>,</span> <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span><span class='rparen'>)</span>

    <span class='comment'># re-raise the original exception in the original context
</span>    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>else</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_loaded'>loaded</span>
      <span class='id identifier rubyid_restore_namespace_module'>restore_namespace_module</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_module'>parent_module</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_name'>relative_name</span><span class='comma'>,</span> <span class='id identifier rubyid_previous_namespace_module'>previous_namespace_module</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_loaded'>loaded</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_module_content-instance_method">
  
    - (<tt>String</tt>) <strong>read_module_content</strong>(parent_path, type, module_reference_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note abstract">
  <strong>This method is abstract.</strong>
  <div class='inline'>
<p>Override to read the module content based on the method of the loader
subclass and return a string.</p>
</div>
</div>

<p>Read the content of the module from under path.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>parent_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path under which the module exists. This is not necessarily the same
path as passed to <span class='object_link'><a href="#load_modules-instance_method" title="Msf::Modules::Loader::Base#load_modules (method)">#load_modules</a></span>: it may just be derived from that path.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for referring to the module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>module content that can be module_evaled into the
<span class='object_link'><a href="#create_namespace_module-instance_method" title="Msf::Modules::Loader::Base#create_namespace_module (method)">#create_namespace_module</a></span></p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>::NotImplementedError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


577
578
579</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 577</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_module_content'>read_module_content</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='op'>::</span><span class='const'>NotImplementedError</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reload_module-instance_method">
  
    - (<tt>Class</tt>, <tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Msf::Module</a></span></tt>) <strong>reload_module</strong>(original_metasploit_class_or_instance) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reloads the specified module.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>original_metasploit_class_or_instance</span>
      
      
        <span class='type'>(<tt>Class</tt>, <tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Msf::Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>either an instance of a module or a module class. If an instance is given,
then the datastore will be copied to the new instance returned by this
method.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Class</tt>, <tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Msf::Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>original_metasploit_class_or_instance if an instance of the reloaded module
cannot be created.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Msf::Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>new instance of original_metasploit_class with datastore copied from
original_metasploit_instance.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reload_module'>reload_module</span><span class='lparen'>(</span><span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Module</span>
    <span class='id identifier rubyid_original_metasploit_instance'>original_metasploit_instance</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span>
    <span class='id identifier rubyid_original_metasploit_class'>original_metasploit_class</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_original_metasploit_instance'>original_metasploit_instance</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_original_metasploit_class'>original_metasploit_class</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_namespace_module'>namespace_module</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class'>original_metasploit_class</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
  <span class='id identifier rubyid_parent_path'>parent_path</span> <span class='op'>=</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='period'>.</span><span class='id identifier rubyid_parent_path'>parent_path</span>

  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>
  <span class='id identifier rubyid_module_reference_name'>module_reference_name</span> <span class='op'>=</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span>

  <span class='id identifier rubyid_dlog'>dlog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reloading module </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_load_module'>load_module</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_path'>parent_path</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='comma'>,</span> <span class='symbol'>:force</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:reload</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='comment'># Create a new instance of the module
</span>    <span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span> <span class='op'>=</span> <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_original_metasploit_instance'>original_metasploit_instance</span>
        <span class='comment'># copy over datastore
</span>        <span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_original_metasploit_instance'>original_metasploit_instance</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to create instance of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> after reload.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>core</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

      <span class='comment'># Return the old module instance to avoid an strace trace
</span>      <span class='kw'>return</span> <span class='id identifier rubyid_original_metasploit_class_or_instance'>original_metasploit_class_or_instance</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to reload </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Let the specific module sets have an opportunity to handle the fact
</span>  <span class='comment'># that this module was reloaded.
</span>  <span class='id identifier rubyid_module_set'>module_set</span> <span class='op'>=</span> <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_module_set'>module_set</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_module_set'>module_set</span><span class='period'>.</span><span class='id identifier rubyid_on_module_reload'>on_module_reload</span><span class='lparen'>(</span><span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span><span class='rparen'>)</span>

  <span class='comment'># Rebuild the cache for just this module
</span>  <span class='id identifier rubyid_module_manager'>module_manager</span><span class='period'>.</span><span class='id identifier rubyid_refresh_cache_from_module_files'>refresh_cache_from_module_files</span><span class='lparen'>(</span><span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_reloaded_module_instance'>reloaded_module_instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restore_namespace_module-instance_method">
  
    - (<tt>void</tt>) <strong>restore_namespace_module</strong>(parent_module, relative_name, namespace_module)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Restores the namespace module to it&#39;s original name under it&#39;s
original parent Module if there was a previous namespace module.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>parent_module</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The .parent of namespace_module before it was removed from the constant
tree.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>relative_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the constant under parent_module where namespace_module was
attached.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>namespace_module</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Module</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The previous namespace module containing the old module content.  If `nil`,
then the relative_name constant is removed from parent_module, but nothing
is set as the new constant.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 589</span>

<span class='kw'>def</span> <span class='id identifier rubyid_restore_namespace_module'>restore_namespace_module</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_module'>parent_module</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_name'>relative_name</span><span class='comma'>,</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_parent_module'>parent_module</span>
    <span class='comment'># If there is a current module with relative_name
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_relative_name'>relative_name</span><span class='rparen'>)</span>
      <span class='comment'># if the current value isn&#39;t the value to be restored.
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_relative_name'>relative_name</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span>
        <span class='comment'># remove_const is private, so use send to bypass
</span>        <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:remove_const</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_name'>relative_name</span><span class='rparen'>)</span>

        <span class='comment'># if there was a previous module, not set it to the name
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span>
          <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span><span class='lparen'>(</span><span class='id identifier rubyid_relative_name'>relative_name</span><span class='comma'>,</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='comment'># if there was a previous module, but there isn&#39;t a current module, then restore the previous module
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span>
        <span class='id identifier rubyid_parent_module'>parent_module</span><span class='period'>.</span><span class='id identifier rubyid_const_set'>const_set</span><span class='lparen'>(</span><span class='id identifier rubyid_relative_name'>relative_name</span><span class='comma'>,</span> <span class='id identifier rubyid_namespace_module'>namespace_module</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="typed_path-instance_method">
  
    - (<tt>String</tt>) <strong>typed_path</strong>(type, module_reference_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>To get the full path to the module, use <span class='object_link'><a href="#module_path-instance_method" title="Msf::Modules::Loader::Base#module_path (method)">#module_path</a></span>.</p>
</div>
  </div>


<p>The path to the module qualified by the type directory.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of the module.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_reference_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The canonical name for the module.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>path to the module starting with the type directory.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


633
634
635</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 633</span>

<span class='kw'>def</span> <span class='id identifier rubyid_typed_path'>typed_path</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_typed_path'>typed_path</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_module_reference_name'>module_reference_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="usable?-instance_method">
  
    - (<tt>false</tt>, <tt>true</tt>) <strong>usable?</strong>(metasploit_class)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the metasploit_class is usable on the current system. 
Defer&#39;s to metasploit_class&#39;s #is_usable if it is defined.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>metasploit_class</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Module.html" title="Msf::Module (class)">Msf::Module</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>As returned by <span class='object_link'><a href="../Namespace.html#metasploit_class-instance_method" title="Msf::Modules::Namespace#metasploit_class (method)">Namespace#metasploit_class</a></span></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if metasploit_class.is_usable returns false.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if metasploit_class does not respond to is_usable.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if metasploit_class.is_usable returns true.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/modules/loader/base.rb', line 644</span>

<span class='kw'>def</span> <span class='id identifier rubyid_usable?'>usable?</span><span class='lparen'>(</span><span class='id identifier rubyid_metasploit_class'>metasploit_class</span><span class='rparen'>)</span>
  <span class='comment'># If the module indicates that it is not usable on this system, then we
</span>  <span class='comment'># will not try to use it.
</span>  <span class='id identifier rubyid_usable'>usable</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_metasploit_class'>metasploit_class</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:is_usable</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_usable'>usable</span> <span class='op'>=</span> <span class='id identifier rubyid_metasploit_class'>metasploit_class</span><span class='period'>.</span><span class='id identifier rubyid_is_usable'>is_usable</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
      <span class='id identifier rubyid_elog'>elog</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exception caught during is_usable check: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_usable'>usable</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_usable'>usable</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Nov  7 14:37:50 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.4).
</div>

  </body>
</html>