<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Msf::Auxiliary::AuthBrute
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Msf/Auxiliary/AuthBrute.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Auxiliary.html" title="Msf::Auxiliary (class)">Auxiliary</a></span></span>
     &raquo; 
    <span class="title">AuthBrute</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Msf::Auxiliary::AuthBrute
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/msf/core/auxiliary/auth_brute.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module provides methods for brute forcing authentication</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#adjust_credentials_by_max_user-instance_method" title="#adjust_credentials_by_max_user (instance method)">- (Object) <strong>adjust_credentials_by_max_user</strong>(credentials) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes a credentials array, and returns just the first X involving a
particular user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_brute_message-instance_method" title="#build_brute_message (instance method)">- (Object) <strong>build_brute_message</strong>(host_ip, host_port, proto, msg, legacy) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Depending on the non-nil elements, build up a standardized auth_brute
message, but support the old style used by vprint_status and friends as
well.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_credentials_array-instance_method" title="#build_credentials_array (instance method)">- (Object) <strong>build_credentials_array</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>If the user passed a memory location for credential gen, assume that
that&#39;s precisely what&#39;s desired – no other transforms or additions
or uniqueness should be done.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup_files-instance_method" title="#cleanup_files (instance method)">- (Object) <strong>cleanup_files</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method deletes the dictionary files if requested.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#combine_users_and_passwords-instance_method" title="#combine_users_and_passwords (instance method)">- (Object) <strong>combine_users_and_passwords</strong>(user_array, pass_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#counters_expired%3F-instance_method" title="#counters_expired? (instance method)">- (Boolean) <strong>counters_expired?</strong>(this_service, credentials) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each_user_pass-instance_method" title="#each_user_pass (instance method)">- (Object) <strong>each_user_pass</strong>(noconn = false, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks all three files for usernames and passwords, and combines them into
one credential list to apply against the supplied block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract_word_pair-instance_method" title="#extract_word_pair (instance method)">- (Object) <strong>extract_word_pair</strong>(wordfile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract_word_pair_from_memory-instance_method" title="#extract_word_pair_from_memory (instance method)">- (Object) <strong>extract_word_pair_from_memory</strong>(memloc) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract_words-instance_method" title="#extract_words (instance method)">- (Object) <strong>extract_words</strong>(wordfile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gen_blank_passwords-instance_method" title="#gen_blank_passwords (instance method)">- (Object) <strong>gen_blank_passwords</strong>(user_array, cred_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gen_user_as_password-instance_method" title="#gen_user_as_password (instance method)">- (Object) <strong>gen_user_as_password</strong>(user_array, cred_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_object_from_memory_location-instance_method" title="#get_object_from_memory_location (instance method)">- (Object) <strong>get_object_from_memory_location</strong>(memloc) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Object) <strong>initialize</strong>(info = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize_class_variables-instance_method" title="#initialize_class_variables (instance method)">- (Object) <strong>initialize_class_variables</strong>(this_service, credentials) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Class variables to track credential use.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#just_uniq_passwords-instance_method" title="#just_uniq_passwords (instance method)">- (Object) <strong>just_uniq_passwords</strong>(credentials) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#just_uniq_users-instance_method" title="#just_uniq_users (instance method)">- (Object) <strong>just_uniq_users</strong>(credentials) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_password_vars-instance_method" title="#load_password_vars (instance method)">- (Object) <strong>load_password_vars</strong>(credentials = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_user_vars-instance_method" title="#load_user_vars (instance method)">- (Object) <strong>load_user_vars</strong>(credentials = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_chosen_password-instance_method" title="#prepend_chosen_password (instance method)">- (Object) <strong>prepend_chosen_password</strong>(pass, cred_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_chosen_username-instance_method" title="#prepend_chosen_username (instance method)">- (Object) <strong>prepend_chosen_username</strong>(user, cred_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_db_hashes-instance_method" title="#prepend_db_hashes (instance method)">- (Metasploit::Framework::CredentialCollection) <strong>prepend_db_hashes</strong>(cred_collection) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing NTLMHashes from the database.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_db_keys-instance_method" title="#prepend_db_keys (instance method)">- (Metasploit::Framework::CredentialCollection) <strong>prepend_db_keys</strong>(cred_collection) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing SSHKeys from the database.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepend_db_passwords-instance_method" title="#prepend_db_passwords (instance method)">- (Metasploit::Framework::CredentialCollection) <strong>prepend_db_passwords</strong>(cred_collection) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing Password Credentials from the database.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_brute-instance_method" title="#print_brute (instance method)">- (Object) <strong>print_brute</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides a consistant way to display messages about AuthBrute-mixed
modules.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#proto_from_fullname-instance_method" title="#proto_from_fullname (instance method)">- (Object) <strong>proto_from_fullname</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Protocols can nearly always be automatically determined from the name of
the module, assuming the name is sensible like ssh_login or smb_auth.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">- (Object) <strong>setup</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#translate_proto_datastores-instance_method" title="#translate_proto_datastores (instance method)">- (Object) <strong>translate_proto_datastores</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes protocol-specific username and password fields, and, if present,
prefer those over any given USERNAME or PASSWORD.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tried_over_total-instance_method" title="#tried_over_total (instance method)">- (Object) <strong>tried_over_total</strong>(ip, port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Fun trick: Only prints if we&#39;re already in each_user_pass, since only
then is @@max_per_service defined.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#userpass_sleep_interval-instance_method" title="#userpass_sleep_interval (instance method)">- (Object) <strong>userpass_sleep_interval</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vprint_error-instance_method" title="#vprint_error (instance method)">- (Object) <strong>vprint_error</strong>(msg = &#39;&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Legacy vprint.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vprint_good-instance_method" title="#vprint_good (instance method)">- (Object) <strong>vprint_good</strong>(msg = &#39;&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Legacy vprint.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#vprint_status-instance_method" title="#vprint_status (instance method)">- (Object) <strong>vprint_status</strong>(msg = &#39;&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Legacy vprint.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="adjust_credentials_by_max_user-instance_method">
  
    - (<tt>Object</tt>) <strong>adjust_credentials_by_max_user</strong>(credentials) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes a credentials array, and returns just the first X involving a
particular user.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 558</span>

<span class='kw'>def</span> <span class='id identifier rubyid_adjust_credentials_by_max_user'>adjust_credentials_by_max_user</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_max'>max</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerUser</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_max'>max</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_new_credentials'>new_credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_credentials'>credentials</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
      <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span>
      <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Adjusting credentials by MaxGuessesPerUser (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max'>max</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
    <span class='rparen'>)</span>
    <span class='id identifier rubyid_user_count'>user_count</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_new_credentials'>new_credentials</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
      <span class='id identifier rubyid_user_count'>user_count</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_user_count'>user_count</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_user_count'>user_count</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_max'>max</span>
      <span class='id identifier rubyid_new_credentials'>new_credentials</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_new_credentials'>new_credentials</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_brute_message-instance_method">
  
    - (<tt>Object</tt>) <strong>build_brute_message</strong>(host_ip, host_port, proto, msg, legacy) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Depending on the non-nil elements, build up a standardized auth_brute
message, but support the old style used by vprint_status and friends as
well.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 527</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_brute_message'>build_brute_message</span><span class='lparen'>(</span><span class='id identifier rubyid_host_ip'>host_ip</span><span class='comma'>,</span><span class='id identifier rubyid_host_port'>host_port</span><span class='comma'>,</span><span class='id identifier rubyid_proto'>proto</span><span class='comma'>,</span><span class='id identifier rubyid_msg'>msg</span><span class='comma'>,</span><span class='id identifier rubyid_legacy'>legacy</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='id identifier rubyid_host_ip'>host_ip</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='kw'>if</span> <span class='id identifier rubyid_host_ip'>host_ip</span>
  <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='id identifier rubyid_host_port'>host_port</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='kw'>if</span> <span class='id identifier rubyid_host_port'>host_port</span>
  <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_extracted_message'>extracted_message</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_legacy'>legacy</span> <span class='comment'># TODO: This is all a workaround until I get a chance to get rid of the legacy messages
</span>    <span class='id identifier rubyid_old_msg'>old_msg</span> <span class='op'>=</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='id identifier rubyid_msg_regex'>msg_regex</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>)(:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'>)?(\s*-?\s*)(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proto'>proto</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_content'>)?(\s*-?\s*)(.*)</span><span class='regexp_end'>/ni</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_old_msg'>old_msg</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_msg_regex'>msg_regex</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_old_msg'>old_msg</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_msg_regex'>msg_regex</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>6</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_old_msg'>old_msg</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_msg_regex'>msg_regex</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_proto'>proto</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> - </span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_progress'>progress</span> <span class='op'>=</span> <span class='id identifier rubyid_tried_over_total'>tried_over_total</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_progress'>progress</span> <span class='kw'>if</span> <span class='id identifier rubyid_progress'>progress</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_old_msg'>old_msg</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_msg_regex'>msg_regex</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>6</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>=</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span>
    <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proto'>proto</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='embexpr_end'>}</span><span class='tstring_content'> - </span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_proto'>proto</span>
    <span class='id identifier rubyid_progress'>progress</span> <span class='op'>=</span> <span class='id identifier rubyid_tried_over_total'>tried_over_total</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_progress'>progress</span> <span class='kw'>if</span> <span class='id identifier rubyid_progress'>progress</span>
    <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_credentials_array-instance_method">
  
    - (<tt>Object</tt>) <strong>build_credentials_array</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>If the user passed a memory location for credential gen, assume that
that&#39;s precisely what&#39;s desired – no other transforms or additions
or uniqueness should be done. Otherwise, perform the usual alterations.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_credentials_array'>build_credentials_array</span>
  <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_word_pair'>extract_word_pair</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_translate_proto_datastores'>translate_proto_datastores</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_credentials'>credentials</span> <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^memory:</span><span class='regexp_end'>/</span></span>
  <span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_load_user_vars'>load_user_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_passwords'>passwords</span> <span class='op'>=</span> <span class='id identifier rubyid_load_password_vars'>load_password_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cleanup_files'>cleanup_files</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USER_AS_PASS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_gen_user_as_password'>gen_user_as_password</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='comma'>,</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BLANK_PASSWORDS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_gen_blank_passwords'>gen_blank_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='comma'>,</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_CREDS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span>
        <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_pass'>pass</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_ptype'>ptype</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>password</span><span class='regexp_end'>/</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_USERS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span>
        <span class='id identifier rubyid_users'>users</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_PASS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span>
        <span class='id identifier rubyid_passwords'>passwords</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_pass'>pass</span> <span class='kw'>if</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_ptype'>ptype</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>password</span><span class='regexp_end'>/</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_combine_users_and_passwords'>combine_users_and_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='comma'>,</span> <span class='id identifier rubyid_passwords'>passwords</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
  <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_just_uniq_users'>just_uniq_users</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@strip_passwords</span>
  <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_just_uniq_passwords'>just_uniq_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@strip_usernames</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_credentials'>credentials</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cleanup_files-instance_method">
  
    - (<tt>Object</tt>) <strong>cleanup_files</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method deletes the dictionary files if requested</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 613</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup_files'>cleanup_files</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>and</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USER_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>and</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_USER_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_path'>path</span> <span class='kw'>and</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_PASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_unlink'>unlink</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="combine_users_and_passwords-instance_method">
  
    - (<tt>Object</tt>) <strong>combine_users_and_passwords</strong>(user_array, pass_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 362</span>

<span class='kw'>def</span> <span class='id identifier rubyid_combine_users_and_passwords'>combine_users_and_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='comma'>,</span><span class='id identifier rubyid_pass_array'>pass_array</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>+</span> <span class='id identifier rubyid_pass_array'>pass_array</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_combined_array'>combined_array</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_pass_array'>pass_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_combined_array'>combined_array</span> <span class='op'>=</span> <span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_combined_array'>combined_array</span> <span class='op'>=</span> <span class='id identifier rubyid_pass_array'>pass_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span>
      <span class='id identifier rubyid_pass_array'>pass_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
        <span class='id identifier rubyid_combined_array'>combined_array</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbracket'>]</span> <span class='comment'># userpass, pass, user, rest
</span>  <span class='id identifier rubyid_remaining_pairs'>remaining_pairs</span> <span class='op'>=</span> <span class='id identifier rubyid_combined_array'>combined_array</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='comment'># counter for our occasional output
</span>  <span class='id identifier rubyid_interval'>interval</span> <span class='op'>=</span> <span class='int'>60</span> <span class='comment'># seconds between each remaining pair message reported to user
</span>  <span class='id identifier rubyid_next_message_time'>next_message_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='id identifier rubyid_interval'>interval</span> <span class='comment'># initial timing interval for user message
</span>  <span class='comment'># Move datastore[&#39;USERNAME&#39;] and datastore[&#39;PASSWORD&#39;] to the front of the list.
</span>  <span class='comment'># Note that we cannot tell the user intention if USERNAME or PASSWORD is blank --
</span>  <span class='comment'># maybe (and it&#39;s often) they wanted a blank. One more credential won&#39;t kill
</span>  <span class='comment'># anyone, and hey, won&#39;t they be lucky if blank user/blank pass actually works!
</span>  <span class='id identifier rubyid_combined_array'>combined_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_pair'>pair</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pair'>pair</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_pair'>pair</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pair'>pair</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_pair'>pair</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pair'>pair</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pair'>pair</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_next_message_time'>next_message_time</span>
      <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pair list is still building with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_remaining_pairs'>remaining_pairs</span><span class='embexpr_end'>}</span><span class='tstring_content'> pairs left to process</span><span class='tstring_end'>&quot;</span></span>
      <span class='rparen'>)</span>
      <span class='id identifier rubyid_next_message_time'>next_message_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='id identifier rubyid_interval'>interval</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_remaining_pairs'>remaining_pairs</span> <span class='op'>-=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_creds'>creds</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="counters_expired?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>counters_expired?</strong>(this_service, credentials) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_counters_expired?'>counters_expired?</span><span class='lparen'>(</span><span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_expired_cred'>expired_cred</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_expired_time'>expired_time</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='comment'># Workaround for cases where multiple auth_brute modules are running concurrently and
</span>  <span class='comment'># someone stomps on the @max_per_service class variable during setup.
</span>  <span class='id identifier rubyid_current_max_per_service'>current_max_per_service</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_class_variable_get'>class_variable_get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@@max_per_service</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_current_max_per_service'>current_max_per_service</span>
  <span class='kw'>if</span> <span class='cvar'>@@guesses_per_service</span><span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='rbracket'>]</span> <span class='op'>&gt;=</span> <span class='lparen'>(</span><span class='cvar'>@@max_per_service</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='cvar'>@@max_per_service</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span>
        <span class='symbol'>:ip</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hit maximum guesses for this service (</span><span class='embexpr_beg'>#{</span><span class='cvar'>@@max_per_service</span><span class='embexpr_end'>}</span><span class='tstring_content'>).</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_expired_cred'>expired_cred</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_seconds_to_run'>seconds_to_run</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxMinutesPerService</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>*</span> <span class='int'>60</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_seconds_to_run'>seconds_to_run</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>if</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&gt;</span> <span class='cvar'>@@brute_start_time</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>+</span> <span class='id identifier rubyid_seconds_to_run'>seconds_to_run</span>
      <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span>
        <span class='symbol'>:ip</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hit timeout for this service at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_seconds_to_run'>seconds_to_run</span> <span class='op'>/</span> <span class='int'>60</span><span class='embexpr_end'>}</span><span class='tstring_content'>m.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_expired_time'>expired_time</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_expired_cred'>expired_cred</span> <span class='op'>||</span> <span class='id identifier rubyid_expired_time'>expired_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each_user_pass-instance_method">
  
    - (<tt>Object</tt>) <strong>each_user_pass</strong>(noconn = false, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks all three files for usernames and passwords, and combines them into
one credential list to apply against the supplied block. The block (usually
something like do_login(user,pass) ) is responsible for actually recording
success and failure in its own way; each_user_pass() will only respond to a
return value of :done (which will signal to end all processing) and to
:next_user (which will cause that username to be skipped for subsequent
password guesses). Other return values won&#39;t affect the processing of
the list.</p>

<p>The &#39;noconn&#39; argument should be set to true if each_user_pass is
merely iterating over the usernames and passwords and should not respect
bruteforce_speed as a delaying factor.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each_user_pass'>each_user_pass</span><span class='lparen'>(</span><span class='id identifier rubyid_noconn'>noconn</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_this_service'>this_service</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fq_rest'>fq_rest</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all remaining users</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># This should kinda halfway be in setup, halfway in run... need to
</span>  <span class='comment'># revisit this.
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>||=</span> <span class='kw'>false</span> <span class='comment'># Assignment and comparison!
</span>    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>||=</span> <span class='id identifier rubyid_build_credentials_array'>build_credentials_array</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_adjust_credentials_by_max_user'>adjust_credentials_by_max_user</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_this_service'>this_service</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_initialize_class_variables'>initialize_class_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
    <span class='comment'># Explicitly be able to set a blank (zero-byte) username by setting the
</span>    <span class='comment'># username to &lt;BLANK&gt;. It&#39;s up to the caller to handle this if it&#39;s not
</span>    <span class='comment'># allowed or if there&#39;s any special handling needed (such as smb_login).
</span>    <span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_u'>u</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^&lt;BLANK&gt;$</span><span class='regexp_end'>/i</span></span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='cvar'>@@credentials_skipped</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_rest'>fq_rest</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_fq_user'>fq_user</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='comment'># Set noconn to indicate that in this case, each_user_pass
</span>    <span class='comment'># is not actually kicking off a connection, so the
</span>    <span class='comment'># bruteforce_speed datastore should be ignored.
</span>    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_noconn'>noconn</span>
      <span class='id identifier rubyid_userpass_sleep_interval'>userpass_sleep_interval</span> <span class='kw'>unless</span> <span class='cvar'>@@credentials_tried</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>end</span>

    <span class='kw'>next</span> <span class='kw'>if</span> <span class='cvar'>@@credentials_skipped</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_user'>fq_user</span><span class='rbracket'>]</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='cvar'>@@credentials_tried</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_user'>fq_user</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_p'>p</span>

    <span class='id identifier rubyid_ret'>ret</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span><span class='rparen'>)</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_ret'>ret</span>
    <span class='kw'>when</span> <span class='symbol'>:abort</span> <span class='comment'># Skip the current host entirely.
</span>      <span class='id identifier rubyid_abort_msg'>abort_msg</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:error</span><span class='comma'>,</span>
        <span class='symbol'>:ip</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bruteforce cancelled against this service.</span><span class='tstring_end'>&quot;</span></span>
      <span class='rbrace'>}</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VERBOSE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_abort_msg'>abort_msg</span><span class='lbracket'>[</span><span class='symbol'>:msg</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> Enable verbose output for service-specific details.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_print_brute'>print_brute</span> <span class='id identifier rubyid_abort_msg'>abort_msg</span>
      <span class='kw'>break</span>

    <span class='kw'>when</span> <span class='symbol'>:next_user</span> <span class='comment'># This means success for that user.
</span>      <span class='cvar'>@@credentials_skipped</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_user'>fq_user</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_p'>p</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STOP_ON_SUCCESS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='comment'># See?
</span>        <span class='cvar'>@@credentials_skipped</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_rest'>fq_rest</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>

    <span class='kw'>when</span> <span class='symbol'>:skip_user</span> <span class='comment'># Skip the user in non-success cases.
</span>      <span class='cvar'>@@credentials_skipped</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_user'>fq_user</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_p'>p</span>

    <span class='kw'>when</span> <span class='symbol'>:connection_error</span> <span class='comment'># Report an error, skip this cred, but don&#39;t neccisarily abort.
</span>      <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:verror</span><span class='comma'>,</span>
        <span class='symbol'>:ip</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection error, skipping &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_u'>u</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;:&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_p'>p</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='cvar'>@@guesses_per_service</span><span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>1</span>
    <span class='cvar'>@@credentials_tried</span><span class='lbracket'>[</span><span class='id identifier rubyid_fq_user'>fq_user</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_p'>p</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_counters_expired?'>counters_expired?</span> <span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='id identifier rubyid_credentials'>credentials</span>
      <span class='kw'>break</span>
    <span class='kw'>else</span>
      <span class='cvar'>@@guesses_per_service</span><span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_word_pair-instance_method">
  
    - (<tt>Object</tt>) <strong>extract_word_pair</strong>(wordfile) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 427</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_word_pair'>extract_word_pair</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_wordfile'>wordfile</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^memory:</span><span class='regexp_end'>/</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_extract_word_pair_from_memory'>extract_word_pair_from_memory</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_wordfile'>wordfile</span> <span class='op'>&amp;&amp;</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readable?'>readable?</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_upfile_contents'>upfile_contents</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_stat'>stat</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='rbrace'>}</span>
    <span class='kw'>rescue</span>
      <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_upfile_contents'>upfile_contents</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\n</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
      <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_creds'>creds</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_pass'>pass</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_creds'>creds</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_word_pair_from_memory-instance_method">
  
    - (<tt>Object</tt>) <strong>extract_word_pair_from_memory</strong>(memloc) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 446</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_word_pair_from_memory'>extract_word_pair_from_memory</span><span class='lparen'>(</span><span class='id identifier rubyid_memloc'>memloc</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='id identifier rubyid_get_object_from_memory_location'>get_object_from_memory_location</span><span class='lparen'>(</span><span class='id identifier rubyid_memloc'>memloc</span><span class='rparen'>)</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_all_creds'>all_creds</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_these_creds'>these_creds</span> <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_all_creds'>all_creds</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_these_creds'>these_creds</span> <span class='op'>=</span> <span class='id identifier rubyid_obj'>obj</span><span class='period'>.</span><span class='id identifier rubyid_builders'>builders</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:imported_users</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_imported_users'>imported_users</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_these_creds'>these_creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cred'>cred</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='ivar'>@strip_passwords</span>
        <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rbrace'>}</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>elsif</span> <span class='ivar'>@strip_usernames</span>
        <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rbrace'>}</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rbrace'>}</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_creds'>creds</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_dehex'>dehex</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>Rex</span><span class='op'>::</span><span class='const'>Text</span><span class='period'>.</span><span class='id identifier rubyid_dehex'>dehex</span><span class='lparen'>(</span><span class='id identifier rubyid_pass'>pass</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='ivar'>@strip_passwords</span> <span class='op'>||</span> <span class='ivar'>@strip_usernames</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_creds'>creds</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not read credentials from memory, raised: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_words-instance_method">
  
    - (<tt>Object</tt>) <strong>extract_words</strong>(wordfile) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


409
410
411
412
413
414
415
416
417
418</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 409</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract_words'>extract_words</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_wordfile'>wordfile</span> <span class='op'>&amp;&amp;</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readable?'>readable?</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_words'>words</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_wordfile'>wordfile</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_stat'>stat</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_save_array'>save_array</span> <span class='op'>=</span> <span class='id identifier rubyid_words'>words</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\r?\n</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_save_array'>save_array</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gen_blank_passwords-instance_method">
  
    - (<tt>Object</tt>) <strong>gen_blank_passwords</strong>(user_array, cred_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342
343
344
345
346
347
348
349</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 340</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gen_blank_passwords'>gen_blank_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='comma'>,</span><span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_blank_passwords'>blank_passwords</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_blank_passwords'>blank_passwords</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_blank_passwords'>blank_passwords</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span><span class='lparen'>(</span><span class='id identifier rubyid_blank_passwords'>blank_passwords</span> <span class='op'>+</span> <span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gen_user_as_password-instance_method">
  
    - (<tt>Object</tt>) <strong>gen_user_as_password</strong>(user_array, cred_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


351
352
353
354
355
356
357
358
359
360</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 351</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gen_user_as_password'>gen_user_as_password</span><span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='comma'>,</span><span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_user_as_passwords'>user_as_passwords</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_user_as_passwords'>user_as_passwords</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_user_array'>user_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_user_as_passwords'>user_as_passwords</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='comma'>,</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span><span class='lparen'>(</span><span class='id identifier rubyid_user_as_passwords'>user_as_passwords</span> <span class='op'>+</span> <span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_object_from_memory_location-instance_method">
  
    - (<tt>Object</tt>) <strong>get_object_from_memory_location</strong>(memloc) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


420
421
422
423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 420</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_object_from_memory_location'>get_object_from_memory_location</span><span class='lparen'>(</span><span class='id identifier rubyid_memloc'>memloc</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_memloc'>memloc</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^memory:\s*([0-9]+)</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='backref'>$1</span>
    <span class='const'>ObjectSpace</span><span class='period'>.</span><span class='id identifier rubyid__id2ref'>_id2ref</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize-instance_method">
  
    - (<tt>Object</tt>) <strong>initialize</strong>(info = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 12</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_info'>info</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span>

  <span class='id identifier rubyid_register_options'>register_options</span><span class='lparen'>(</span><span class='lbracket'>[</span>
    <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A specific username to authenticate as</span><span class='tstring_end'>&#39;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A specific password to authenticate with</span><span class='tstring_end'>&#39;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptPath</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USER_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File containing usernames, one per line</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptPath</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File containing passwords, one per line</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptPath</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>File containing users and passwords separated by space, one pair per line</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptInt</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BRUTEFORCE_SPEED</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>How fast to bruteforce, from 0 to 5</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>5</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VERBOSE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Whether to print output for all attempts</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BLANK_PASSWORDS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Try blank passwords for all users</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USER_AS_PASS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Try the username as the password for all users</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_CREDS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Try each user/password couple stored in the current database</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_USERS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Add all users in the current database to the list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_PASS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>false</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Add all passwords in the current database to the list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>STOP_ON_SUCCESS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Stop guessing when a credential works for a host</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Auxiliary</span><span class='op'>::</span><span class='const'>AuthBrute</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_register_advanced_options'>register_advanced_options</span><span class='lparen'>(</span><span class='lbracket'>[</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_USER_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Automatically delete the USER_FILE on module completion</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_PASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Automatically delete the PASS_FILE on module completion</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptBool</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>REMOVE_USERPASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Automatically delete the USERPASS_FILE on module completion</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='const'>OptInt</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerService</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Maximum number of credentials to try per service instance. If set to zero or a non-number, this option will not be used.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='comment'># Tracked in @@guesses_per_service
</span>    <span class='const'>OptInt</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxMinutesPerService</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Maximum time in minutes to bruteforce the service instance. If set to zero or a non-number, this option will not be used.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='comment'># Tracked in @@brute_start_time
</span>    <span class='const'>OptInt</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerUser</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>%q{</span><span class='tstring_content'>
      Maximum guesses for a particular username for the service instance.
      Note that users are considered unique among different services, so a
      user at 10.1.1.1:22 is different from one at 10.2.2.2:22, and both will
      be tried up to the MaxGuessesPerUser limit.	If set to zero or a non-number,
      this option will not be used.</span><span class='tstring_end'>}</span></span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\t\r\n\s]+</span><span class='regexp_end'>/nm</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\s</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'># Tracked in @@brute_start_time
</span>  <span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Auxiliary</span><span class='op'>::</span><span class='const'>AuthBrute</span><span class='rparen'>)</span>


<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize_class_variables-instance_method">
  
    - (<tt>Object</tt>) <strong>initialize_class_variables</strong>(this_service, credentials) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Class variables to track credential use. They need to be class variables
due to threading.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 261</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_class_variables'>initialize_class_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_this_service'>this_service</span><span class='comma'>,</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='cvar'>@@guesses_per_service</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='cvar'>@@guesses_per_service</span><span class='lbracket'>[</span><span class='id identifier rubyid_this_service'>this_service</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='cvar'>@@credentials_skipped</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='cvar'>@@credentials_tried</span>   <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='cvar'>@@guesses_per_service</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerService</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='cvar'>@@max_per_service</span> <span class='op'>=</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerService</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
      <span class='cvar'>@@max_per_service</span> <span class='op'>=</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span>
        <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span>
        <span class='symbol'>:ip</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:msg</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Adjusting MaxGuessesPerService to the actual total number of credentials</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='cvar'>@@max_per_service</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxGuessesPerService</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxMinutesPerService</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='cvar'>@@brute_start_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="just_uniq_passwords-instance_method">
  
    - (<tt>Object</tt>) <strong>just_uniq_passwords</strong>(credentials) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 328</span>

<span class='kw'>def</span> <span class='id identifier rubyid_just_uniq_passwords'>just_uniq_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="just_uniq_users-instance_method">
  
    - (<tt>Object</tt>) <strong>just_uniq_users</strong>(credentials) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 324</span>

<span class='kw'>def</span> <span class='id identifier rubyid_just_uniq_users'>just_uniq_users</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_password_vars-instance_method">
  
    - (<tt>Object</tt>) <strong>load_password_vars</strong>(credentials = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


296
297
298
299
300
301
302
303</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_password_vars'>load_password_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_passwords'>passwords</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_words'>extract_words</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASS_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_passwords'>passwords</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_prepend_chosen_password'>prepend_chosen_password</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_credentials'>credentials</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_passwords'>passwords</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_user_vars-instance_method">
  
    - (<tt>Object</tt>) <strong>load_user_vars</strong>(credentials = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


287
288
289
290
291
292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 287</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_user_vars'>load_user_vars</span><span class='lparen'>(</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_extract_words'>extract_words</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USER_FILE</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='id identifier rubyid_prepend_chosen_username'>prepend_chosen_username</span><span class='lparen'>(</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_credentials'>credentials</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_credentials'>credentials</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_users'>users</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_chosen_password-instance_method">
  
    - (<tt>Object</tt>) <strong>prepend_chosen_password</strong>(pass, cred_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 336</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_chosen_password'>prepend_chosen_password</span><span class='lparen'>(</span><span class='id identifier rubyid_pass'>pass</span><span class='comma'>,</span><span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_pair'>pair</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_pass'>pass</span><span class='rbracket'>]</span><span class='rbrace'>}</span> <span class='op'>+</span> <span class='id identifier rubyid_cred_array'>cred_array</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_chosen_username-instance_method">
  
    - (<tt>Object</tt>) <strong>prepend_chosen_username</strong>(user, cred_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_chosen_username'>prepend_chosen_username</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_cred_array'>cred_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cred_array'>cred_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_user'>user</span><span class='comma'>,</span><span class='id identifier rubyid_pair'>pair</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span> <span class='op'>+</span> <span class='id identifier rubyid_cred_array'>cred_array</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_db_hashes-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>) <strong>prepend_db_hashes</strong>(cred_collection) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing NTLMHashes from the database. This allows the users to
use the DB_ALL_CREDS option.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>credential collection to add to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the modified Credentialcollection</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_db_hashes'>prepend_db_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_CREDS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>
    <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='const'>Metasploit</span><span class='op'>::</span><span class='const'>Credential</span><span class='op'>::</span><span class='const'>Core</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:private</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>metasploit_credential_privates:</span> <span class='lbrace'>{</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Metasploit::Credential::NTLMHash</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>workspace_id:</span> <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cred'>cred</span><span class='op'>|</span>
      <span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='period'>.</span><span class='id identifier rubyid_prepend_cred'>prepend_cred</span><span class='lparen'>(</span><span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_to_credential'>to_credential</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cred_collection'>cred_collection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_db_keys-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>) <strong>prepend_db_keys</strong>(cred_collection) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing SSHKeys from the database. This allows the users to use
the DB_ALL_CREDS option.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>credential collection to add to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the modified Credentialcollection</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_db_keys'>prepend_db_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_CREDS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>
    <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='const'>Metasploit</span><span class='op'>::</span><span class='const'>Credential</span><span class='op'>::</span><span class='const'>Core</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:private</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>metasploit_credential_privates:</span> <span class='lbrace'>{</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Metasploit::Credential::SSHKey</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>workspace_id:</span> <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cred'>cred</span><span class='op'>|</span>
      <span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='period'>.</span><span class='id identifier rubyid_prepend_cred'>prepend_cred</span><span class='lparen'>(</span><span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_to_credential'>to_credential</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cred_collection'>cred_collection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepend_db_passwords-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>) <strong>prepend_db_passwords</strong>(cred_collection) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method takes a <span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span> and
prepends existing Password Credentials from the database. This allows the
users to use the DB_ALL_CREDS option.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>credential collection to add to</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Metasploit/Framework/CredentialCollection.html" title="Metasploit::Framework::CredentialCollection (class)">Metasploit::Framework::CredentialCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the modified Credentialcollection</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90
91
92
93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepend_db_passwords'>prepend_db_passwords</span><span class='lparen'>(</span><span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DB_ALL_CREDS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>
    <span class='id identifier rubyid_creds'>creds</span> <span class='op'>=</span> <span class='const'>Metasploit</span><span class='op'>::</span><span class='const'>Credential</span><span class='op'>::</span><span class='const'>Core</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:private</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>metasploit_credential_privates:</span> <span class='lbrace'>{</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Metasploit::Credential::Password</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>workspace_id:</span> <span class='id identifier rubyid_myworkspace'>myworkspace</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_creds'>creds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cred'>cred</span><span class='op'>|</span>
      <span class='id identifier rubyid_cred_collection'>cred_collection</span><span class='period'>.</span><span class='id identifier rubyid_prepend_cred'>prepend_cred</span><span class='lparen'>(</span><span class='id identifier rubyid_cred'>cred</span><span class='period'>.</span><span class='id identifier rubyid_to_credential'>to_credential</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cred_collection'>cred_collection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_brute-instance_method">
  
    - (<tt>Object</tt>) <strong>print_brute</strong>(opts = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provides a consistant way to display messages about AuthBrute-mixed
modules. Acceptable opts are fairly self-explanitory, but :level can be
tricky.</p>

<p>It can be one of status, good, error, or line (and corresponds to the usual
print_status, print_good, etc. methods).</p>

<p>If it&#39;s preceded by a “v” (ie, vgood, verror, etc), only print if <a
href="http://"VERBOSE"">datastore</a> is set to true.</p>

<p>If :level would make the method nonsense, default to print_status.</p>

<p>TODO: This needs to be simpler to be useful.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 501</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_brute'>print_brute</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:level</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:level</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^v</span><span class='regexp_end'>/</span></span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>VERBOSE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_level'>level</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:level</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>16</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_level'>level</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:level</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_host_ip'>host_ip</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:ip</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:rhost</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:host</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_rhost'>rhost</span> <span class='kw'>rescue</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RHOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_host_port'>host_port</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:rport</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_rport'>rport</span> <span class='kw'>rescue</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RPORT</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:msg</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:legacy_msg</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_proto'>proto</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:proto</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:protocol</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_proto_from_fullname'>proto_from_fullname</span>

  <span class='id identifier rubyid_complete_message'>complete_message</span> <span class='op'>=</span> <span class='id identifier rubyid_build_brute_message'>build_brute_message</span><span class='lparen'>(</span><span class='id identifier rubyid_host_ip'>host_ip</span><span class='comma'>,</span><span class='id identifier rubyid_host_port'>host_port</span><span class='comma'>,</span><span class='id identifier rubyid_proto'>proto</span><span class='comma'>,</span><span class='id identifier rubyid_msg'>msg</span><span class='comma'>,</span><span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:legacy_msg</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_print_method'>print_method</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>print_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_level'>level</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='id identifier rubyid_print_method'>print_method</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='id identifier rubyid_print_method'>print_method</span><span class='comma'>,</span> <span class='id identifier rubyid_complete_message'>complete_message</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_print_status'>print_status</span> <span class='id identifier rubyid_complete_message'>complete_message</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="proto_from_fullname-instance_method">
  
    - (<tt>Object</tt>) <strong>proto_from_fullname</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Protocols can nearly always be automatically determined from the name of
the module, assuming the name is sensible like ssh_login or smb_auth.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


593
594
595</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 593</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proto_from_fullname'>proto_from_fullname</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fullname'>fullname</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(.*)_(login|auth|identify)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup-instance_method">
  
    - (<tt>Object</tt>) <strong>setup</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='cvar'>@@max_per_service</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="translate_proto_datastores-instance_method">
  
    - (<tt>Object</tt>) <strong>translate_proto_datastores</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes protocol-specific username and password fields, and, if present,
prefer those over any given USERNAME or PASSWORD. Note, these special
username/passwords should get deprecated some day. Note2: Don&#39;t use
with SMB and FTP at the same time!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312
313
314
315
316
317
318
319
320
321
322</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 310</span>

<span class='kw'>def</span> <span class='id identifier rubyid_translate_proto_datastores'>translate_proto_datastores</span>
  <span class='id identifier rubyid_switched'>switched</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMBUser</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FTPUSER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USERNAME</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SMBPass</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FTPPASS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASSWORD</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='id identifier rubyid_p'>p</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tried_over_total-instance_method">
  
    - (<tt>Object</tt>) <strong>tried_over_total</strong>(ip, port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Fun trick: Only prints if we&#39;re already in each_user_pass, since only
then is @@max_per_service defined.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


581
582
583
584
585
586
587
588</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 581</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tried_over_total'>tried_over_total</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_class_variable_get'>class_variable_get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@@max_per_service</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>rescue</span> <span class='kw'>nil</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_total'>total</span>
  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='id identifier rubyid_total'>total</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_current_try'>current_try</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='cvar'>@@guesses_per_service</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_pad'>pad</span> <span class='op'>=</span> <span class='id identifier rubyid_total'>total</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[%0</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pad'>pad</span><span class='embexpr_end'>}</span><span class='tstring_content'>d/%0</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pad'>pad</span><span class='embexpr_end'>}</span><span class='tstring_content'>d] - </span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span><span class='id identifier rubyid_current_try'>current_try</span><span class='comma'>,</span> <span class='id identifier rubyid_total'>total</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="userpass_sleep_interval-instance_method">
  
    - (<tt>Object</tt>) <strong>userpass_sleep_interval</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


477
478
479
480
481
482
483
484
485
486
487</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 477</span>

<span class='kw'>def</span> <span class='id identifier rubyid_userpass_sleep_interval'>userpass_sleep_interval</span>
  <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_datastore'>datastore</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BRUTEFORCE_SPEED</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>when</span> <span class='int'>0</span><span class='semicolon'>;</span> <span class='int'>60</span> <span class='op'>*</span> <span class='int'>5</span>
    <span class='kw'>when</span> <span class='int'>1</span><span class='semicolon'>;</span> <span class='int'>15</span>
    <span class='kw'>when</span> <span class='int'>2</span><span class='semicolon'>;</span> <span class='int'>1</span>
    <span class='kw'>when</span> <span class='int'>3</span><span class='semicolon'>;</span> <span class='float'>0.5</span>
    <span class='kw'>when</span> <span class='int'>4</span><span class='semicolon'>;</span> <span class='float'>0.1</span>
    <span class='kw'>else</span><span class='semicolon'>;</span> <span class='int'>0</span>
  <span class='kw'>end</span>
  <span class='op'>::</span><span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span><span class='kw'>nil</span><span class='comma'>,</span><span class='kw'>nil</span><span class='comma'>,</span><span class='id identifier rubyid_sleep_time'>sleep_time</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vprint_error-instance_method">
  
    - (<tt>Object</tt>) <strong>vprint_error</strong>(msg = &#39;&#39;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Legacy vprint</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


603
604
605</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 603</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vprint_error'>vprint_error</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_brute'>print_brute</span> <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:verror</span><span class='comma'>,</span> <span class='symbol'>:legacy_msg</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vprint_good-instance_method">
  
    - (<tt>Object</tt>) <strong>vprint_good</strong>(msg = &#39;&#39;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Legacy vprint</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


608
609
610</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 608</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vprint_good'>vprint_good</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_brute'>print_brute</span> <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vgood</span><span class='comma'>,</span> <span class='symbol'>:legacy_msg</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="vprint_status-instance_method">
  
    - (<tt>Object</tt>) <strong>vprint_status</strong>(msg = &#39;&#39;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Legacy vprint</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


598
599
600</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/auxiliary/auth_brute.rb', line 598</span>

<span class='kw'>def</span> <span class='id identifier rubyid_vprint_status'>vprint_status</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_brute'>print_brute</span> <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='symbol'>:vstatus</span><span class='comma'>,</span> <span class='symbol'>:legacy_msg</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_msg'>msg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Nov  7 14:37:22 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.4).
</div>

  </body>
</html>